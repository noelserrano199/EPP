-TYPE *************************************************************************
-SET  &NOWTIME = HHMMSS(A8);
-TYPE &NOWTIME.EVAL START &FOCFEXNAME.EVAL
-TYPE -------------------------------------------------------------------------
-IF  &DFLTCNTL.EXISTS EQ 1 THEN GOTO STEP001;
-******************************************************************************
-STEP000
-SET  &STEP       = '&FOCFEXNAME.EVAL'||'.'||'STEP000';
-SET  &NOWTIME    = HHMMSS(A8);
-TYPE &NOWTIME.EVAL &STEP.EVAL
-TYPE &NOWTIME.EVAL *** Establish APP PATH and defaults
-DEFAULT &INVCNO     = 'P1137074160';
-RUN
-*-----------------------------------------------------------------------------
-INCLUDE EPP/EPP_EPP2_DEFAULTS
-*-----------------------------------------------------------------------------
-SET  &STEP    = '&FOCFEXNAME.EVAL'||'.'||'STEP000';
-SET  &NOWTIME = HHMMSS(A8);
-TYPE &NOWTIME.EVAL &STEP.EVAL COMPLETE RETCODE&RETCODE.EVAL
-TYPE -------------------------------------------------------------------------
-IF   &FOCERRNUM.EVAL NE 0 THEN GOTO ERRORS;
-*-----------------------------------------------------------------------------
SQL
SELECT *
FROM  CLARITY_TDL_TRAN
WHERE REFERENCE_NUMBER = '5568692'
  AND DETAIL_TYPE = 2
;
END
-EXIT
 
 
SQL
SELECT max(post_date)
FROM CLARITY_TDL_TRAN
-*WHERE POST_DATE = '10 AUG 2021'
-*  AND ROWNUM < 10
;
END
-EXIT
 
 
SQL
SELECT *
FROM CLARITY_EPM_2
WHERE PAYOR_ID = 1266
;
END
-EXIT
 
 
SQL
SELECT *
FROM CLARITY_TDL_TRAN
WHERE TX_ID = 222849641
  AND DETAIL_TYPE = 50
;
END
-EXIT
 
 
 
 
SQL
SELECT *
FROM CLARITY_SER
WHERE PROV_ID = '12522'
;
END
-EXIT
SQL
SELECT *
FROM CLARITY_SER_2
WHERE NPI = '1508870403'
;
END
-EXIT
12522
-*SQL
-*DELETE
-*FROM  &DAIC.EVAL&DAIC_TBL.EVAL
-*WHERE DAIC_IFCT_FILE_ID = 50380;
-*COMMIT WORK;
-*END
-*-RUN
-*-EXIT
 
 
-*SQL
-*SELECT *
-*FROM &IFCT.EVAL&IFCT_TBL.EVAL
-*WHERE RTRIM(IFCT_FILE_NAME) = '20201110_BOA_POST_BOAMIXED_ERA_EPIC_A.835';
-*;
-*END
-*-RUN
-*-EXIT
-*-EXIT50376
-*
-*
-*SQL
-*DELETE
-*FROM  &DAIC.EVAL&DAIC_TBL.EVAL
-*WHERE DAIC_IFCT_FILE_NAME = '20201110_BOA_POST_AETNA_ERA_CRP_EPIC_A.835';
-*COMMIT WORK;
-*END
-*-RUN
-*-EXIT
 
 
 
 
 
 
-*SQL
-*DELETE
-*FROM &DIC.EVAL&DIC_TBL.EVAL
-*WHERE DIC_FILE_NAME = '20201110_BOA_POST_AETNA_ERA_CRP_EPIC_A.835';
-*-*WHERE EXISTS
-*-*      ( SELECT 1
-*-*        FROM   &ISA.EVAL&ISA_TBL.EVAL
-*-*              ,&IFCT.EVAL&IFCT_TBL.EVAL
-*-*        WHERE  ISA_FILE_ID  <> 0
-*-*          AND  IFCT_FILE_ID  = ISA_FILE_ID
-*-*          AND  DIC_FILE_NAME = RTRIM(IFCT_FILE_NAME));
-*COMMIT WORK;
-*END
-*-RUN
-*-EXIT
 
 
 
-*SQL
-*DELETE
-*FROM  &DCA.EVAL&DCA_TBL.EVAL
-*WHERE DCA_FILE_NAME = '20201110_BOA_POST_BOAMIXED_ERA_EPIC_A.835';
-*-*WHERE DCA_FILE_NAME = '20201110_BOA_POST_AETNA_ERA_CRP_EPIC_A.835';
-*-*WHERE EXISTS
-*-*      ( SELECT 1
-*-*        FROM   &ISA.EVAL&ISA_TBL.EVAL
-*-*              ,&IFCT.EVAL&IFCT_TBL.EVAL
-*-*        WHERE  ISA_FILE_ID  <> 0
-*-*          AND  IFCT_FILE_ID  = ISA_FILE_ID
-*-*          AND  DCA_FILE_NAME = RTRIM(IFCT_FILE_NAME));
-*COMMIT WORK;
-*END
-*-RUN
-*-EXIT
 
 
 
 
-*SQL
-*SELECT *
-*FROM CLARITY_TDL_TRAN
-*WHERE TX_ID = 193447845
-*;
-*END
-*-EXIT
 
 
-*
-*SQL
-*SELECT *
-*FROM CLARITY_TDL_TRAN
-*WHERE INVOICE_NUMBER = 'P1284694020'
-*;
-*END
-*-EXIT
 
 
-*SQL
-*SELECT *
-*FROM INV_BASIC_INFO
-*WHERE INV_ID = 31999075
-*;
-*END
-*-EXIT
 
 
 
-*SQL
-*SELECT *
-*FROM ARPB_TRANSACTIONS
-*WHERE TX_ID = 180264260
-*;
-*END
-*-EXIT
 
 
-*SQL
-*SELECT *
-*FROM &SVC.EVAL&SVC_TBL.EVAL
-*;
-*END
-*-EXIT
 
 
 
 
-*SQL
-*SELECT *
-*FROM  ARPB_TRANSACTIONS
-*-*WHERE REPOST_ETR_ID = 196207274
-*WHERE TX_ID = 190547763
-*;
-*END
-*-EXIT
 
 
-*
SQL
SELECT *
-*CLP_CLM_SUBMTR_ID                AS INVOICE
-*      ,CLP_CLM_STATUS_CD                AS STS
-*      ,CLP_TOT_CLM_CRG_AMT              AS CLAIM_AMOUNT
-*      ,CLP_CLM_PYMT_AMT                 AS CLAIM_PMT
-*      ,CLP_PT_RESP_AMT                  AS PT_RESP
-*      ,CLP_CAS_CLM_ADJ_GRP_CD1          AS GRP_CD
-*      ,CLP_CAS_CLM_ADJ_RSN_CD1          AS RSN_CD
-*      ,CLP_CAS_CLM_ADJ_AMT1             AS AMT1
-*      ,CLP_CAS_CLM_ADJ_RSN_CD2
-*      ,CLP_CAS_CLM_ADJ_AMT2
-*      ,CLP_EXCL_RSN_CD                  AS CLP_EXCL_CD
-*      ,CLP_CAS_EXCL_RSN_CD              AS CLP_CAS_EXCL_CD
FROM  &CLP.EVAL&CLP_TBL.EVAL
INNER JOIN
      &SVC.EVAL&SVC_TBL.EVAL
ON    SVC_ISA_FILE_ID           = CLP_ISA_FILE_ID
  AND SVC_GS_GRP_SEQ_NO         = CLP_GS_GRP_SEQ_NO
  AND SVC_ST_SEQ_NO             = CLP_ST_SEQ_NO
  AND SVC_LX_SEQ_NO             = CLP_LX_SEQ_NO
  AND SVC_CLP_CLM_SEQ_NO        = CLP_CLM_SEQ_NO
-*    AND RTRIM(SVC_LI_PRVDR_PYMT) = '22.67'
-*-*  AND ( SUBSTR(CLP_CAS_EXCL_RSN_CD,1,2) = 'AA' )
-*-*    OR  SUBSTR(CLP_EXCL_RSN_CD,1,2)     = 'AA' )
-*-*WHERE RTRIM(SVC_CAS_CLM_ADJ_RSN_CD1)  = 'CO'
-*WHERE SVC_INCL_RSN_CD = 'ER1'
-*WHERE CLP_EXCL_RSN_CD               = 'DI4'
-*WHERE RTRIM(CLP_PYR_CLM_CNTL_NO) = '2003913001'
WHERE RTRIM(CLP_CLM_SUBMTR_ID) = 'P1305841360'
-*WHERE CLP_INCL_RSN_CD = 'FI7'
ORDER BY 1
;
END
-EXIT
-*
-*-*
-*-*
 
 
 
-*SQL
-*SELECT *
-*FROM  INV_CLM_LN_ADDL
-*WHERE INVOICE_NUM = 'P1300062950'
-*ORDER BY CLM_LN
-*-*-*  AND PROC_OR_REV_CODE = '26449'
-*;
-*END
-*-EXIT
 
 
-*SQL
-*SELECT *
-*FROM ZC_CLAIM_FREQ
-*;
-*END
-*-EXIT
 
 
 
SQL
SELECT /*+ NOPARALLEL ORDERED NO_UNNEST */
      B.INVOICE_NUMBER
     ,B.TX_ID
     ,B.POST_DATE
     ,B.ORIG_SERVICE_DATE
     ,B.CPT_CODE
     ,B.MODIFIER_ONE
     ,B.MODIFIER_TWO
     ,B.ORIG_AMT
     ,B.ORIG_PRICE
     ,B.BILL_CLAIM_AMOUNT
     ,C.VOID_DATE
     ,C.OUTSTANDING_AMT
     ,C.REPOST_ETR_ID
     ,C.REPOST_TYPE_C
     ,D.R_ORIG_CHG_TX_ID
     ,D.R_NEW_CHG_TX_ID
FROM
(
-*SELECT /*+ INDEX(A IDX_CLARITY_TDL_TRANN_PD) */ DISTINCT
SELECT DISTINCT
      INVOICE_NUMBER
     ,ACTIVE_AR_AMOUNT
-*     ,POST_DATE
-*     ,ORIG_SERVICE_DATE
-*     ,CPT_CODE
-*     ,ORIG_AMT
-*     ,BILL_CLAIM_AMOUNT
FROM  CLARITY_TDL_TRAN A
WHERE DETAIL_TYPE = 50
  AND INVOICE_NUMBER = 'P1312114170'
-*  AND POST_DATE   = '13 APR 2020'
-*  AND BILL_CLAIM_AMOUNT = 0
-*  AND ORIG_AMT   <> 0
ORDER BY 1
) T1
INNER JOIN
      CLARITY_TDL_TRAN  B
ON    B.INVOICE_NUMBER = T1.INVOICE_NUMBER
INNER JOIN
      ARPB_TRANSACTIONS C
ON    C.TX_ID          = B.TX_ID
INNER JOIN
      CLARITY_TDL_TRAN  D
ON    D.TX_ID          = C.TX_ID
  AND D.DETAIL_TYPE    = 1
ORDER BY 1,2,3,4
;
TABLEF FILE SQLOUT
LIST *
END
-EXIT
 
 
 
-*SQL
-*SELECT *
-*FROM CLARITY_TDL_TRAN
-*WHERE TX_ID = 195030615
-*;
-*END
-*-EXIT
-*
-*
-*
-*SQL
-*SELECT *
-*FROM ARPB_TX_VOID
-*WHERE TX_ID = 195030615
-*;
-*END
-*-EXIT
 
 
 
 
-*
 
-*SQL
-*SELECT OUTSTANDING_AMT
-*FROM  CLARITY_TDL_TRAN  A
-*INNER JOIN
-*      ARPB_TRANSACTIONS B
-*ON    B.TX_ID = A.TX_ID
-*  AND B.OUTSTANDING_AMT > 0
-*WHERE INT_PAT_ID  = 'Z5021690'
-*-*SUBSTR(PAT_LAST_NAME,1,1)
-*  AND DETAIL_TYPE = 1
-*;
-*END
-*-EXIT
-*SQL
-*SELECT *
-*FROM PATIENT
-*WHERE UPPER(PAT_LAST_NAME) = 'CZYZYCKA'
-*;
-*END
-*-EXIT
 
 
-*
 
 
 
SQL
SELECT *
FROM &CLP.EVAL&CLP_TBL.EVAL
INNER JOIN
      &SVC.EVAL&SVC_TBL.EVAL
ON    SVC_ISA_FILE_ID               = CLP_ISA_FILE_ID
  AND SVC_GS_GRP_SEQ_NO             = CLP_GS_GRP_SEQ_NO
  AND SVC_ST_SEQ_NO                 = CLP_ST_SEQ_NO
  AND SVC_LX_SEQ_NO                 = CLP_LX_SEQ_NO
  AND SVC_CLP_CLM_SEQ_NO            = CLP_CLM_SEQ_NO
INNER JOIN
      &SVC_DTM.EVAL&SVC_DTM_TBL.EVAL D1
ON    SVC_DTM_ISA_FILE_ID       = SVC_ISA_FILE_ID
  AND SVC_DTM_GS_GRP_SEQ_NO     = SVC_GS_GRP_SEQ_NO
  AND SVC_DTM_ST_SEQ_NO         = SVC_ST_SEQ_NO
  AND SVC_DTM_LX_SEQ_NO         = SVC_LX_SEQ_NO
  AND SVC_DTM_CLP_CLM_SEQ_NO    = SVC_CLP_CLM_SEQ_NO
  AND SVC_DTM_SVC_SEQ_NO        = SVC_SEQ_NO
 
-*  AND SVC_DTM_DATE              = '20200706'
 
 
-*  AND SVC_DTM_DTTM_QLFR         IN( '472','150' )
-*  AND SVC_DTM_EXCL_RSN_CD       = '   '
-*  AND RTRIM(SVC_LI_PRVDR_PYMT) IN('361.99','-361.99')
-*  AND SVC_EXCL_RSN_CD               = '   '
-*  AND RTRIM(SVC_LI_PRVDR_PYMT)      = '-102.16'
-*  AND RTRIM(SVC_PROC1_CD)           = '96415'
WHERE RTRIM(CLP_CLM_SUBMTR_ID)      = 'P1299183690'
ORDER BY 1,2,3,4
;
END
-EXIT
 
 
 
-*-SET &ECHO=ALL;
-*SQL
-*INSERT INTO &CP.EVAL&CP_TBL.EVAL
-*(CP_NEIC_ID)
-*VALUES
-*('P0988');
-*END
-*-EXIT
SQL
SELECT *
FROM &CP.EVAL&CP_TBL.EVAL
ORDER BY 1
;
END
-EXIT
-*
 
SQL
SELECT *
FROM &PCD.EVAL&PCD_TBL.EVAL
;
END
-EXIT
 
 
 
 
SQL
SELECT *
FROM &BPR.EVAL&BPR_TBL.EVAL
;
END
-EXIT
 
 
SQL
SELECT *
FROM CLARITY_EAP
WHERE PROC_CODE = '305'
;
END
-EXIT
 
 
 
SQL
DELETE FROM &IFCT.EVAL&IFCT_TBL.EVAL
WHERE  RTRIM(IFCT_FILE_NAME) = 'UCLA20190816_BOA_POST_EDCA.835'
;
END
-EXIT
 
 
 
 
 
SQL
DELETE FROM xEPP_DUP_INV_CHK
WHERE TRUNC(DIC_UPDT_DT) < '01 JUN 2016'
;
END
-RUN
-*-SET  &RC_SCHED_DESC = 'RVU - Daily - Start RVU MV Refresh';
-DEFAULT &RC_OWNER   = 'svcfpgwf';
-RUN
-INCLUDE DSTRUN/&RC_USER_ID.EVAL
-RUN
 
-*-TYPE &RETURN.EVAL
-TYPE RETCODE &RETCODE.EVAL
-*-TYPE IORETURN &IORETURN.EVAL
-TYPE FOCERRNUM &FOCERRNUM.EVAL
-TYPE SQLERRM &SQLERRM.EVAL
-EXIT
 
xGeneric Execution
 
 
SQL
-*SELECT *
SELECT COUNT(*)
FROM EPP_DUP_INV_CHK
WHERE TRUNC(DIC_UPDT_DT) < '01 APR 2018'
-*WHERE DC_POST_DATE > '01 JAN 2019'
-*WHERE ROWNUM < 2
;
END
-EXIT
 
 
 
 
 
 
 
-*SQL
-*SELECT *
-*FROM REMIT_PROC_INFO
-*WHERE RECORD_ID = 88231
-*;
-*END
-*-EXIT
-*
-*
-*
-*SQL
-*SELECT *
-*FROM REMIT_RUN_SUM
-*WHERE REMIT_RUN = 135250
-*-*WHERE SUBSTR(FILE_NAME1,27) = '20190531_BOA_POST_HEALTHNET_ERA_EPIC_A.835'
-*-*WHERE SUBSTR(FILE_NAME,1,27) = '20190531_BOA_POST_HEALTHNET'
-*;
-*END
-*-EXIT
-*
-*
-*
-*
-*SQL
-*SELECT *
-*FROM CLARITY_EAP
-*WHERE PROC_NAME = '
-*;
-*END
-*-EXIT
-*
-*
-*
-*
 
 
 
 
 
 
 
 
 
 
 
SQL
SELECT *
FROM  &SVC_CAS.EVAL&SVC_CAS_TBL.EVAL
WHERE RTRIM(SVC_CAS_CLM_ADJ_RSN_CD1)  = 'CO'
;
END
-EXIT
 
-*SQL
-*SELECT *
-*FROM ACCOUNT WHERE ACCOUNT_ID = '900000068'
-*;
-*END
-*-EXIT
 
 
 
 
-*SQL
-*SELECT *
-*FROM CLARITY_TDL_TRAN
-*WHERE TX_ID = 149197916
-*  AND DETAIL_TYPE = 2
-*;
-*END
-*-EXIT
 
 
 
 
 
-*SQL
-*SELECT /*+ NOPARALLEL ORDERED NO_UNNEST */
-*      C.*
-*      C.TX_ID
-*     ,C.TDL_ID
-*     ,C.POST_DATE
-*	 ,C.SERVICE_DATE
-*FROM  CLARITY_TDL_TRAN A
-*LEFT OUTER JOIN
-*      CLARITY_TDL_TRAN B
-*ON    B.TX_ID        = A.TX_ID
-*  AND B.DETAIL_TYPE  = 32
-*LEFT OUTER JOIN
-*      CLARITY_TDL_TRAN C
-*ON    C.TX_ID   	 = B.MATCH_TRX_ID
-*WHERE A.TX_ID        = 149198027
-*  AND A.DETAIL_TYPE  = 2
-*;
-*END
-*-EXIT
 
 
 
SQL
SELECT *
-*      TX_COMMENT
-*     ,SUM(AMOUNT)
FROM  CLARITY_TDL_TRAN
WHERE REFERENCE_NUMBER LIKE '%402309%'
  AND DETAIL_TYPE = 2
-*  AND TX_COMMENT  = 33138
-*  AND POST_DATE >= '03 MAR 2019'
-*     OR POST_DATE = '28 FEB 2019' )
-*GROUP BY TX_COMMENT
ORDER BY 2
;
END
-EXIT
 
 
 
SQL
SELECT *
FROM ZC_PAYMENT_SOURCE
;
END
-EXIT
 
 
SQL
SELECT *
FROM  CLARITY_TDL_TRAN
WHERE POST_DATE >= '15 FEB 2019'  /* Deposit_Date */
  AND AMOUNT     = -70.04
-*  REFERENCE_NUMBER = '995742'    /* CheckNumber */
-*  AND AMOUNT           = -252.57        /* CheckAmount */
-*  AND PAYMENT_SOURCE_C = 28
-*  AND DETAIL_TYPE      = 2
-*  AND POST_DATE       >= '15 APR 2019'  /* Deposit_Date */
;
END
-EXIT
 
 
 
 
 
 
SQL
SELECT *
FROM ACCOUNT
WHERE ACCOUNT_ID = 122000661
;
END
-EXIT
 
 
SQL
SELECT *
FROM EPP_OTLT
ORDER BY 1,2,3,4,5
;
TABLEF FILE SQLOUT
PRINT *
END
-EXIT
 
 
 
 
 
 
 
 
 
 
-*SQL
-*SELECT MAX(CLP_CLM_SEQ_NO)
-*FROM &CLP.EVAL&CLP_TBL.EVAL
-*;
-*END
-*-EXIT
 
 
 
-*SQL
-*SELECT *
-*FROM &TRN.EVAL&TRN_TBL.EVAL
-*WHERE TRN_ST_SEQ_NO = 2
-*;
-*END
-*-EXIT
 
 
 
-*SQL
-*SELECT GS_GRP_SEQ_NO
-*      ,ST_SEQ_NO
-*	  ,LX_SEQ_NO
-*	  ,CLP_CLM_SEQ_NO
-*      ,COUNT(*)
-*FROM &GS.EVAL&GS_TBL.EVAL
-*INNER JOIN
-*     &ST.EVAL&ST_TBL.EVAL
-*ON 	 ST_ISA_FILE_ID   = GS_ISA_FILE_ID
-* AND ST_GS_GRP_SEQ_NO = GS_GRP_SEQ_NO
-*INNER JOIN
-*     &LX.EVAL&LX_TBL.EVAL
-*ON 	 LX_ISA_FILE_ID   = ST_ISA_FILE_ID
-* AND LX_GS_GRP_SEQ_NO = ST_GS_GRP_SEQ_NO
-* AND LX_ST_SEQ_NO     = ST_SEQ_NO
-*INNER JOIN
-*     &CLP.EVAL&CLP_TBL.EVAL
-*ON 	 CLP_ISA_FILE_ID   = LX_ISA_FILE_ID
-* AND CLP_GS_GRP_SEQ_NO = LX_GS_GRP_SEQ_NO
-* AND CLP_ST_SEQ_NO     = LX_ST_SEQ_NO
-* AND CLP_LX_SEQ_NO     = LX_SEQ_NO
-*GROUP BY
-*     GS_GRP_SEQ_NO
-*	,ST_SEQ_NO
-*	,LX_SEQ_NO
-*	,CLP_CLM_SEQ_NO
-*ORDER BY 1,2
-*;
-*TABLEF FILE SQLOUT
-*LIST *
-*END
-*-EXIT
 
SQL
SELECT
      ISA_FILE_ID
     ,(COALESCE(( SELECT
               SUM( 0-TO_NUMBER(COALESCE(RTRIM(PLB_PRVDR_ADJ_AMT1),'0'))
                   +0-TO_NUMBER(COALESCE(RTRIM(PLB_PRVDR_ADJ_AMT2),'0'))
                   +0-TO_NUMBER(COALESCE(RTRIM(PLB_PRVDR_ADJ_AMT3),'0'))
                   +0-TO_NUMBER(COALESCE(RTRIM(PLB_PRVDR_ADJ_AMT4),'0'))
                   +0-TO_NUMBER(COALESCE(RTRIM(PLB_PRVDR_ADJ_AMT5),'0'))
                   +0-TO_NUMBER(COALESCE(RTRIM(PLB_PRVDR_ADJ_AMT6),'0')) ) AS PLB_TOT_AMT
         FROM  &ISA.EVAL&ISA_TBL.EVAL
         LEFT OUTER JOIN
               &ST.EVAL&ST_TBL.EVAL
         ON    ST_ISA_FILE_ID         = ISA_FILE_ID
           AND ST_EXCL_RSN_CD         = '   '
         LEFT OUTER JOIN
               &PLB.EVAL&PLB_TBL.EVAL
         ON    PLB_ISA_FILE_ID        = ST_ISA_FILE_ID
           AND PLB_GS_GRP_SEQ_NO      = ST_GS_GRP_SEQ_NO
           AND PLB_ST_SEQ_NO          = ST_SEQ_NO
        ),0)
    +
       COALESCE(( SELECT
               SUM( TO_NUMBER(COALESCE(RTRIM(CLP_CLM_PYMT_AMT),  '0')) )   AS TOT_CLP_AMT
         FROM  &ISA.EVAL&ISA_TBL.EVAL
         LEFT OUTER JOIN
               &ST.EVAL&ST_TBL.EVAL
         ON    ST_ISA_FILE_ID         = ISA_FILE_ID
           AND ST_EXCL_RSN_CD         = '   '
         LEFT OUTER JOIN
               &CLP.EVAL&CLP_TBL.EVAL
         ON    CLP_ISA_FILE_ID        = ST_ISA_FILE_ID
           AND CLP_GS_GRP_SEQ_NO      = ST_GS_GRP_SEQ_NO
           AND CLP_ST_SEQ_NO          = ST_SEQ_NO
           AND CLP_EXCL_RSN_CD        = '   '
       ),0))                                                                AS TOT_PMT_AMT_OUT
FROM  &ISA.EVAL&ISA_TBL.EVAL
;
END
-EXIT
 
 
 
-*SQL
-*SELECT *
-*FROM CLARITY_TDL_TRAN
-*WHERE TX_ID = 138443085
-*;
-*END
-*-EXIT
 
 
SQL
SELECT *
FROM &CLP.EVAL&CLP_TBL.EVAL
INNER JOIN
      &SVC.EVAL&SVC_TBL.EVAL
ON    SVC_ISA_FILE_ID           = CLP_ISA_FILE_ID
  AND SVC_GS_GRP_SEQ_NO         = CLP_GS_GRP_SEQ_NO
  AND SVC_ST_SEQ_NO             = CLP_ST_SEQ_NO
  AND SVC_LX_SEQ_NO             = CLP_LX_SEQ_NO
  AND SVC_CLP_CLM_SEQ_NO        = CLP_CLM_SEQ_NO
  AND RTRIM(SVC_PROC1_CD)       = '93015'
  AND SVC_EXCL_RSN_CD           = '   '
WHERE RTRIM(CLP_CLM_SUBMTR_ID)  = 'P1217847560'
  AND CLP_EXCL_RSN_CD           = '   '
;
END
-EXIT
 
 
 
SQL
SELECT
      IFCT_FILE_DATE
     ,IFCT_FILE_PAYER
     ,TO_CHAR(IFCT_CREAT_DT,'MMDDYYYY') AS DATE_RECVD
     ,IFCT_STS
     ,IFCT_PAID_AMT_OUT
FROM &IFCT_TBL.EVAL
WHERE IFCT_STS = 'OLD'
  AND IFCT_CREAT_DT          >= '01 MAY 2018'
  AND IFCT_PAID_AMT_OUT      <> 0
  AND RTRIM(IFCT_FILE_PAYER) <> 'SIGNATURE'
;
TABLEF FILE SQLOUT
PRINT *
ON TABLE HOLD
END
-RUN
DEFINE FILE HOLD
DATE_RCVD/I8MDYY  = EDIT(DATE_RECVD);
RECVD_DATE/MDYY   = DATE_RCVD;
BEG_OF_WEEK/MDYYT = DATEADD(DATEMOV(RECVD_DATE, 'BOW'),'D',+0);
END_OF_WEEK/MDYYT = DATEADD(BEG_OF_WEEK,'D',6);
BEG_OF_WK/YMD     = DATECVT(BEG_OF_WEEK,'MDYYT','YMD');
AARP_AMT/P10.2    = IF IFCT_FILE_PAYER = 'AARPUHC'    THEN IFCT_PAID_AMT_OUT ELSE 0;
AETNA_AMT/P10.2   = IF IFCT_FILE_PAYER = 'AETNA'      THEN IFCT_PAID_AMT_OUT ELSE 0;
ANTHEM_AMT/P10.2  = IF IFCT_FILE_PAYER = 'ANTHEMBLUECROSS'  THEN IFCT_PAID_AMT_OUT ELSE 0;
CIGNA_AMT/P10.2   = IF IFCT_FILE_PAYER = 'CIGNA'      THEN IFCT_PAID_AMT_OUT ELSE 0;
MCARE_AMT/P10.2   = IF IFCT_FILE_PAYER = 'MEDICARE'   THEN IFCT_PAID_AMT_OUT ELSE 0;
MCAL_AMT/P10.2    = IF IFCT_FILE_PAYER = 'MEDICAL'    THEN IFCT_PAID_AMT_OUT ELSE 0;
TAPSTRY_AMT/P10.2 = IF IFCT_FILE_PAYER = 'TAPESTRY'   THEN IFCT_PAID_AMT_OUT ELSE 0;
UNITED_AMT/P10.2  = IF IFCT_FILE_PAYER = 'UNITEDHEALTHCARE' THEN IFCT_PAID_AMT_OUT ELSE 0;
BSHIELD_AMT/P10.2 = IF IFCT_FILE_PAYER = 'BLUESHIELD' THEN IFCT_PAID_AMT_OUT ELSE 0;
HNET_AMT/P10.2    = IF IFCT_FILE_PAYER = 'HEALTHNET'  THEN IFCT_PAID_AMT_OUT ELSE 0;
EDC_AMT/P10.2     = IF IFCT_FILE_PAYER = 'EDC'        THEN IFCT_PAID_AMT_OUT ELSE 0;
BOA_AMT/P10.2     = IF IFCT_FILE_PAYER = 'BOAMIXED'   THEN IFCT_PAID_AMT_OUT ELSE 0;
END
-*
SET LOOKGRAPH=VLINE
SET HAXIS=2000, VAXIS=1200
SET 3D=OFF
GRAPH FILE HOLD
SUM    AARP_AMT     AS ''
       AETNA_AMT    AS ''
-*	   ANTHEM_AMT   AS ''
	   CIGNA_AMT    AS ''
-*	   MCARE_AMT    AS ''
	   MCAL_AMT     AS ''
	   TAPSTRY_AMT  AS ''
	   UNITED_AMT   AS ''
-*	   BSHIELD_AMT  AS ''
	   HNET_AMT     AS ''
       EDC_AMT      AS ''
       BOA_AMT      AS ''
ACROSS BEG_OF_WK    AS ''
ON GRAPH SET GRAPHSTYLE *
setY1LogScale(false);
ENDSTYLE
END
-RUN
-*TABLE FILE HOLD
-*GRAPH  IFCT_PAID_AMT_OUT
-*ACROSS BEG_OF_WEEK
-*BY     IFCT_FILE_PAYER
-*END
-*-RUN
-EXIT
 
 
 
SQL
SELECT *
FROM EPP
 
 
 
 
SQL
SELECT  MAX(CRCS_IFCT_FILE_ID)
FROM EPP_CHGD_RSN_CODE_SUM
-*WHERE ROWNUM < 101
;
END
-EXIT
 
 
 
 
 
 
 
SQL
SELECT  *
-*      RTRIM(CLP_CLM_SUBMTR_ID)
-*     ,SVC_CAS_CLM_ADJ_GRP_CD1
-*     ,SVC_CAS_CLM_ADJ_RSN_CD1
-*     ,SVC_CAS_CLM_ADJ_RSN_CD2
-*     ,SVC_CAS_CLM_ADJ_RSN_CD3
FROM  &CLP.EVAL&CLP_TBL.EVAL
INNER JOIN
      &SVC.EVAL&SVC_TBL.EVAL
ON    SVC_ISA_FILE_ID           = CLP_ISA_FILE_ID
  AND SVC_GS_GRP_SEQ_NO         = CLP_GS_GRP_SEQ_NO
  AND SVC_ST_SEQ_NO             = CLP_ST_SEQ_NO
  AND SVC_LX_SEQ_NO             = CLP_LX_SEQ_NO
  AND SVC_CLP_CLM_SEQ_NO        = CLP_CLM_SEQ_NO
-*  AND RTRIM(SVC_PROC1_CD)       = 'J0702'
-*  AND RTRIM(SVC_LI_PRVDR_PYMT)  IN('10.40','2.89')
  AND SVC_INCL_RSN_CD           = 'MPP'
-*  AND TO_NUMBER(COALESCE(RTRIM(SVC_LI_PRVDR_PYMT),'0')) = 0
-*INNER JOIN
-*      &SVC_DTM.EVAL&SVC_DTM_TBL.EVAL D1
-*ON    SVC_DTM_ISA_FILE_ID       = SVC_ISA_FILE_ID
-*  AND SVC_DTM_GS_GRP_SEQ_NO     = SVC_GS_GRP_SEQ_NO
-*  AND SVC_DTM_ST_SEQ_NO         = SVC_ST_SEQ_NO
-*  AND SVC_DTM_LX_SEQ_NO         = SVC_LX_SEQ_NO
-*  AND SVC_DTM_CLP_CLM_SEQ_NO    = SVC_CLP_CLM_SEQ_NO
-*  AND SVC_DTM_SVC_SEQ_NO        = SVC_SEQ_NO
-*  AND SVC_DTM_DTTM_QLFR         IN( '472','150' )
-*  AND SVC_DTM_EXCL_RSN_CD       = '   '
-*INNER JOIN
-*      &SVC_CAS.EVAL&SVC_CAS_TBL.EVAL
-*ON    SVC_CAS_ISA_FILE_ID       = SVC_ISA_FILE_ID
-*  AND SVC_CAS_GS_GRP_SEQ_NO     = SVC_GS_GRP_SEQ_NO
-*  AND SVC_CAS_ST_SEQ_NO         = SVC_ST_SEQ_NO
-*  AND SVC_CAS_LX_SEQ_NO         = SVC_LX_SEQ_NO
-*  AND SVC_CAS_CLP_CLM_SEQ_NO    = SVC_CLP_CLM_SEQ_NO
-*  AND SVC_CAS_SVC_SEQ_NO        = SVC_SEQ_NO
-*  AND SVC_CAS_INCL_RSN_CD       = 'MCS'
-*-*  AND RTRIM(SVC_CAS_CLM_ADJ_RSN_CD1) = '2'
-*-*  AND TO_NUMBER(COALESCE(RTRIM(SVC_CAS_CLM_ADJ_AMT1),'0'))
-*-*      = TO_NUMBER(COALESCE(RTRIM(SVC_ORGLI_PRVDR_PYMT),'0'))
-*INNER JOIN
-*      CLARITY_TDL_TRAN
-*ON    INVOICE_NUMBER            = RTRIM(CLP_CLM_SUBMTR_ID)
-*  AND CPT_CODE                  = RTRIM(SVC_PROC1_CD)
-*  AND ORIG_SERVICE_DATE         = TO_DATE(SVC_DTM_DATE, 'YYYYMMDD')
-*  AND CUR_FIN_CLASS             = '2'
-*-*WHERE SUBSTR(CLP_CLM_SUBMTR_ID,11,1) = '0'
-*WHERE RTRIM(CLP_CLM_SUBMTR_ID) = 'P1197135770'
-*  AND CLP_EXCL_RSN_CD          = '   '
;
END
-EXIT
 
 
SQL
SELECT *
FROM CLARITY_EAP_CMS
WHERE ROWNUM < 11
;
END
-EXIT
 
SQL
-*SELECT TO_CHAR((TO_DATE('20180101','YYYYMMDD'))-64649,'MM/DD/YYYY')
-*SELECT TO_DATE('20180101','YYYYMMDD')-TO_DATE('18401231','YYYYMMDD')
SELECT TRUNC(CONTACT_DATE_REAL)
      ,CONTACT_DATE-TO_DATE('18401231','YYYYMMDD')
      ,TO_DATE('18401231','YYYYMMDD')+TRUNC(CONTACT_DATE_REAL)
 
 
 
SELECT
      PROC_ID
     ,MAX(CONTACT_DATE_REAL)
FROM  CLARITY_EAP_CMS
WHERE PROC_ID = PROC_ID
 
 
 
SELECT
      PROC_ID
     ,CONTACT_DATE_REAL
	 ,MAX(LINE)
FROM  CLARITY_EAP_CMS
WHERE PROC_ID = PROC_ID
  AND DOS-TO_DATE('18401231','YYYYMMDD') >= TRUNC(CONTACT_DATE_REAL)
  AND DOS   >= CONTACT_DATE
  AND COALESCE(FS_MOD,NULL) = CMS_MODIFIER
  AND DOS-TO_DATE('18401231','YYYYMMDD') < ( SELECT MIN(TRUNC(CONTACT_DATE_REAL))
                                             FROM PROC_ID = PROC_ID
                                              AND DOS-TO_DATE('18401231','YYYYMMDD') >= TRUNC(CONTACT_DATE_REAL)
                                              AND DOS >= CONTACT_DATE
										      AND COALESCE(FS_MOD,NULL) = CMS_MODIFIER )
GROUP BY
      PROC_ID
     ,CONTACT_DATE_REAL
 
 
FROM CLARITY_EAP_CMS
WHERE ROWNUM < 11
-*WHERE ROWNUM < 11
;
END
-EXIT
 
1841/09/06
 
 
64649
 
 
 
 
 
 
 
 
SQL
SELECT *
FROM LOCALE
;
TABLEF FILE SQLOUT
PRINT *
ON TABLE HOLD
END
-RUN
TABLEF FILE HOLD
PRINT *
ON TABLE PCHOLD FORMAT EXL07
END
-EXIT
 
 
 
-*SQL
-*SELECT *
-*FROM CLARITY_TDL_TRAN
-*WHERE MATCH_TRX_ID = 125167683
-*;
-*END
-*-EXIT
 
 
SQL
SELECT *
FROM CLARITY_TDL_TRAN
-*WHERE TDL_ID = 125167683200031
WHERE TX_ID = 124904812
;
END
-EXIT
 
 
SQL
SELECT USER FROM DUAL;
END
-EXIT
 
SQL
GRANT SELECT ON EPP.EPP_DAILY_STATUS_FILE_AMTS TO EPP_STAGE;
END
-EXIT
 
 
 
 
 
SQL
SELECT *
FROM PMT_EOB_INFO_I
WHERE ICN = '000286488100'
;
END
-EXIT
 
 
-*SQL
-*SELECT *
-*FROM &CLP.EVAL&CLP_TBL.EVAL
-*WHERE CLP_INCL_RSN_CD = 'F33'
-*-*  AND RTRIM(CLP_CLM_SUBMTR_ID) = 'P1196524490'
-*;
-*END
-*-EXIT
-*
-*
-*
-*P1195738070
-*SQL
-*SELECT *
-*FROM INV_BASIC_INFO
-*WHERE INV_ID = 16531299
-*;
-*END
-*-EXIT
 
 
 
-*
-*
-*
-*
-*-*SQL
-*-*SELECT *
-*-*FROM ARPB_TRANSACTIONS
-*-*WHERE TX_ID = 108490908
-*-*;
-*-*END
-*-*-EXIT
 
 
 
 
 
 
 
 
 
SQL
SELECT *
FROM &SVC_DTM.EVAL&SVC_DTM_TBL.EVAL
WHERE SVC_DTM_EXCL_RSN_CD = 'FXD'
;
END
-EXIT
 
 
-*SQL
-*DELETE FROM &SVC.EVAL&SVC_TBL.EVAL
-*WHERE SVC_INCL_RSN_CD = 'FCA'
-*;
-*END
-*-EXIT
 
 
 
-*SQL
-*SELECT *
-*FROM &CLP.EVAL&CLP_TBL.EVAL
-*-*WHERE CLP_CL_TX_MATCH_TYPE   = 'CC3'
-*WHERE RTRIM(CLP_CLM_SUBMTR_ID) = 'P1190506090'
-*-*  AND CLP_CLM_STATUS_CD = '22'
-*-*-*WHERE CLP_CL_TX_MATCH_TYPE   = 'CP3'
-*-*-*WHERE RTRIM(CLP_CLM_SUBMTR_ID) = 'P1100607470'
-*-*-*WHERE CLP_INCL_RSN_CD = 'F24'
-*-*WHERE RTRIM(CLP_PYR_CLM_CNTL_NO) = '20180404900007800003'
-*AND CLP_EXCL_RSN_CD = '   '
-*;
-*END
-*-EXIT
 
 
 
 
 
 
 
 
 
 
 
 
SQL
SELECT *
FROM &SVC.EVAL&SVC_TBL.EVAL
WHERE SVC_EXCL_RSN_CD = 'F26'
;
END
-EXIT
 
 
 
 
 
 
 
 
 
 
 
 
SQL
SELECT *
FROM ARPB_TX_MODERATE
WHERE TX_ID = 92386434
;
END
-EXIT
 
 
 
SQL
SELECT *
FROM CLARITY_TDL_TRAN
WHERE TX_ID = 118667696
;
END
-EXIT
 
 
 
 
 
 
 
 
 
 
 
SQL
DELETE FROM &IFCT.EVAL&IFCT_TBL.EVAL
WHERE RTRIM(IFCT_FILE_NAME) = '20180403_BOA_POST_TAPESTRY_ERA_P_1706_EPP.835'
;
END
-EXIT
SQL
SELECT *
FROM &IFCT.EVAL&IFCT_TBL.EVAL
WHERE ROWNUM <2
;
END
-EXIT
 
 
 
 
 
 
 
 
 
-*SQL
-*SELECT *
-*FROM &CLP_CAS.EVAL&CLP_CAS_TBL.EVAL
-*WHERE CLP_CAS_INCL_RSN_CD = 'CP0'
-*;
-*END
-*-EXIT
-*
-*
 
-*
 
-*SQL
-*SELECT CLP_CLM_SUBMTR_ID                AS INVOICE
-*      ,CLP_CLM_STATUS_CD                AS STS
-*      ,CLP_TOT_CLM_CRG_AMT              AS CLAIM_AMOUNT
-*      ,CLP_CLM_PYMT_AMT                 AS CLAIM_PMT
-*      ,CLP_PT_RESP_AMT                  AS PT_RESP
-*      ,CLP_CAS_CLM_ADJ_GRP_CD1          AS GRP_CD
-*      ,CLP_CAS_CLM_ADJ_RSN_CD1          AS RSN_CD
-*      ,CLP_CAS_CLM_ADJ_AMT1             AS AMT1
-*-*      ,CLP_CAS_CLM_ADJ_RSN_CD2
-*-*      ,CLP_CAS_CLM_ADJ_AMT2
-*      ,CLP_EXCL_RSN_CD                  AS CLP_EXCL_CD
-*      ,CLP_CAS_EXCL_RSN_CD              AS CLP_CAS_EXCL_CD
-*FROM  &CLP.EVAL&CLP_TBL.EVAL
-*INNER JOIN
-*      &CLP_CAS.EVAL&CLP_CAS_TBL.EVAL
-*ON    CLP_CAS_ISA_FILE_ID           = CLP_ISA_FILE_ID
-*  AND CLP_CAS_GS_GRP_SEQ_NO         = CLP_GS_GRP_SEQ_NO
-*  AND CLP_CAS_ST_SEQ_NO             = CLP_ST_SEQ_NO
-*  AND CLP_CAS_LX_SEQ_NO             = CLP_LX_SEQ_NO
-*  AND CLP_CAS_CLP_CLM_SEQ_NO        = CLP_CLM_SEQ_NO
-*-*  AND ( SUBSTR(CLP_CAS_EXCL_RSN_CD,1,2) = 'AA' )
-*-*    OR  SUBSTR(CLP_EXCL_RSN_CD,1,2)     = 'AA' )
-*WHERE CLP_CAS_INCL_RSN_CD = 'CP0'
-*-*WHERE CLP_EXCL_RSN_CD               = '   '
-*;
-*END
-*-EXIT
-*SQL
-*SELECT *
-*FROM &SVC_CAS.EVAL&SVC_CAS_TBL.EVAL
-*WHERE SVC_CAS_INCL_RSN_CD = 'MCS'
-*;
-*END
-*-EXIT
-*
-*
 
 
 
 
SQL
SELECT *
-*      RTRIM(CLP_CLM_SUBMTR_ID)
-*     ,SVC_CAS_CLM_ADJ_GRP_CD1
-*     ,SVC_CAS_CLM_ADJ_RSN_CD1
-*     ,SVC_CAS_CLM_ADJ_RSN_CD2
-*     ,SVC_CAS_CLM_ADJ_RSN_CD3
FROM  &CLP.EVAL&CLP_TBL.EVAL
INNER JOIN
      &SVC.EVAL&SVC_TBL.EVAL
ON    SVC_ISA_FILE_ID           = CLP_ISA_FILE_ID
  AND SVC_GS_GRP_SEQ_NO         = CLP_GS_GRP_SEQ_NO
  AND SVC_ST_SEQ_NO             = CLP_ST_SEQ_NO
  AND SVC_LX_SEQ_NO             = CLP_LX_SEQ_NO
  AND SVC_CLP_CLM_SEQ_NO        = CLP_CLM_SEQ_NO
  AND SVC_EXCL_RSN_CD           = '   '
-*  AND TO_NUMBER(COALESCE(RTRIM(SVC_LI_PRVDR_PYMT),'0')) = 0
-*INNER JOIN
-*      &SVC_DTM.EVAL&SVC_DTM_TBL.EVAL
-*ON    SVC_DTM_ISA_FILE_ID       = SVC_ISA_FILE_ID
-*  AND SVC_DTM_GS_GRP_SEQ_NO     = SVC_GS_GRP_SEQ_NO
-*  AND SVC_DTM_ST_SEQ_NO         = SVC_ST_SEQ_NO
-*  AND SVC_DTM_LX_SEQ_NO         = SVC_LX_SEQ_NO
-*  AND SVC_DTM_CLP_CLM_SEQ_NO    = SVC_CLP_CLM_SEQ_NO
-*  AND SVC_DTM_SVC_SEQ_NO        = SVC_SEQ_NO
-*  AND SVC_DTM_DTTM_QLFR         IN( '472','150' )
-*  AND SVC_DTM_EXCL_RSN_CD       = '   '
INNER JOIN
      &SVC_CAS.EVAL&SVC_CAS_TBL.EVAL
ON    SVC_CAS_ISA_FILE_ID       = SVC_ISA_FILE_ID
  AND SVC_CAS_GS_GRP_SEQ_NO     = SVC_GS_GRP_SEQ_NO
  AND SVC_CAS_ST_SEQ_NO         = SVC_ST_SEQ_NO
  AND SVC_CAS_LX_SEQ_NO         = SVC_LX_SEQ_NO
  AND SVC_CAS_CLP_CLM_SEQ_NO    = SVC_CLP_CLM_SEQ_NO
  AND SVC_CAS_SVC_SEQ_NO        = SVC_SEQ_NO
  AND SVC_CAS_INCL_RSN_CD       = 'MCS'
-*-*  AND RTRIM(SVC_CAS_CLM_ADJ_RSN_CD1) = '2'
-*-*  AND TO_NUMBER(COALESCE(RTRIM(SVC_CAS_CLM_ADJ_AMT1),'0'))
-*-*      = TO_NUMBER(COALESCE(RTRIM(SVC_ORGLI_PRVDR_PYMT),'0'))
-*INNER JOIN
-*      CLARITY_TDL_TRAN
-*ON    INVOICE_NUMBER            = RTRIM(CLP_CLM_SUBMTR_ID)
-*  AND CPT_CODE                  = RTRIM(SVC_PROC1_CD)
-*  AND ORIG_SERVICE_DATE         = TO_DATE(SVC_DTM_DATE, 'YYYYMMDD')
-*  AND CUR_FIN_CLASS             = '2'
-*-*WHERE SUBSTR(CLP_CLM_SUBMTR_ID,11,1) = '0'
-*WHERE RTRIM(CLP_CLM_SUBMTR_ID) = 'P1188003071'
-*  AND CLP_EXCL_RSN_CD          = '   '
;
END
-EXIT
 
 
 
 
 
-*SQL
-*-*WITH fee_info AS(
-*select
-*  mc.fee_schedule_id,
-*  eap.proc_code,
-*  eap.proc_name as proc_name,
-*  proc.proc_mod_id,
-*  proc.unit_charge_amount
-*from
-*  --Get the MAX contact for
-*  (
-*    select
-*      fee_schedule_id,
-*      proc_id,
-*      proc_mod_id,
-*      max(contact_date_real) as max_contact
-*    from clarity_fsc_proc
-*    group by
-*      fee_schedule_id,
-*      proc_id,
-*      proc_mod_id
-*  ) mc
-*  INNER JOIN clarity_fsc_proc proc
-*    ON  proc.fee_schedule_id = mc.fee_schedule_id AND proc.proc_id = mc.proc_id  AND proc.contact_date_real = mc.max_contact AND
-*           ( proc.proc_mod_id = mc.proc_mod_id OR (proc.proc_mod_id is null AND mc.proc_mod_id is null) )
-*  left outer join clarity_fsc fsc
-*    on proc.fee_schedule_id = fsc.fee_schedule_id
-* left outer join clarity_eap eap
-*    on proc.proc_id = eap.proc_id
-*where
-* eap.is_active_yn = 'Y' AND proc.fee_schedule_id IN (100,300,500, 16492)
-*-*);
-*-*  SELECT
-*-*  *
-*-*  FROM fee_info
-*-*  pivot ( sum(unit_charge_amount) FOR fee_schedule_id IN (100,300,500, 16492))
-*-*-*--  WHERE
-*-*-*--  proc_code = '99212'
-*-*  ORDER BY PROC_CODE, PROC_MOD_ID
-*;
-*END
-*-EXIT
 
 
 
 
 
SQL
SELECT *
FROM  ARPB_TRANSACTIONS
WHERE TX_ID = 109887910
;
END
-EXIT
SQL
SELECT *
FROM &TCT.EVAL&TCT_TBL.EVAL
WHERE ROWNUM < 11
;
END
-EXIT
-*SQL
-*SELECT *
-*FROM ZC_PAYMENT_SOURCE
-*;
-*END
-*-EXIT
SQL
SELECT B.*
FROM CLARITY_TDL_TRAN A
INNER JOIN
     CLARITY_TDL_TRAN B
ON    B.TX_ID             = A.MATCH_TRX_ID
-*  AND B.DETAIL_TYPE       = 2
-*  AND B.PAYMENT_SOURCE_C  = 27
WHERE A.TX_ID = 97306193
-*WHERE A.ORIG_SERVICE_DATE = '18 MAY 2017'
-*  AND A.CPT_CODE          = 'A9552'
-*-*  AND A.ORIG_PRICE        = 1320
  AND A.DETAIL_TYPE       = 20
-*  AND ABS(B.INSURANCE_AMOUNT) > 35000
-*ORDER BY B.REFERENCE_NUMBER
;
END
-EXIT
 
SQL
SELECT *
FROM CLARITY_TDL_TRAN
WHERE TX_ID = 293817721
;
END
-EXIT
SQL
SELECT *
FROM &OTLT.EVAL&OTLT_TBL.EVAL
;
END
-EXIT
SQL
SELECT *
FROM CLARITY_TDL_TRAN
WHERE TX_ID = 71023286
;
END
-EXIT
SQL
SELECT *
-*      RTRIM(CLP_CLM_SUBMTR_ID)
-*     ,SVC_CAS_CLM_ADJ_GRP_CD1
-*     ,SVC_CAS_CLM_ADJ_RSN_CD1
-*     ,SVC_CAS_CLM_ADJ_RSN_CD2
-*     ,SVC_CAS_CLM_ADJ_RSN_CD3
FROM  &CLP.EVAL&CLP_TBL.EVAL
INNER JOIN
      &SVC.EVAL&SVC_TBL.EVAL
ON    SVC_ISA_FILE_ID           = CLP_ISA_FILE_ID
  AND SVC_GS_GRP_SEQ_NO         = CLP_GS_GRP_SEQ_NO
  AND SVC_ST_SEQ_NO             = CLP_ST_SEQ_NO
  AND SVC_LX_SEQ_NO             = CLP_LX_SEQ_NO
  AND SVC_CLP_CLM_SEQ_NO        = CLP_CLM_SEQ_NO
  AND SVC_EXCL_RSN_CD           = '   '
-*  AND TO_NUMBER(COALESCE(RTRIM(SVC_LI_PRVDR_PYMT),'0')) = 0
-*INNER JOIN
-*      &SVC_DTM.EVAL&SVC_DTM_TBL.EVAL
-*ON    SVC_DTM_ISA_FILE_ID       = SVC_ISA_FILE_ID
-*  AND SVC_DTM_GS_GRP_SEQ_NO     = SVC_GS_GRP_SEQ_NO
-*  AND SVC_DTM_ST_SEQ_NO         = SVC_ST_SEQ_NO
-*  AND SVC_DTM_LX_SEQ_NO         = SVC_LX_SEQ_NO
-*  AND SVC_DTM_CLP_CLM_SEQ_NO    = SVC_CLP_CLM_SEQ_NO
-*  AND SVC_DTM_SVC_SEQ_NO        = SVC_SEQ_NO
-*  AND SVC_DTM_DTTM_QLFR         IN( '472','150' )
-*  AND SVC_DTM_EXCL_RSN_CD       = '   '
-*INNER JOIN
-*      &SVC_CAS.EVAL&SVC_CAS_TBL.EVAL
-*ON    SVC_CAS_ISA_FILE_ID       = SVC_ISA_FILE_ID
-*  AND SVC_CAS_GS_GRP_SEQ_NO     = SVC_GS_GRP_SEQ_NO
-*  AND SVC_CAS_ST_SEQ_NO         = SVC_ST_SEQ_NO
-*  AND SVC_CAS_LX_SEQ_NO         = SVC_LX_SEQ_NO
-*  AND SVC_CAS_CLP_CLM_SEQ_NO    = SVC_CLP_CLM_SEQ_NO
-*  AND SVC_CAS_SVC_SEQ_NO        = SVC_SEQ_NO
-*  AND SVC_CAS_EXCL_RSN_CD       = '   '
-*-*  AND RTRIM(SVC_CAS_CLM_ADJ_RSN_CD1) = '2'
-*-*  AND TO_NUMBER(COALESCE(RTRIM(SVC_CAS_CLM_ADJ_AMT1),'0'))
-*-*      = TO_NUMBER(COALESCE(RTRIM(SVC_ORGLI_PRVDR_PYMT),'0'))
-*INNER JOIN
-*      CLARITY_TDL_TRAN
-*ON    INVOICE_NUMBER            = RTRIM(CLP_CLM_SUBMTR_ID)
-*  AND CPT_CODE                  = RTRIM(SVC_PROC1_CD)
-*  AND ORIG_SERVICE_DATE         = TO_DATE(SVC_DTM_DATE, 'YYYYMMDD')
-*  AND CUR_FIN_CLASS             = '2'
-*-*WHERE SUBSTR(CLP_CLM_SUBMTR_ID,11,1) = '0'
WHERE RTRIM(CLP_CLM_SUBMTR_ID) = 'P1156877070'
;
END
-EXIT
-*-*SQL
-*-*SELECT *
-*-*FROM   CLARITY_EPM
-*-*-*WHERE  PAYOR_ID = 1088
-*-*WHERE  SUBSTR(PAYOR_NAME,1,2) = 'SU'
-*-*;
-*-*END
-*-*-EXIT
-*-*
-*-*
-*-*
-*-*
-*-*
SQL
SELECT *
FROM CLARITY_TDL_TRAN
WHERE INVOICE_NUMBER = 'P1110949970'
-*  AND DETAIL_TYPE    = 50
-*  AND ORIG_DATE_SERVICE  = '23 JUN 2017'
-*  AND ROWNUM < 11
;
END
-EXIT
 
-*SQL
-*SELECT *
-*FROM   &CLP.EVAL&CLP_TBL.EVAL
-*WHERE  CLP_CLM_SUBMTR_ID = 'P1111831110'
-*-*WHERE CLP_PYR_CLM_CNTL_NO = '17009732521'
-*;
-*END
-*-EXIT
-*SQL
-*SELECT *
-*FROM   &CLP.EVAL&CLP_TBL.EVAL
-*-*WHERE  CLP_EXCL_RSN_CD = 'AFB'
-*WHERE CLP_PYR_CLM_CNTL_NO = '17009732521'
-*;
-*END
-*-EXIT
-*-*
-*-*
SQL
SELECT CLP_EXCL_RSN_CD
      ,COUNT(*)
FROM   &CLP.EVAL&CLP_TBL.EVAL
WHERE  CLP_EXCL_RSN_CD NOT IN('AA2','AA8','AA6','ABC','AFA','AFB','BCA','BI9','CB2','CB3','CL0','CL2','CL3','CL5','CL6','CL7','CLE','CLF','CLJ','CLL','CLQ',
                              'CLW','CLZ','CMS','CSB','CSC','CSD','D24','DI1','DP1','DP2','EP2','ES1','ES8','F1A','F11','F12','FA1','FAA','FCA','FCB','FI0','FI9','FIB',
                              'FIC','FIN','FIS','FIW','FP1','FP3','FP5','FP6','FP8','FXC','FXK','FXV','MP0','MPC','NID','OSR','OS2','OS6','OS7','PS1','PS2','RCJ','RCR',
                              'RCQ','RCW','RCX','RCZ','RDA','RD0','RNP','RO1','RO2','RO4','RP1','RRI','RS1','RSS','RVB','RVC','RVD','RZF','RZG','RZN','RZP',
                              'RZQ','SD1','SD5','SNV','S2M','ZZ1','ZZ3','ZZ5','ZZG','   ')
GROUP BY CLP_EXCL_RSN_CD
ORDER BY 1
;
END
-RUN
SQL
SELECT CLP_INCL_RSN_CD
      ,COUNT(*)
FROM   &CLP.EVAL&CLP_TBL.EVAL
WHERE  CLP_INCL_RSN_CD NOT IN('AA2','AA8','AA6','ABC','AFA','AFB','BCA','BI9','CB2','CB3','CL0','CL2','CL3','CL5','CL6','CL7','CLE','CLF','CLJ','CLL','CLW',
                              'CLZ','CMS','CSB','CSC','CSD','D24','DI1','DP1','DP2','EP2','ES1','ES8','F1A','F11','F12','FA1','FAA','FCA','FCB','FI0','FI9','FIB','FIC','FIN',
                              'FIS','FIW','FP1','FP3','FP5','FP6','FP8','FXC','FXK','FXV','MP0','NID','ORG','OSR','OS2','OS6','OS7','PS1','PS2','RCJ','RCR',
                              'RCQ','RCW','RCX','RCZ','RDA','RD0','RNP','RO1','RO2','RO4','RP1','RRI','RS1','RSS','RVB','RVC','RVD','RZF','RZG','RZN','RZP',
                              'RZQ','SD1','SD5','SNV','S2M','ZZ1','ZZ3','ZZ5','ZZG','   ')
GROUP BY CLP_INCL_RSN_CD
ORDER BY 1
;
END
-RUN
SQL
SELECT
      SVC_EXCL_RSN_CD
     ,COUNT(*)
FROM &SVC.EVAL&SVC_TBL.EVAL
WHERE SVC_EXCL_RSN_CD NOT IN('AA0','AA2','AA6','AA8','ABC','AFA','AFB','BCA','BI9','CB2','CB3','CL0','CL2','CL3','CL5','CL6','CL7','CLE','CLF','CLJ','CLL','CLW',
                             'CLZ','CMS','CS1','CSB','CSC','CSD','DI1','DP1','DP2','EP2','EP4','ES1','ES8','F1A','F11','F12','FA1','FAA','FCA','FCB','FI0','FI9','FIB','FIC','FIN',
                             'FIS','FIW','FP1','FP3','FP5','FP6','FP8','FXC','FXK','FXV','MP0','MPC','MRC','NID','ORG','OSP','OSQ','OSR','OS2','OS6','OS7','PC2','RAQ','RCR','RCQ',
                             'RCW','RCX','RCZ','RDA','RNP','RO1','RO2','RO4','RP1','RRI','RS1','RSS','RVB','RVC','RVD','RZF','RZG','RZN','RZP','RZQ','SD1','SD5',
                             'SNV','S2M','ZZ1','ZZ3','ZZ5','ZZG','   ')
GROUP BY SVC_EXCL_RSN_CD
ORDER BY 2
;
END
-RUN
SQL
SELECT
      SVC_INCL_RSN_CD
     ,COUNT(*)
FROM &SVC.EVAL&SVC_TBL.EVAL
WHERE SVC_INCL_RSN_CD NOT IN('AA0','AA2','AA6','AA8','ABC','AFA','AFB','BCA','BI9','CB2','CB3','CL0','CL2','CL3','CL5','CL6','CL7','CLE','CLF','CLJ','CLL','CLW',
                             'CLZ','CMS','CS1','CSB','CSC','CSD','DI1','DP1','DP2','EP2','EP4','ES1','ES8','F1A','F11','F12','FA1','FAA','FCA','FCB','FI0','FI9','FIB','FIC','FIN',
                             'FIS','FIW','FP1','FP3','FP5','FP6','FP8','FXC','FXK','MP0','MRC','NID','ORG','OSP','OSQ','OSR','OS2','OS6','OS7','PC2','RAQ','RCR','RCQ',
                             'RCW','RCX','RCZ','RDA','RNP','RO1','RO2','RO4','RP1','RRI','RS1','RSS','RVB','RVC','RVD','RZG','RZN','RZP','RZQ','SD1','SD5',
                             'SNV','S2M','ZZ1','ZZ3','ZZ5','ZZG','   ')
GROUP BY SVC_INCL_RSN_CD
ORDER BY 2
;
END
-RUN
SQL
SELECT SVC_DTM_INCL_RSN_CD
      ,COUNT(*)
FROM   &SVC_DTM.EVAL&SVC_DTM_TBL.EVAL
WHERE  SVC_DTM_INCL_RSN_CD NOT IN('AA2','AA6','AA8','ABC','AFA','AFB','BCA','CB2','CB3','CL0','CL2','CL3','CL5','CL6','CL7','CLE','CLF','CLJ','CLL','CLW','CLZ','CMS',
                                  'CS1','CSB','CSC','CSD','DI1','DP1','DP2','EP2','ES1','ES8','F1A','F11','F12','FA1','FAA','FCA','FCB','FI0','FI9','FIB','FIC','FIN','FIS','FIW','FP1',
                                  'FP3','FP5','FP6','FP8','FXC','FXD','FXK','MP0','NID','ORG','OSP','OSQ','OSR','OS2','OS6','OS7','PC2','RCR','RCW','RCX','RCZ','RDA','RNP',
                                  'RO1','RO2','RO4','RP1','RRI','RS1','RSS','RVB','RVC','RVD','RZG','RZN','RZP','RZQ','SD1','SD2','SD3','SD5','SNV','S2M','ZZ1','ZZ3',
                                  'ZZ5','ZZG','   ')
GROUP BY SVC_DTM_INCL_RSN_CD
;
END
-RUN
SQL
SELECT SVC_DTM_EXCL_RSN_CD
      ,COUNT(*)
FROM   &SVC_DTM.EVAL&SVC_DTM_TBL.EVAL
WHERE  SVC_DTM_EXCL_RSN_CD NOT IN('AA2','AA6','AA8','ABC','AFA','AFB','BCA','CB2','CB3','CL0','CL2','CL3','CL5','CL6','CL7','CLE','CLF','CLJ','CLL','CLW','CLZ','CMS',
                                  'CSB','CSC','CSD','DI1','DP1','DP2','EP2','ES1','ES8','F1A','F11','F12','FA1','FAA','FCA','FCB','FI0','FI9','FIB','FIC','FIN','FIS','FIW','FP1',
                                  'FP3','FP5','FP6','FP8','FXC','FXD','FXK','MP0','NID','OSP','OSQ','OSR','OS2','OS6','OS7','PC2','RCR','RCW','RCX','RCZ','RDA','RNP','RO1',
                                  'RO2','RO4','RP1','RRI','RS1','RSS','RVB','RVC','RVD','RZG','RZN','RZP','RZQ','SD1','SD2','SD3','SD5','SNV','S2M','ZZ1','ZZ3','ZZ5','ZZG','   ')
GROUP BY SVC_DTM_EXCL_RSN_CD
;
END
-RUN
SQL
SELECT SVC_CAS_INCL_RSN_CD
      ,COUNT(*)
FROM   &SVC_CAS.EVAL&SVC_CAS_TBL.EVAL
WHERE  SVC_CAS_INCL_RSN_CD NOT IN('AA2','AA6','AA8','ABC','AFA','AFB','AJ1','BCA','C16','CB2','CB3','CL0','CL2','CL3','CL5','CL6','CL7','CLB','CLE','CLF','CLJ','CLL','CLW',
                                  'CLZ','CMS','CS1','CSB','CSC','CSD','C0A','DI1','DP1','DP2','EP2','ES1','ES8','F1A','F11','F12','FA1','FAA','FCA','FCB','FI0','FI9','FIB','FIC','FIN','FIS',
                                  'FIW','FP1','FP3','FP5','FP6','FP8','FXC','FXK','MP0','NID','ORG','OSP','OSQ','OSR','OS2','OS6','OS7','PC2','PR1','RCR','RDA','RCW','RCX','RCZ',
                                  'RNP','RO1','RO2','RO4','RP1','RRI','RS1','RSS','RVB','RVC','RVD','RZG','RZN','RZP','RZQ','SD1','SD2','SD3','SD5','SNV','S2M',
                                  'ZZ1','ZZ3','ZZ5','ZZG','   ')
GROUP BY SVC_CAS_INCL_RSN_CD
;
END
-RUN
SQL
SELECT SVC_CAS_EXCL_RSN_CD
      ,COUNT(*)
FROM   &SVC_CAS.EVAL&SVC_CAS_TBL.EVAL
WHERE  SVC_CAS_EXCL_RSN_CD NOT IN('AA2','AA6','AA8','ABC','AFA','AFB','AJ1','BCA','C16','CB2','CB3','CL0','CL2','CL3','CL5','CL7','CLE','CLF','CLJ','CLL','CLW','CLZ',
                                  'CMS','CSB','CSC','CSD','C0A','DI1','DP1','DP2','EP2','ES1','ES8','F1A','F11','F12','FA1','FAA','FCA','FCB','FI0','FI9','FIB','FIC','FIN','FIS','FIW','FP1',
                                  'FP3','FP5','FP6','FP8','FXC','FXK','MP0','NID','OSP','OSQ','OSR','OS2','OS6','OS7','PC2','PR1','RCR','RCW','RCX','RCZ','RDA','RNP','RO1','RO2',
                                  'RO4','RP1','RRI','RS1','RSS','RVB','RVC','RVD','RZG','RZN','RZP','RZQ','SD1','SD2','SD3','SD5','SNV','S2M','ZZ1','ZZ3','ZZ5','ZZG','   ')
GROUP BY SVC_CAS_EXCL_RSN_CD
;
END
-RUN
SQL
SELECT CLP_CAS_EXCL_RSN_CD
      ,COUNT(*)
FROM   &CLP_CAS.EVAL&CLP_CAS_TBL.EVAL
WHERE  CLP_CAS_EXCL_RSN_CD NOT IN('AA2','AA6','AA8','ABC','AFA','AFB','AJ1','BCA','C16','CB2','CB3','CL0','CL2','CL3','CL5','CL7','CLE','CLF','CLJ','CLL','CLW','CLZ',
                                  'CMS','CSB','CSC','CSD','C0A','DI1','DP1','DP2','EP2','ES1','ES8','F1A','F11','F12','FA1','FAA','FCA','FCB','FI0','FI9','FIB','FIC','FIN','FIS','FIW','FP1',
                                  'FP3','FP5','FP6','FP8','FXC','FXK','MP0','NID','OSP','OSQ','OSR','OS2','OS6','OS7','PC2','PR1','RCR','RCW','RCX','RCZ','RDA','RNP','RO1','RO2',
                                  'RO4','RP1','RRI','RS1','RSS','RVB','RVC','RVD','RZG','RZN','RZP','RZQ','SD1','SD2','SD3','SD5','SNV','S2M','ZZ1','ZZ3','ZZ5','ZZG','   ')
GROUP BY CLP_CAS_EXCL_RSN_CD
;
END
-RUN
SQL
SELECT SVC_TX_ID_MATCH_TYPE
      ,COUNT(*)
FROM   &SVC.EVAL&SVC_TBL.EVAL
WHERE  SVC_TX_ID_MATCH_TYPE NOT IN('   ','AA2','ABC','AFA','CB2','CLF','CL0','CL2','CL3','CL5','CL6','CL7','CLE','CLJ','CLL','CLW','CLZ','CSB','CSD','C0A','DI1','ES1','F11','F12','F1A',
                                   'FCA','FCB','FI9','FIB','FIC','FP1','FP5','FP6','FP8','FXC','MPC','MP1','MP3','MP5','OS2','OSP','OSQ','OSR','ZZ1','ZZ5','ZZG')
GROUP BY
       SVC_TX_ID_MATCH_TYPE
ORDER BY
       SVC_TX_ID_MATCH_TYPE
;
END
-EXIT
-*SQL
-*SELECT *
-*FROM CLARITY_TDL_TRAN
-*WHERE INVOICE_NUMBER = '91966188'
-*  AND DETAIL_TYPE    = 50
-*-*  AND ROWNUM < 11
-*;
-*END
-*-EXIT
-*
-*
-*SQL
-*SELECT *
-*FROM PATIENT
-*WHERE PAT_ID = 'Z4611681'
-*;
-*END
-*-EXIT
SQL
SELECT *
FROM   CLARITY_TDL_TRAN
-*WHERE INVOICE_NUMBER = '3966634'
WHERE INT_PAT_ID = 'Z4611681'
-*  AND ORIG_SERVICE_DATE = '21 MAR 2016'
  AND CPT_CODE = '99283'
-*WHERE TX_ID = 84090244
-*WHERE  INVOICE_NUMBER  = 'P1144854530'
;
END
-EXIT
-*SQL
-*SELECT
-*      RTRIM(CLP_CLM_SUBMTR_ID)
-*     ,SVC_CAS_CLM_ADJ_GRP_CD1
-*     ,SVC_CAS_CLM_ADJ_RSN_CD1
-*     ,SVC_CAS_CLM_ADJ_RSN_CD2
-*     ,SVC_CAS_CLM_ADJ_RSN_CD3
-*FROM   &CLP.EVAL&CLP_TBL.EVAL
-*INNER JOIN
-*      &SVC.EVAL&SVC_TBL.EVAL
-*ON    SVC_ISA_FILE_ID           = CLP_ISA_FILE_ID
-*  AND SVC_GS_GRP_SEQ_NO         = CLP_GS_GRP_SEQ_NO
-*  AND SVC_ST_SEQ_NO             = CLP_ST_SEQ_NO
-*  AND SVC_LX_SEQ_NO             = CLP_LX_SEQ_NO
-*  AND SVC_CLP_CLM_SEQ_NO        = CLP_CLM_SEQ_NO
-*  AND SVC_EXCL_RSN_CD           = '   '
-*  AND TO_NUMBER(COALESCE(RTRIM(SVC_LI_PRVDR_PYMT),'0')) = 0
-*INNER JOIN
-*      &SVC_DTM.EVAL&SVC_DTM_TBL.EVAL
-*ON    SVC_DTM_ISA_FILE_ID       = SVC_ISA_FILE_ID
-*  AND SVC_DTM_GS_GRP_SEQ_NO     = SVC_GS_GRP_SEQ_NO
-*  AND SVC_DTM_ST_SEQ_NO         = SVC_ST_SEQ_NO
-*  AND SVC_DTM_LX_SEQ_NO         = SVC_LX_SEQ_NO
-*  AND SVC_DTM_CLP_CLM_SEQ_NO    = SVC_CLP_CLM_SEQ_NO
-*  AND SVC_DTM_SVC_SEQ_NO        = SVC_SEQ_NO
-*  AND SVC_DTM_DTTM_QLFR         IN( '472','150' )
-*  AND SVC_DTM_EXCL_RSN_CD       = '   '
-*INNER JOIN
-*      &SVC_CAS.EVAL&SVC_CAS_TBL.EVAL
-*ON    SVC_CAS_ISA_FILE_ID       = SVC_ISA_FILE_ID
-*  AND SVC_CAS_GS_GRP_SEQ_NO     = SVC_GS_GRP_SEQ_NO
-*  AND SVC_CAS_ST_SEQ_NO         = SVC_ST_SEQ_NO
-*  AND SVC_CAS_LX_SEQ_NO         = SVC_LX_SEQ_NO
-*  AND SVC_CAS_CLP_CLM_SEQ_NO    = SVC_CLP_CLM_SEQ_NO
-*  AND SVC_CAS_SVC_SEQ_NO        = SVC_SEQ_NO
-*  AND SVC_CAS_EXCL_RSN_CD       = '   '
-*-*  AND RTRIM(SVC_CAS_CLM_ADJ_RSN_CD1) = '2'
-*-*  AND TO_NUMBER(COALESCE(RTRIM(SVC_CAS_CLM_ADJ_AMT1),'0'))
-*-*      = TO_NUMBER(COALESCE(RTRIM(SVC_ORGLI_PRVDR_PYMT),'0'))
-*INNER JOIN
-*      CLARITY_TDL_TRAN
-*ON    INVOICE_NUMBER            = RTRIM(CLP_CLM_SUBMTR_ID)
-*  AND CPT_CODE                  = RTRIM(SVC_PROC1_CD)
-*  AND ORIG_SERVICE_DATE         = TO_DATE(SVC_DTM_DATE, 'YYYYMMDD')
-*  AND CUR_FIN_CLASS             = '2'
-*-*WHERE SUBSTR(CLP_CLM_SUBMTR_ID,11,1) = '0'
-*;
-*END
-*-EXIT
-*SQL
-*SELECT DISTINCT
-*  CONCAT(CONCAT(REF.EXTERNAL_ID_NUM, '-'), DENSE_RANK () OVER (PARTITION BY REF.EXTERNAL_ID_NUM ORDER BY REF.EXTERNAL_ID_NUM,APPT.PROV_ID DESC)) AS REFERRAL_NUMBER
-*                 ,APPROV.CHANGE_DATE
-*                 ,CONTACT_DATE
-*                ,NET.NET_AFFIL_LEVEL_C
-*                ,SER.NPI
-*FROM REFERRAL_HIST APPROV
-*INNER JOIN
-*                REFERRAL REF
-*ON         REF.REFERRAL_ID       = APPROV.REFERRAL_ID
-*   AND    REF.PAYOR_ID          = '1003'
-*   AND    REF.PLAN_ID           = '10030151'
-*INNER JOIN  F_SCHED_APPT  APPT
-*ON         REF.REFERRAL_ID       = APPT.REFERRAL_ID
-*LEFT JOIN CLARITY_SER APPT_SER
-*ON         APPT.PROV_ID          = APPT_SER.PROV_ID
-*LEFT JOIN CLARITY_SER_2 SER
-*ON          REF.REFERRAL_PROV_ID  = SER.PROV_ID
-*LEFT JOIN CLARITY_SER_NETAFF NET
-*ON          REF.PCP_PROV_ID       = NET.PROV_ID
-*-*WHERE APPROV.CHANGE_DATE    = TRUNC(CURRENT_DATE)-1
-*-*WHERE   APPROV.CHANGE_DATE    = '06 FEB 2017'
-*-*  AND     APPROV.CHANGE_TYPE_C  = '2'
-*WHERE     NET.NET_AFFIL_LEVEL_C IN ('1009','1010', '1011', '1012', '1013')
-*  AND     CONTACT_DATE          < '07 FEB 2017'
-*  AND     (SER.NPI IS NULL OR SER.NPI = '')
-*  AND
-*ORDER BY CONCAT(CONCAT(REF.EXTERNAL_ID_NUM, '-'), DENSE_RANK () OVER (PARTITION BY REF.EXTERNAL_ID_NUM ORDER BY REF.EXTERNAL_ID_NUM,APPT.PROV_ID DESC))
-*;
-*END
-*-EXIT
-*SQL
-*SELECT * FROM V$VERSION
-*;
-*END
-*-EXIT
-*SQL
-*SELECT *
-*FROM CLARITY_TDL_TRAN  A
-*INNER JOIN
-*     CLARITY_TDL_TRAN  B
-*ON   B.TX_ID        = A.MATCH_TRX_ID
-*  AND B.DETAIL_TYPE = 2
-*INNER JOIN
-*      REMIT_RUN_SUM R
-*ON REMIT_RUN = 75316
-*WHERE A.TX_ID = 86417607
-*AND  A.DETAIL_TYPE    = 20
-*;
-*END
-*-EXIT
-*3717627
-*
-*
-*SQL
-*SELECT *
-*FROM CLARITY_TDL_TRAN
-*WHERE DETAIL_TYPE = 51
-*  AND TX_ID = (SELECT MAX(TX_ID)
-*               FROM CLARITY_TDL_TRAN
-*               WHERE DETAIL_TYPE = 51 )
-*;
-*END
-*-EXIT
-*-*
-*-*-*
-*SQL
-*SELECT PAT_LAST_NAME
-*      ,PAT_FIRST_NAME
-*      ,ADD_LINE_1
-*      ,CITY
-*      ,A.CPT_CODE
-*      ,A.ORIG_SERVICE_DATE
-*      ,B.AMOUNT
-*      ,A.BILL_CLAIM_AMOUNT
-*      ,B.OUTSTANDING_AMT
-*      ,B.VOID_DATE
-*-*      ,A.*
-*FROM   PATIENT P
-*INNER JOIN
-*      CLARITY_TDL_TRAN A
-*ON    A.INT_PAT_ID           = P.PAT_ID
-*  AND DETAIL_TYPE            = 50
-*  AND ORIG_SERVICE_DATE      = '08 NOV 2016'
-*-*  AND CPT_CODE               IN('99284')
-*-*  AND CPT_CODE               IN('99392','90700','90645','90670','90657')
-*INNER JOIN
-*      ARPB_TRANSACTIONS B
-*ON    B.TX_ID               = A.TX_ID
-*-*  AND B.OUTSTANDING_AMT     <> 0
-*WHERE UPPER(PAT_LAST_NAME)  = 'TWINN'
-*-*  AND SUBSTR(UPPER(PAT_FIRST_NAME),1,6) = 'DAMIAN'
-*ORDER BY 1,2,6,5
-*;
-*END
-*-EXIT
-*
-*SQL
-*SELECT *
-*FROM   INV_CLM_LN_ADDL
-*WHERE INVOICE_NUM  = 'P1142517120'
-*;
-*END
-*-RUN
-*-EXIT
-*-*-*
-*
SQL
SELECT *
FROM   &CLP.EVAL&CLP_TBL.EVAL
INNER JOIN
      &SVC.EVAL&SVC_TBL.EVAL
ON    SVC_ISA_FILE_ID      = CLP_ISA_FILE_ID
  AND SVC_GS_GRP_SEQ_NO    = CLP_GS_GRP_SEQ_NO
  AND SVC_ST_SEQ_NO        = CLP_ST_SEQ_NO
  AND SVC_LX_SEQ_NO        = CLP_LX_SEQ_NO
  AND SVC_CLP_CLM_SEQ_NO   = CLP_CLM_SEQ_NO
  AND SVC_EXCL_RSN_CD      = 'CTC'
-*  AND SVC_TX_ID_MATCH_TYPE = 'WO2'
-*WHERE CLP_EXCL_RSN_CD      = 'CL6'
-*  AND ROWNUM               < 11
;
END
-EXIT
SQL
SELECT *
FROM  &ST.EVAL&ST_TBL.EVAL
INNER JOIN
      &CLP.EVAL&CLP_TBL.EVAL
ON    CLP_ISA_FILE_ID            = ST_ISA_FILE_ID
  AND CLP_GS_GRP_SEQ_NO          = ST_GS_GRP_SEQ_NO
  AND CLP_ST_SEQ_NO              = ST_SEQ_NO
  AND RTRIM(CLP_CLM_SUBMTR_ID)   = 'P1115465801'
-*  AND  CLP_CL_TX_MATCH_TYPE        = 'AAF'
-*  AND CLP_INCL_RSN_CD        = 'VR2'
INNER JOIN
      &SVC.EVAL&SVC_TBL.EVAL
ON    SVC_ISA_FILE_ID            = CLP_ISA_FILE_ID
  AND SVC_GS_GRP_SEQ_NO          = CLP_GS_GRP_SEQ_NO
  AND SVC_ST_SEQ_NO              = CLP_ST_SEQ_NO
  AND SVC_LX_SEQ_NO              = CLP_LX_SEQ_NO
  AND SVC_CLP_CLM_SEQ_NO         = CLP_CLM_SEQ_NO
-*-*-*  AND SVC_EXCL_RSN_CD            = 'DI1'
-*-*-*WHERE CLP_EXCL_RSN_CD            = 'VR1'
-*  AND SVC_EXCL_RSN_CD            = 'AFB'
-*-*-*-*-*  AND SVC_EXCL_RSN_CD          = 'FXQ'
-*INNER JOIN
-*      &SVC_CAS.EVAL&SVC_CAS_TBL.EVAL
-*ON    SVC_CAS_ISA_FILE_ID          = SVC_ISA_FILE_ID
-*  AND SVC_CAS_GS_GRP_SEQ_NO        = SVC_GS_GRP_SEQ_NO
-*  AND SVC_CAS_ST_SEQ_NO            = SVC_ST_SEQ_NO
-*  AND SVC_CAS_LX_SEQ_NO            = SVC_LX_SEQ_NO
-*  AND SVC_CAS_CLP_CLM_SEQ_NO       = SVC_CLP_CLM_SEQ_NO
-*  AND SVC_CAS_SVC_SEQ_NO           = SVC_SEQ_NO
-*  AND SVC_CAS_INCL_RSN_CD          = 'VR2'
-*INNER JOIN
-*      &CLP_CAS.EVAL&CLP_CAS_TBL.EVAL
-*ON    CLP_CAS_ISA_FILE_ID          = CLP_ISA_FILE_ID
-*  AND CLP_CAS_GS_GRP_SEQ_NO        = CLP_GS_GRP_SEQ_NO
-*  AND CLP_CAS_ST_SEQ_NO            = CLP_ST_SEQ_NO
-*  AND CLP_CAS_LX_SEQ_NO            = CLP_LX_SEQ_NO
-*  AND CLP_CAS_CLP_CLM_SEQ_NO       = CLP_CLM_SEQ_NO
-*-*  AND SVC_DTM_SVC_SEQ_NO           = SVC_SEQ_NO
-*-*  AND CLP_CAS_EXCL_RSN_CD          <> '   '
-*-*  AND NOT EXISTS
-*-*    ( SELECT 1
-*-*      FROM &SVC.EVAL&SVC_TBL.EVAL
-*-*      WHERE SVC_ISA_FILE_ID   = CLP_ISA_FILE_ID
-*-*        AND SVC_GS_GRP_SEQ_NO = CLP_GS_GRP_SEQ_NO
-*-*        AND SVC_ST_SEQ_NO     = CLP_ST_SEQ_NO
-*-*        AND SVC_LX_SEQ_NO     = CLP_LX_SEQ_NO
-*-*        AND SVC_CLP_CLM_SEQ_NO= CLP_CLM_SEQ_NO )
-*-*WHERE  RTRIM(SVC_CLARITY_TX_ID) = '0'
-*-*INNER JOIN
-*-*      &SVC_DTM.EVAL&SVC_DTM_TBL.EVAL
-*-*ON    SVC_DTM_ISA_FILE_ID          = SVC_ISA_FILE_ID
-*-*  AND SVC_DTM_GS_GRP_SEQ_NO        = SVC_GS_GRP_SEQ_NO
-*-*  AND SVC_DTM_ST_SEQ_NO            = SVC_ST_SEQ_NO
-*-*  AND SVC_DTM_LX_SEQ_NO            = SVC_LX_SEQ_NO
-*-*  AND SVC_DTM_CLP_CLM_SEQ_NO       = SVC_CLP_CLM_SEQ_NO
-*-*  AND SVC_DTM_SVC_SEQ_NO           = SVC_SEQ_NO
-*-*  AND SVC_DTM_INCL_RSN_CD          = 'CLH'
-*-*-*WHERE ROWNUM < 101
-*-*ORDER BY CLP_ISA_FILE_ID
-*-*        ,CLP_GS_GRP_SEQ_NO
-*-*        ,CLP_ST_SEQ_NO
-*-*        ,CLP_LX_SEQ_NO
-*-*        ,CLP_CLM_SEQ_NO
-*-*        ,CLP_EPP_GEN_SEQ
ORDER BY CLP_CLM_SUBMTR_ID
;
TABLEF FILE SQLOUT
LIST *
END
-EXIT
SQL
SELECT COUNT(*)
FROM &IFCT.EVAL&IFCT_TBL.EVAL
;
END
-EXIT
SQL
SELECT *
FROM   &TRN.EVAL&TRN_TBL.EVAL
INNER JOIN
       &ST.EVAL&ST_TBL.EVAL
ON     ST_ISA_FILE_ID       = TRN_ISA_FILE_ID
  AND  ST_GS_GRP_SEQ_NO     = TRN_GS_GRP_SEQ_NO
  AND  ST_SEQ_NO            = TRN_ST_SEQ_NO
INNER JOIN
       &PLB.EVAL&PLB_TBL.EVAL
ON     ST_ISA_FILE_ID       = PLB_ISA_FILE_ID
  AND  ST_GS_GRP_SEQ_NO     = PLB_GS_GRP_SEQ_NO
  AND  ST_SEQ_NO            = PLB_ST_SEQ_NO
WHERE  RTRIM(TRN_CHECK_NO)  = '890845072'
  AND  ST_EXCL_RSN_CD = '   '
;
END
-EXIT
SQL
SHOW PARAMETER SERVICE_NAMES
-EXIT
SQL
SELECT *
FROM CLARITY_TDL_TRAN
-*WHERE TX_ID = 60866639
WHERE INVOICE_NUMBER = 'P1108031300'
;
END
-EXIT
SQL
SELECT *
FROM  EPP.EPP_REMOVED_PAYMENTS
WHERE RTRIM(ERP_CHECK_NO) = 'EG24997453'
-*WHERE ROWNUM = 1
;
END
-EXIT
SQL
SELECT
-*      T1.TX_ID
      T1.INVOICE_NUMBER
     ,T1.CLM_LN
     ,T1.INVOICE_DATE
     ,T1.ORIG_SERVICE_DATE
     ,T1.CPT_CODE
     ,T1.BILLED_AMT
     ,MAX(E.POST_DATE)    AS LST_PMT_DT
FROM
(
SELECT
      A.TX_ID
     ,A.INVOICE_NUMBER
     ,B.CLM_LN
     ,A.POST_DATE         AS INVOICE_DATE
     ,A.ORIG_SERVICE_DATE
     ,A.CPT_CODE
     ,A.BILL_CLAIM_AMOUNT AS BILLED_AMT
FROM  CLARITY_TDL_TRAN A
INNER JOIN
      CLARITY_TDL_TRAN D
ON    D.TX_ID           = A.TX_ID
  AND D.DETAIL_TYPE     = 1
  AND D.POST_DATE      <> A.POST_DATE
INNER JOIN
      INV_CLM_LN_ADDL  B
ON    B.INVOICE_NUM     = A.INVOICE_NUMBER
JOIN TABLE
      ( XMLSEQUENCE
          ( XMLTYPE
               (   '<e><e>' || REPLACE( B.TRANSACTION_LIST, ',', '</e><e>' ) || '</e></e>' ).EXTRACT ( 'e/e' )
                 )
             )  X
       ON  ( 1=1 )
INNER JOIN
      INVOICE          C
ON    C.INVOICE_ID        = B.INVOICE_ID
WHERE A.POST_DATE BETWEEN '01 AUG 2016'
                      AND '09 AUG 2016'
  AND A.DETAIL_TYPE       = 50
  AND A.BILL_CLAIM_AMOUNT = 0
  AND A.TX_ID             = TRIM( X.COLUMN_VALUE.EXTRACT( 'e/text()' ))
) T1
INNER JOIN
      CLARITY_TDL_TRAN E
ON    E.TX_ID             = T1.TX_ID
  AND E.DETAIL_TYPE       IN(20,21)
GROUP BY
      T1.TX_ID
     ,T1.INVOICE_NUMBER
     ,T1.CLM_LN
     ,T1.INVOICE_DATE
     ,T1.ORIG_SERVICE_DATE
     ,T1.CPT_CODE
     ,T1.BILLED_AMT
ORDER BY 1,2,3
;
TABLEF FILE SQLOUT
LIST *
END
-EXIT
-*SQL
-*SELECT *
-*FROM ARPB_TRANSACTIONS
-*WHERE TX_ID = 60866639
-*;
-*END
-*-EXIT
SQL
SELECT *
FROM CLARITY_EAP
WHERE PROC_CODE = '38589'
;
END
-EXIT
SQL
GRANT SELECT ON EPP.EPP_REMOVED_PAYMENTS TO BVET;
END
-EXIT
-*SQL
-*INSERT INTO &ERP.EVAL&ERP_TBL.EVAL
-*SELECT *
-*-*      ERP_IFCT_FILE_ID
-*-*     ,ERP_CHECK_NO
-*-*     ,ERP_CHECK_DT
-*-*     ,ERP_SEQ_NO
-*-*     ,ERP_CHECK_AMT
-*-*     ,ERP_PAYOR_NAME
-*-*     ,ERP_PAYEE_NAME
-*-*     ,ERP_PAYEE_TAX_ID
-*-*     ,''                    AS ERP_PAYEE_NPI
-*-*     ,ERP_INVOICE_NO
-*-*     ,ERP_SERVICE_DT
-*-*     ,ERP_CPT_CODE
-*-*     ,ERP_CHARGE_AMT
-*-*     ,ERP_PAYMENT_AMT
-*-*     ,''                    AS ERP_PT_FIRST_NAME
-*-*     ,''                    AS ERP_PT_MIDDLE_NAME
-*-*     ,''                    AS ERP_PT_LAST_NAME
-*-*     ,''                    AS ERP_PT_SUBSCRIBER_ID
-*-*     ,ERP_RSN_EXCLD_CD
-*FROM  EPP_STAGE.EPP_REMOVED_PAYMENTS
-*-*WHERE ERP_IFCT_FILE_ID = 11529
-*;
-*END
-*-EXIT
-*SQL
-*SELECT COUNT(*)
-*-*  ERP_CHECK_DT
-*FROM   &ERP.EVAL&ERP_TBL.EVAL
-*-*GROUP BY
-*-*       ERP_CHECK_DT
-*-*ORDER BY 1
-*;
-*END
-*-EXIT
SQL
SELECT *
FROM   EPP.EPP_REMOVED_PAYMENTS
INNER JOIN
       &IFCT.EVAL&IFCT_TBL.EVAL
ON     IFCT_FILE_ID = ERP_IFCT_FILE_ID
  AND IFCT_STS_DT BETWEEN '03 AUG 2016'
                      AND '04 AUG 2016'
;
END
-EXIT
SQL
SELECT *
FROM   &BAS.EVAL&BAS_TBL.EVAL
-*WHERE  BAS_CHG_IND = 'MOD'
ORDER BY 1,2,3
;
TABLEF FILE SQLOUT
PRINT *
ON TABLE HOLD
END
-RUN
TABLEF FILE HOLD
PRINT *
ON TABLE PCHOLD FORMAT EXL2K
END
-EXIT
-DEFAULT &BAS         = 'EPP.';
-DEFAULT &BAS_TBL     = 'EPP_BAL_SCENARIOS';
-SET     &BAS_PK      = '&BAS_TBL.EVAL'|'_PK';
SQL
SELECT *
FROM  &ST.EVAL&ST_TBL.EVAL
INNER JOIN
      &CLP.EVAL&CLP_TBL.EVAL
ON    CLP_ISA_FILE_ID          = ST_ISA_FILE_ID
  AND CLP_GS_GRP_SEQ_NO        = ST_GS_GRP_SEQ_NO
  AND CLP_ST_SEQ_NO            = ST_SEQ_NO
  AND RTRIM(CLP_CLM_SUBMTR_ID) = 'P1110714241'
-*  AND CLP_EXCL_RSN_CD          = '   '
INNER JOIN
      &SVC.EVAL&SVC_TBL.EVAL
ON    SVC_ISA_FILE_ID          = CLP_ISA_FILE_ID
  AND SVC_GS_GRP_SEQ_NO        = CLP_GS_GRP_SEQ_NO
  AND SVC_ST_SEQ_NO            = CLP_ST_SEQ_NO
  AND SVC_LX_SEQ_NO            = CLP_LX_SEQ_NO
  AND SVC_CLP_CLM_SEQ_NO       = CLP_CLM_SEQ_NO
-*  AND SVC_EXCL_RSN_CD          = '   '
INNER JOIN
      &SVC_DTM.EVAL&SVC_DTM_TBL.EVAL
ON    SVC_DTM_ISA_FILE_ID      = SVC_ISA_FILE_ID
  AND SVC_DTM_GS_GRP_SEQ_NO    = SVC_GS_GRP_SEQ_NO
  AND SVC_DTM_ST_SEQ_NO        = SVC_ST_SEQ_NO
  AND SVC_DTM_LX_SEQ_NO        = SVC_LX_SEQ_NO
  AND SVC_DTM_CLP_CLM_SEQ_NO   = SVC_CLP_CLM_SEQ_NO
  AND SVC_DTM_SVC_SEQ_NO       = SVC_SEQ_NO
  AND SVC_DTM_DTTM_QLFR        IN( '472','150' )
-*  AND SVC_DTM_EXCL_RSN_CD      = '   '
-*  AND SVC_INCL_RSN_CD          = 'OS2'
-*WHERE  RTRIM(SVC_CLARITY_TX_ID) = '0'
;
END
-EXIT
SQL
SELECT *
FROM   &CLP.EVAL&CLP_TBL.EVAL
WHERE  CLP_EXCL_RSN_CD = 'CA1'
;
END
-EXIT
SQL
SELECT CLP_CLM_SUBMTR_ID
FROM  &SVC.EVAL&SVC_TBL.EVAL S1
INNER JOIN
      &CLP.EVAL&CLP_TBL.EVAL
ON    S1.SVC_ISA_FILE_ID       = CLP_ISA_FILE_ID
  AND S1.SVC_GS_GRP_SEQ_NO     = CLP_GS_GRP_SEQ_NO
  AND S1.SVC_ST_SEQ_NO         = CLP_ST_SEQ_NO
  AND S1.SVC_LX_SEQ_NO         = CLP_LX_SEQ_NO
  AND S1.SVC_CLP_CLM_SEQ_NO    = CLP_CLM_SEQ_NO
WHERE  RTRIM(SVC_PROC1_CD)     = '97810'
  AND  SVC_INCL_RSN_CD         = 'ORG'
  AND NOT EXISTS
( SELECT 1
  FROM  &SVC.EVAL&SVC_TBL.EVAL S2
  WHERE S2.SVC_ISA_FILE_ID     = S1.SVC_ISA_FILE_ID
    AND S2.SVC_GS_GRP_SEQ_NO   = S1.SVC_GS_GRP_SEQ_NO
    AND S2.SVC_ST_SEQ_NO       = S1.SVC_ST_SEQ_NO
    AND S2.SVC_LX_SEQ_NO       = S1.SVC_LX_SEQ_NO
    AND S2.SVC_CLP_CLM_SEQ_NO  = S1.SVC_CLP_CLM_SEQ_NO
    AND S2.SVC_SEQ_NO          = S1.SVC_SEQ_NO
    AND SVC_EXCL_RSN_CD        = '   ' )
;
END
-EXIT
SQL
SELECT *
FROM CLARITY_TDL_TRAN
WHERE TX_ID = 65839663
;
END
-EXIT
SQL
SELECT *
FROM EPP.EPP_REMOVED_PAYMENTS
WHERE ROWNUM <2
;
END
-EXIT
SQL
SELECT MIN(ERP_CHECK_DT)
      ,MAX(ERP_CHECK_DT)
FROM   EPP.EPP_REMOVED_PAYMENTS
WHERE ROWNUM < 11
;
END
-EXIT
SQL
SELECT
     TX_ID
    ,INVOICE_NUMBER
    ,DETAIL_TYPE
    ,POST_DATE
    ,ORIG_SERVICE_DATE
    ,ACCOUNT_ID
    ,PAT_ID
    ,AMOUNT
    ,PATIENT_AMOUNT
    ,INSURANCE_AMOUNT
FROM CLARITY_TDL_TRAN
WHERE TX_ID = 110760
ORDER BY POST_DATE
        ,TDL_ID
-*WHERE  INVOICE_NUMBER = 'P1073567031'
;
END
-EXIT
SQL
SELECT
      SVC_EXCL_RSN_CD
     ,COUNT(*)
FROM  &SVC.EVAL&SVC_TBL.EVAL
GROUP BY
      SVC_EXCL_RSN_CD
;
END
-EXIT
SQL
SELECT *
FROM   &CLP.EVAL&CLP_TBL.EVAL
WHERE  CLP_INCL_RSN_CD = 'ZZ5'
;
END
-EXIT
SQL
SELECT PAT_NAME
FROM  CLARITY_TDL_TRAN  A
INNER JOIN
      PATIENT P
ON    P.PAT_ID           = A.INT_PAT_ID
WHERE TX_ID = 56125250
;
END
-EXIT
SQL
SELECT PROC_ID
      ,PROC_CODE
      ,PROC_NAME
FROM CLARITY_EAP
-*WHERE ROWNUM < 101
ORDER BY PROC_ID DESC
;
END
-EXIT
SQL
SELECT *
FROM   CLARITY_TDL_TRAN A
INNER JOIN
       ARPB_TRANSACTIONS B
ON  B.TX_ID = A.TX_ID
WHERE  INVOICE_NUMBER = 'P1094784230'
AND ROWNUM < 101
;
END
-EXIT
-*SQL
-*SELECT *
-*FROM &SVC.EVAL&SVC_TBL.EVAL
-*WHERE SVC_INCL_RSN_CD = 'H01'
-*;
-*END
-*-EXIT
SQL
SELECT *
FROM &OTLT.EVAL&OTLT_TBL.EVAL
;
END
-EXIT
-*SQL
-*SELECT *
-*FROM   CLARITY_TDL_TRAN  A
-*INNER JOIN
-*       ARPB_TRANSACTIONS B
-*ON     B.TX_ID = A.TX_ID
-*WHERE  A.INT_PAT_ID        = 'Z4029649'
-*  AND  A.DETAIL_TYPE       = 1
-*  AND  A.ORIG_SERVICE_DATE = '30 SEP 2013'
-*  AND  A.CPT_CODE          = 'J1642'
-*;
-*END
-*-EXIT
SQL
SELECT *
FROM   CLARITY_TDL_TRAN A
INNER JOIN
       PATIENT PT
ON PT.PAT_ID      = A.INT_PAT_ID
WHERE TX_ID       = 12771227
  AND DETAIL_TYPE = 1
;
END
-EXIT
SQL
SELECT *
FROM CLARITY_TDL_TRAN
WHERE  ORIG_SERVICE_DATE =
-*SQL
-*SELECT
-*      CLP_INCL_RSN_CD
-*     ,COUNT(*)
-*FROM  &CLP.EVAL&CLP_TBL.EVAL
-*GROUP BY
-*      CLP_INCL_RSN_CD
-*;
-*END
-*-EXIT
-*-*
-*-*
-*-*
-*-*
-*-*
SQL
SELECT *
FROM  &ST.EVAL&ST_TBL.EVAL
INNER JOIN
      &CLP.EVAL&CLP_TBL.EVAL
ON    CLP_ISA_FILE_ID          = ST_ISA_FILE_ID
  AND CLP_GS_GRP_SEQ_NO        = ST_GS_GRP_SEQ_NO
  AND CLP_ST_SEQ_NO            = ST_SEQ_NO
-*  AND CLP_INCL_RSN_CD          = '   '
INNER JOIN
      &SVC.EVAL&SVC_TBL.EVAL
ON    SVC_ISA_FILE_ID          = CLP_ISA_FILE_ID
  AND SVC_GS_GRP_SEQ_NO        = CLP_GS_GRP_SEQ_NO
  AND SVC_ST_SEQ_NO            = CLP_ST_SEQ_NO
  AND SVC_LX_SEQ_NO            = CLP_LX_SEQ_NO
  AND SVC_CLP_CLM_SEQ_NO       = CLP_CLM_SEQ_NO
-*  AND SVC_EXCL_RSN_CD          = '   '
  AND SVC_EXCL_RSN_CD          = 'FXV'
-*WHERE  RTRIM(SVC_CLARITY_TX_ID) = '0'
;
END
-EXIT
-*SQL
-*SELECT *
-*FROM   INV_BASIC_INFO
-*WHERE INV_ID = 8297931
-*;
-*END
-*-EXIT
SQL
SELECT
-*      SVC_ISA_FILE_ID
-*     ,SVC_GS_GRP_SEQ_NO
-*     ,SVC_ST_SEQ_NO
-*     ,SVC_LX_SEQ_NO
-*     ,SVC_CLP_CLM_SEQ_NO
-*     ,SVC_SEQ_NO
-*     ,SVC_EPP_GEN_SEQ
      NM1_PT_LST_NM
     ,NM1_PT_FST_NM
     ,INITCAP(SUBSTR(RTRIM(NM1_PT_LST_NM), INSTR(RTRIM(NM1_PT_LST_NM), '-')+1, LENGTH(RTRIM(NM1_PT_LST_NM))))
                                                AS NM1_PT_LST_NM
     ,PAT_LAST_NAME
     ,PAT_FIRST_NAME
     ,CLP_CLM_SUBMTR_ID
-*     ,A.INVOICE_NUMBER
     ,SVC_DTM_DATE
-*     ,A.ORIG_SERVICE_DATE
-*-*-*-*     ,PAT_LAST_NAME
-*-*-*-*     ,PAT_FIRST_NAME
-*-*-*-*     ,SVC_SEQ_NO
-*-*-*-*     ,C.FROM_SVC_DATE
     ,RTRIM(SVC_PROC1_CD)
-*     ,A.CPT_CODE
-*     ,PROC_OR_REV_CODE
     ,SVC_ORGLI_PRVDR_PYMT
-*     ,A.ORIG_PRICE
-*     ,A.BILL_CLAIM_AMOUNT
-*     ,C.CHARGE_AMOUNT
     ,SVC_LI_PRVDR_PYMT
-*     ,B.OUTSTANDING_AMT
-*-*-*-*     ,C.INVOICE_NUM
-*     ,C.CLAIM_STATUS_C
-*     ,B.OUTSTANDING_AMT
-*     ,SVC_INCL_RSN_CD
-*     ,SVC_ISA_FILE_ID
-*     ,SVC_GS_GRP_SEQ_NO
-*     ,SVC_ST_SEQ_NO
-*     ,SVC_LX_SEQ_NO
-*     ,SVC_CLP_CLM_SEQ_NO
-*     ,SVC_SEQ_NO
-*     ,SVC_EPP_GEN_SEQ
-*     ,A.INT_PAT_ID
-*     ,A.INVOICE_NUMBER
-*     ,CLAIM_STATUS_C
-*     ,SVC_PROC1_CD
-*     ,PROC_OR_REV_CODE
-*     ,SVC_DTM_DATE
-*     ,SVC_ORGLI_PRVDR_PYMT
-*     ,C.CHARGE_AMOUNT
-*     ,SVC_LI_PRVDR_PYMT
FROM  &ST.EVAL&ST_TBL.EVAL
INNER JOIN
      &CLP.EVAL&CLP_TBL.EVAL
ON    CLP_ISA_FILE_ID            = ST_ISA_FILE_ID
  AND CLP_GS_GRP_SEQ_NO          = ST_GS_GRP_SEQ_NO
  AND CLP_ST_SEQ_NO              = ST_SEQ_NO
  AND CLP_EXCL_RSN_CD            = '   '
INNER JOIN
      &SVC.EVAL&SVC_TBL.EVAL
ON    SVC_ISA_FILE_ID            = CLP_ISA_FILE_ID
  AND SVC_GS_GRP_SEQ_NO          = CLP_GS_GRP_SEQ_NO
  AND SVC_ST_SEQ_NO              = CLP_ST_SEQ_NO
  AND SVC_LX_SEQ_NO              = CLP_LX_SEQ_NO
  AND SVC_CLP_CLM_SEQ_NO         = CLP_CLM_SEQ_NO
  AND RTRIM(SVC_CLARITY_TX_ID)   = '0'
  AND SVC_EXCL_RSN_CD            = '   '
-*  AND TO_NUMBER(COALESCE(RTRIM(SVC_LI_PRVDR_PYMT),'0')) = 0
LEFT OUTER JOIN
      &SVC_DTM.EVAL&SVC_DTM_TBL.EVAL
ON    SVC_DTM_ISA_FILE_ID        = SVC_ISA_FILE_ID
  AND SVC_DTM_GS_GRP_SEQ_NO      = SVC_GS_GRP_SEQ_NO
  AND SVC_DTM_ST_SEQ_NO          = SVC_ST_SEQ_NO
  AND SVC_DTM_LX_SEQ_NO          = SVC_LX_SEQ_NO
  AND SVC_DTM_CLP_CLM_SEQ_NO     = SVC_CLP_CLM_SEQ_NO
  AND SVC_DTM_SVC_SEQ_NO         = SVC_SEQ_NO
  AND SVC_DTM_DTTM_QLFR          IN( '472','150' )
  AND SVC_DTM_EXCL_RSN_CD        = '   '
INNER JOIN
      &NM1.EVAL&NM1_TBL.EVAL
ON    NM1_ISA_FILE_ID            = CLP_ISA_FILE_ID
  AND NM1_GS_GRP_SEQ_NO          = CLP_GS_GRP_SEQ_NO
  AND NM1_ST_SEQ_NO              = CLP_ST_SEQ_NO
  AND NM1_LX_SEQ_NO              = CLP_LX_SEQ_NO
  AND NM1_CLP_CLM_SEQ_NO         = CLP_CLM_SEQ_NO
  AND RTRIM(NM1_ENTITY_ID_CD)    = 'QC'
  AND INITCAP(RTRIM(NM1_PT_LST_NM)) NOT IN('Posting','Image','Partners Medical Gro','Healthcare Ins Co')
  AND NOT
      (    INITCAP(RTRIM(NM1_PT_LST_NM)) = 'Doe'
       AND INITCAP(RTRIM(NM1_PT_FST_NM)) = 'John' )
-*       AND INITCAP(RTRIM(NM1_PT_FST_NM)) = 'Jose'
-*
-*  AND INITCAP(RTRIM(NM1_PT_LST_NM)) = 'Pour'
-*
INNER JOIN
      PATIENT P
-*ON    PAT_LAST_NAME  = INITCAP(RTRIM(NM1_PT_LST_NM))
-*ON    PAT_LAST_NAME  = INITCAP(SUBSTR(RTRIM(NM1_PT_LST_NM), INSTR(RTRIM(NM1_PT_LST_NM), '-')+1, LENGTH(RTRIM(NM1_PT_LST_NM))))
-*ON    PAT_LAST_NAME  = INITCAP(SUBSTR(RTRIM(NM1_PT_LST_NM), 1, INSTR(RTRIM(NM1_PT_LST_NM), ' ')-1))
ON    SUBSTR(PAT_LAST_NAME,1,6)  = 'Avalos'
  AND SUBSTR(PAT_FIRST_NAME,1,1) = 'J'
-* INITCAP(RTRIM(NM1_PT_FST_NM))
-*ON      PAT_LAST_NAME  = RTRIM(NM1_PT_LST_NM)
-*-*-*-*    OR  PAT_LAST_NAME  = RTRIM(NM1_PT_LST_NM)
-*-*-*-*    OR  PAT_LAST_NAME  = INITCAP(SUBSTR(RTRIM(NM1_PT_LST_NM), 1, INSTR(RTRIM(NM1_PT_LST_NM), ' ')-1))
-*-*-*-*    OR  PAT_LAST_NAME  = INITCAP(SUBSTR(RTRIM(NM1_PT_LST_NM), INSTR(RTRIM(NM1_PT_LST_NM), ' ')+1, LENGTH(RTRIM(NM1_PT_LST_NM))))
-*-*-*-*    OR  PAT_LAST_NAME  = INITCAP(SUBSTR(RTRIM(NM1_PT_LST_NM), 1, INSTR(RTRIM(NM1_PT_LST_NM), '-')-1))
-*-*-*-*    OR  PAT_LAST_NAME  = INITCAP(SUBSTR(RTRIM(NM1_PT_LST_NM), INSTR(RTRIM(NM1_PT_LST_NM), '-')+1, LENGTH(RTRIM(NM1_PT_LST_NM))))
-*-*ON PAT_LAST_NAME  = 'Mc'||UPPER(SUBSTR(NM1_PT_LST_NM,3,1))||LOWER(SUBSTR(NM1_PT_LST_NM,4,LENGTH(RTRIM(NM1_PT_LST_NM))-3))
-*-*-*-*  AND   PAT_FIRST_NAME = INITCAP(RTRIM(NM1_PT_FST_NM))
-*-*-*-*    OR  PAT_FIRST_NAME = RTRIM(NM1_PT_FST_NM)
-*  AND  SUBSTR(PAT_FIRST_NAME,1,3)      = SUBSTR(INITCAP(RTRIM(NM1_PT_FST_NM)),1,3)
-*-*-*-*    OR (   LENGTH(RTRIM(NM1_PT_FST_NM)) = 1 )
-*-*-*-*       AND SUBSTR(PAT_FIRST_NAME,1,1)   = SUBSTR(INITCAP(RTRIM(NM1_PT_FST_NM)),1,1))
INNER JOIN
      CLARITY_TDL_TRAN   A
ON    A.INT_PAT_ID          = P.PAT_ID
  AND A.DETAIL_TYPE         = 50
-*  AND A.ORIG_SERVICE_DATE   = TO_DATE(SVC_DTM_DATE,'YYYYMMDD')
  AND A.CPT_CODE            = RTRIM(SVC_PROC1_CD)
-*-*  AND ( (       SUBSTR(SVC_DTM_DATE,5,2)          = TO_CHAR(ORIG_SERVICE_DATE, 'mm')
-*-*            AND SUBSTR(SVC_DTM_DATE,7,2)          = TO_CHAR(ORIG_SERVICE_DATE, 'dd'))
-*-*      OR (      SUBSTR(SVC_DTM_DATE,1,4)          = TO_CHAR(ORIG_SERVICE_DATE, 'yyyy')
-*-*            AND SUBSTR(SVC_DTM_DATE,7,2)          = TO_CHAR(ORIG_SERVICE_DATE, 'dd')
-*-*		    AND NOT (    SUBSTR(SVC_DTM_DATE,5,2) = TO_CHAR(ORIG_SERVICE_DATE, 'mm')
-*-*                     AND SUBSTR(SVC_DTM_DATE,7,2) = TO_CHAR(ORIG_SERVICE_DATE, 'dd')))
-*-*	  OR (      SUBSTR(SVC_DTM_DATE,1,4)          = TO_CHAR(ORIG_SERVICE_DATE, 'yyyy')
-*-*	        AND SUBSTR(SVC_DTM_DATE,5,2)          = TO_CHAR(ORIG_SERVICE_DATE, 'mm')
-*-*            AND NOT (    SUBSTR(SVC_DTM_DATE,5,2) = TO_CHAR(ORIG_SERVICE_DATE, 'mm')
-*-*                     AND SUBSTR(SVC_DTM_DATE,7,2) = TO_CHAR(ORIG_SERVICE_DATE, 'dd'))
-*-*            AND NOT (    SUBSTR(SVC_DTM_DATE,1,4) = TO_CHAR(ORIG_SERVICE_DATE, 'yy')
-*-*                     AND SUBSTR(SVC_DTM_DATE,7,2) = TO_CHAR(ORIG_SERVICE_DATE, 'dd'))))
-*INNER JOIN
-*      ARPB_TRANSACTIONS  B
-*ON    B.TX_ID = A.TX_ID
-*  AND B.VOID_DATE IS NULL
-*
-*-*  AND TO_NUMBER(COALESCE(RTRIM(SVC_LI_PRVDR_PYMT),'0')) <> 0
-*  AND (  A.ORIG_PRICE          = ABS(TO_NUMBER(COALESCE(RTRIM(SVC_ORGLI_PRVDR_PYMT),'0')))
-*      OR A.CPT_CODE            = RTRIM(SVC_PROC1_CD)
-*      OR ( B.OUTSTANDING_AMT     = TO_NUMBER(COALESCE(RTRIM(SVC_LI_PRVDR_PYMT),'0'))
-*           AND TO_NUMBER(COALESCE(RTRIM(SVC_LI_PRVDR_PYMT),'0')) <> 0)
-*      OR A.BILL_CLAIM_AMOUNT   = TO_NUMBER(COALESCE(RTRIM(SVC_ORGLI_PRVDR_PYMT),'0')))
-*  AND B.OUTSTANDING_AMT  > 0
-*  AND B.OUTSTANDING_AMT    = TO_NUMBER(COALESCE(RTRIM(SVC_LI_PRVDR_PYMT),'0'))
-*INNER JOIN
-*      INV_CLM_LN_ADDL    C
-*ON    C.INVOICE_NUM           = A.INVOICE_NUMBER
-*  AND C.CHARGE_AMOUNT         = ABS(TO_NUMBER(COALESCE(RTRIM(SVC_ORGLI_PRVDR_PYMT),'0')))
-*  AND ( C.PROC_OR_REV_CODE    = RTRIM(SVC_PROC1_CD)
-*      OR RTRIM(SVC_PROC1_CD)  = 'ZZE01' )
-*  AND C.FROM_SVC_DATE         = TO_DATE(SVC_DTM_DATE,'YYYYMMDD')
-*-*  AND C.CHARGE_AMOUNT        >= ABS(TO_NUMBER(COALESCE(RTRIM(SVC_ORGLI_PRVDR_PYMT),'0')))
-*-*-*  AND NOT EXISTS
-*-*   ( SELECT 1
-*-*     FROM   INV_CLM_LN_ADDL    Z
-*-*     WHERE  Z.INVOICE_NUM      = C.INVOICE_NUM
-*-*       AND  Z.FROM_SVC_DATE    = C.FROM_SVC_DATE
-*-*       AND  Z.CHARGE_AMOUNT   <> C.CHARGE_AMOUNT )
-*  AND ((  C.CLAIM_STATUS_C     = 1 )
-*    OR (  C.CLAIM_STATUS_C    <> 1
-*          AND NOT EXISTS
-*           ( SELECT 1
-*             FROM   CLARITY_TDL_TRAN   X
-*                   ,INV_CLM_LN_ADDL    Y
-*             WHERE  X.INT_PAT_ID        = P.PAT_ID
-*               AND  X.DETAIL_TYPE       = 50
-*               AND  X.ORIG_SERVICE_DATE = TO_DATE(SVC_DTM_DATE,'YYYYMMDD')
-*               AND  Y.INVOICE_NUM       = X.INVOICE_NUMBER
-*               AND  Y.PROC_OR_REV_CODE  = C.PROC_OR_REV_CODE
-*               AND  Y.CHARGE_AMOUNT     = C.CHARGE_AMOUNT
-*               AND  Y.CLAIM_STATUS_C    = 1 )))
WHERE ST_EXCL_RSN_CD = '   '
-*ORDER BY 1,2,3,4,5,6,7,8,9,10,11,12
ORDER BY 1,2,3,4
;
TABLEF FILE SQLOUT
LIST *
END
-EXIT
SQL
SELECT
      DIC_INVOICE_NO
     ,SUBSTR(DIC_CHECK_NO,1,LENGTH(DIC_CHECK_NO)-2)  AS DIC_CHECK_NO
     ,DIC_CHECK_DATE
     ,DIC_PAYER_ID_CD
     ,DIC_ORG_CHK_NO
     ,DIC_UPDT_DT
     ,DIC_CHK_AMT
     ,DIC_PAYER_NAME
     ,DIC_FILE_NAME
FROM   &ISA.EVAL&ISA_TBL.EVAL
INNER JOIN
       &IFCT.EVAL&IFCT_TBL.EVAL
ON     IFCT_FILE_ID  = ISA_FILE_ID
   AND RTRIM(IFCT_FILE_PAYER) = 'BOAMIXED'
INNER JOIN
       &DIC.EVAL&DIC_TBL.EVAL
ON     DIC_FILE_NAME                     = RTRIM(IFCT_FILE_NAME)
  AND UPPER(SUBSTR(DIC_PAYER_NAME,1,19)) = 'HEALTHCARE PARTNERS'
  AND DIC_UPDT_DT                        BETWEEN '01 AUG 2015'
                                             AND '23 OCT 2015'
  AND NVL(RTRIM(SUBSTR(DIC_CHECK_NO,LENGTH(DIC_CHECK_NO)-1,1),'01234567890'), 'TRUE') <> 'TRUE'
  AND NOT EXISTS
    ( SELECT 1
      FROM   &DIC.EVAL&DIC_TBL.EVAL D2
      WHERE  D2.DIC_INVOICE_NO = D1.DIC_INVOICE_NO
        AND  D2.DIC_CHECK_NO   = SUBSTR(D1.DIC_CHECK_NO,1,LENGTH(D1.DIC_CHECK_NO)-2))
ORDER BY 1,2
;
TABLEF FILE SQLOUT
LIST *
END
-EXIT
SQL
INSERT INTO &DIC.EVAL&DIC_TBL.EVAL
SELECT
      DIC_INVOICE_NO
     ,SUBSTR(DIC_CHECK_NO,1,LENGTH(DIC_CHECK_NO)-2)  AS DIC_CHECK_NO
     ,DIC_CHECK_DATE
     ,DIC_PAYER_ID_CD
     ,DIC_ORG_CHK_NO
     ,DIC_UPDT_DT
     ,DIC_CHK_AMT
     ,DIC_PAYER_NAME
     ,DIC_FILE_NAME
FROM  &DIC.EVAL&DIC_TBL.EVAL   D1
INNER JOIN
      &IFCT.EVAL&IFCT_TBL.EVAL
ON    DIC_FILE_NAME                      = RTRIM(IFCT_FILE_NAME)
  AND RTRIM(IFCT_FILE_PAYER)             = 'BOAMIXED'
WHERE UPPER(SUBSTR(DIC_PAYER_NAME,1,19)) = 'HEALTHCARE PARTNERS'
  AND DIC_UPDT_DT BETWEEN '01 AUG 2015' AND '23 OCT 2015'
  AND NVL(RTRIM(SUBSTR(DIC_CHECK_NO,LENGTH(DIC_CHECK_NO)-1,1),'01234567890'), 'TRUE') <> 'TRUE'
  AND NOT EXISTS
    ( SELECT 1
      FROM   &DIC.EVAL&DIC_TBL.EVAL D2
      WHERE  D2.DIC_INVOICE_NO = D1.DIC_INVOICE_NO
        AND  D2.DIC_CHECK_NO   = SUBSTR(D1.DIC_CHECK_NO,1,LENGTH(D1.DIC_CHECK_NO)-2))
ORDER BY
      DIC_ORG_CHK_NO
;
TABLEF FILE SQLOUT
LIST *
-*ON TABLE HOLD
END
-RUN
-TYPE &RECORDS.EVAL
-EXIT
select nvl (rtrim ('156', '0123456789'), 'True') num from dual
DIC_CHECK_NO
SQL
SELECT *
FROM  &ST.EVAL&ST_TBL.EVAL
INNER JOIN
      &CLP.EVAL&CLP_TBL.EVAL
ON    CLP_ISA_FILE_ID             = ST_ISA_FILE_ID
  AND CLP_GS_GRP_SEQ_NO           = ST_GS_GRP_SEQ_NO
  AND CLP_ST_SEQ_NO               = ST_SEQ_NO
  AND CLP_EXCL_RSN_CD             = '   '
INNER JOIN
      &SVC.EVAL&SVC_TBL.EVAL
ON    SVC_ISA_FILE_ID          = CLP_ISA_FILE_ID
  AND SVC_GS_GRP_SEQ_NO        = CLP_GS_GRP_SEQ_NO
  AND SVC_ST_SEQ_NO            = CLP_ST_SEQ_NO
  AND SVC_LX_SEQ_NO            = CLP_LX_SEQ_NO
  AND SVC_CLP_CLM_SEQ_NO       = CLP_CLM_SEQ_NO
  AND SVC_EXCL_RSN_CD          = '   '
WHERE  RTRIM(SVC_CLARITY_TX_ID) = '0'
;
END
-EXIT
-*HERRERA-SUAREZ
SQL
SELECT *
FROM  PATIENT P
-*WHERE PAT_LAST_NAME  = 'Sauceda'
WHERE UPPER(PAT_LAST_NAME)  = 'SUAREZ'
  AND UPPER(SUBSTR(PAT_FIRST_NAME,1,1)) = 'Z'
-*ON    PAT_LAST_NAME  = INITCAP(RTRIM(NM1_PT_LST_NM))
-*  AND PAT_FIRST_NAME = INITCAP(RTRIM(NM1_PT_FST_NM))
ORDER BY 2
;
END
-EXIT
SQL
SELECT *
FROM   CLARITY_EPM
ORDER BY 2
;
END
-EXIT
-*SQL
-*SELECT *
-*FROM  &ST.EVAL&ST_TBL.EVAL
-*INNER JOIN
-*      &CLP.EVAL&CLP_TBL.EVAL
-*ON    CLP_ISA_FILE_ID          = ST_ISA_FILE_ID
-*  AND CLP_GS_GRP_SEQ_NO        = ST_GS_GRP_SEQ_NO
-*  AND CLP_ST_SEQ_NO            = ST_SEQ_NO
-*  AND CLP_EXCL_RSN_CD          = '   '
-*  AND SUBSTR(CLP_CLM_SUBMTR_ID,1,1) = 'P'
-*
-*  AND RTRIM(CLP_CLM_SUBMTR_ID) = 'P1083015580'
-*
-*INNER JOIN
-*      &SVC.EVAL&SVC_TBL.EVAL
-*ON    SVC_ISA_FILE_ID           = CLP_ISA_FILE_ID
-*  AND SVC_GS_GRP_SEQ_NO         = CLP_GS_GRP_SEQ_NO
-*  AND SVC_ST_SEQ_NO             = CLP_ST_SEQ_NO
-*  AND SVC_LX_SEQ_NO             = CLP_LX_SEQ_NO
-*  AND SVC_CLP_CLM_SEQ_NO        = CLP_CLM_SEQ_NO
-*  AND SVC_EXCL_RSN_CD           = '   '
-*INNER JOIN
-*      &SVC_DTM.EVAL&SVC_DTM_TBL.EVAL
-*ON    SVC_DTM_ISA_FILE_ID       = SVC_ISA_FILE_ID
-*  AND SVC_DTM_GS_GRP_SEQ_NO     = SVC_GS_GRP_SEQ_NO
-*  AND SVC_DTM_ST_SEQ_NO         = SVC_ST_SEQ_NO
-*  AND SVC_DTM_LX_SEQ_NO         = SVC_LX_SEQ_NO
-*  AND SVC_DTM_CLP_CLM_SEQ_NO    = SVC_CLP_CLM_SEQ_NO
-*  AND SVC_DTM_SVC_SEQ_NO        = SVC_SEQ_NO
-*  AND SVC_DTM_DTTM_QLFR         IN( '472','150' )
-*  AND SVC_DTM_EXCL_RSN_CD       = '   '
-*;
-*END
-*-EXIT
-*
-*
-*SQL
-*DELETE FROM &IFCT.EVAL&IFCT_TBL.EVAL
-*WHERE RTRIM(IFCT_FILE_NAME) = '20151016_BOA_POST_EDC_EPIC_Q03_A_EPP.835'
-*;
-*END
-*-EXIT
SQL
SELECT
      SVC_ISA_FILE_ID
     ,SVC_GS_GRP_SEQ_NO
     ,SVC_ST_SEQ_NO
     ,SVC_LX_SEQ_NO
     ,SVC_CLP_CLM_SEQ_NO
     ,SVC_SEQ_NO
     ,SVC_EPP_GEN_SEQ
FROM  &ST.EVAL&ST_TBL.EVAL
INNER JOIN
      &CLP.EVAL&CLP_TBL.EVAL C1
ON    C1.CLP_ISA_FILE_ID          = ST_ISA_FILE_ID
  AND C1.CLP_GS_GRP_SEQ_NO        = ST_GS_GRP_SEQ_NO
  AND C1.CLP_ST_SEQ_NO            = ST_SEQ_NO
  AND RTRIM(C1.CLP_CLM_STATUS_CD) = '1'
  AND C1.CLP_EXCL_RSN_CD          = '   '
INNER JOIN
      &SVC.EVAL&SVC_TBL.EVAL S1
ON    S1.SVC_ISA_FILE_ID          = C1.CLP_ISA_FILE_ID
  AND S1.SVC_GS_GRP_SEQ_NO        = C1.CLP_GS_GRP_SEQ_NO
  AND S1.SVC_ST_SEQ_NO            = C1.CLP_ST_SEQ_NO
  AND S1.SVC_LX_SEQ_NO            = C1.CLP_LX_SEQ_NO
  AND S1.SVC_CLP_CLM_SEQ_NO       = C1.CLP_CLM_SEQ_NO
  AND S1.SVC_EXCL_RSN_CD          = '   '
  AND TO_NUMBER(COALESCE(RTRIM(S1.SVC_LI_PRVDR_PYMT),'0')) = 0
  AND 1 = ( SELECT COUNT(*)
            FROM   CLARITY_TDL_TRAN
            WHERE  INVOICE_NUMBER = RTRIM(CLP_CLM_SUBMTR_ID)
              AND  CPT_CODE       = RTRIM(SVC_PROC1_CD ))
INNER JOIN
      &SVC.EVAL&SVC_TBL.EVAL S2
ON    S2.SVC_ISA_FILE_ID          = C1.CLP_ISA_FILE_ID
  AND S2.SVC_GS_GRP_SEQ_NO        = C1.CLP_GS_GRP_SEQ_NO
  AND S2.SVC_ST_SEQ_NO            = C1.CLP_ST_SEQ_NO
  AND S2.SVC_LX_SEQ_NO            = C1.CLP_LX_SEQ_NO
  AND S2.SVC_CLP_CLM_SEQ_NO       = C1.CLP_CLM_SEQ_NO
  AND S2.SVC_SEQ_NO              <> S1.SVC_SEQ_NO
  AND S2.SVC_EXCL_RSN_CD          = '   '
  AND RTRIM(S2.SVC_CLARITY_TX_ID)<> '0'
  AND S2.SVC_CLARITY_TX_ID        = S1.SVC_CLARITY_TX_ID
WHERE ST_EXCL_RSN_CD              = '   '
;
END
-EXIT
-*SQL
-*SELECT *
-*FROM   &SVC.EVAL&SVC_TBL.EVAL
-*WHERE SVC_INCL_RSN_CD = 'FXC'
-*;
-*END
-*-EXIT
-*
-*
-*
-*SQL
-*SELECT *
-*FROM   &IFCT.EVAL&IFCT_TBL.EVAL
-*WHERE  RTRIM(IFCT_FILE_NAME) = '20151007_BOA_POST_BLUESHIELD_ERA_EPIC_A.835'
-*;
-*END
-*-EXIT
-*SQL
-*SELECT *
-*FROM   &SVC.EVAL&SVC_TBL.EVAL
-*WHERE  SVC_INCL_RSN_CD = 'FIE'
-*;
-*END
-*-EXIT
SQL
SELECT DISTINCT
      SVC_ISA_FILE_ID
     ,SVC_GS_GRP_SEQ_NO
     ,SVC_ST_SEQ_NO
     ,SVC_LX_SEQ_NO
     ,SVC_CLP_CLM_SEQ_NO
     ,SVC_SEQ_NO
     ,SVC_EPP_GEN_SEQ
     ,NM1_PT_LST_NM
     ,NM1_PT_FST_NM
     ,PAT_LAST_NAME
     ,PAT_FIRST_NAME
     ,SVC_DTM_DATE
     ,A.ORIG_SERVICE_DATE
     ,CLP_CLM_SUBMTR_ID
     ,A.INVOICE_NUMBER
-*-*-*-*     ,PAT_LAST_NAME
-*-*-*-*     ,PAT_FIRST_NAME
-*-*-*-*     ,SVC_SEQ_NO
-*-*-*-*     ,C.FROM_SVC_DATE
     ,RTRIM(SVC_PROC1_CD)
     ,A.CPT_CODE
-*     ,PROC_OR_REV_CODE
     ,SVC_ORGLI_PRVDR_PYMT
     ,A.ORIG_PRICE
     ,A.BILL_CLAIM_AMOUNT
-*     ,C.CHARGE_AMOUNT
     ,SVC_LI_PRVDR_PYMT
     ,B.OUTSTANDING_AMT
-*-*-*-*     ,C.INVOICE_NUM
-*     ,C.CLAIM_STATUS_C
-*     ,B.OUTSTANDING_AMT
-*     ,SVC_INCL_RSN_CD
-*     ,SVC_ISA_FILE_ID
-*     ,SVC_GS_GRP_SEQ_NO
-*     ,SVC_ST_SEQ_NO
-*     ,SVC_LX_SEQ_NO
-*     ,SVC_CLP_CLM_SEQ_NO
-*     ,SVC_SEQ_NO
-*     ,SVC_EPP_GEN_SEQ
-*     ,A.INT_PAT_ID
-*     ,A.INVOICE_NUMBER
-*     ,CLAIM_STATUS_C
-*     ,SVC_PROC1_CD
-*     ,PROC_OR_REV_CODE
-*     ,SVC_DTM_DATE
-*     ,SVC_ORGLI_PRVDR_PYMT
-*     ,C.CHARGE_AMOUNT
-*     ,SVC_LI_PRVDR_PYMT
FROM  &ST.EVAL&ST_TBL.EVAL
INNER JOIN
      &CLP.EVAL&CLP_TBL.EVAL
ON    CLP_ISA_FILE_ID            = ST_ISA_FILE_ID
  AND CLP_GS_GRP_SEQ_NO          = ST_GS_GRP_SEQ_NO
  AND CLP_ST_SEQ_NO              = ST_SEQ_NO
  AND CLP_EXCL_RSN_CD            = '   '
INNER JOIN
      &SVC.EVAL&SVC_TBL.EVAL
ON    SVC_ISA_FILE_ID            = CLP_ISA_FILE_ID
  AND SVC_GS_GRP_SEQ_NO          = CLP_GS_GRP_SEQ_NO
  AND SVC_ST_SEQ_NO              = CLP_ST_SEQ_NO
  AND SVC_LX_SEQ_NO              = CLP_LX_SEQ_NO
  AND SVC_CLP_CLM_SEQ_NO         = CLP_CLM_SEQ_NO
  AND RTRIM(SVC_CLARITY_TX_ID)   = '0'
  AND SVC_EXCL_RSN_CD            = '   '
-*  AND TO_NUMBER(COALESCE(RTRIM(SVC_LI_PRVDR_PYMT),'0')) = 0
LEFT OUTER JOIN
      &SVC_DTM.EVAL&SVC_DTM_TBL.EVAL
ON    SVC_DTM_ISA_FILE_ID        = SVC_ISA_FILE_ID
  AND SVC_DTM_GS_GRP_SEQ_NO      = SVC_GS_GRP_SEQ_NO
  AND SVC_DTM_ST_SEQ_NO          = SVC_ST_SEQ_NO
  AND SVC_DTM_LX_SEQ_NO          = SVC_LX_SEQ_NO
  AND SVC_DTM_CLP_CLM_SEQ_NO     = SVC_CLP_CLM_SEQ_NO
  AND SVC_DTM_SVC_SEQ_NO         = SVC_SEQ_NO
  AND SVC_DTM_DTTM_QLFR          IN( '472','150' )
  AND SVC_DTM_EXCL_RSN_CD        = '   '
INNER JOIN
      &NM1.EVAL&NM1_TBL.EVAL
ON    NM1_ISA_FILE_ID            = CLP_ISA_FILE_ID
  AND NM1_GS_GRP_SEQ_NO          = CLP_GS_GRP_SEQ_NO
  AND NM1_ST_SEQ_NO              = CLP_ST_SEQ_NO
  AND NM1_LX_SEQ_NO              = CLP_LX_SEQ_NO
  AND NM1_CLP_CLM_SEQ_NO         = CLP_CLM_SEQ_NO
  AND RTRIM(NM1_ENTITY_ID_CD)    = 'QC'
  AND INITCAP(RTRIM(NM1_PT_LST_NM)) NOT IN('Posting','Image','Partners Medical Gro','Healthcare Ins Co')
-*
-*  AND INITCAP(RTRIM(NM1_PT_LST_NM)) = 'Pour'
-*
INNER JOIN
      PATIENT P
ON      PAT_LAST_NAME  = INITCAP(RTRIM(NM1_PT_LST_NM))
-*-*-*-*    OR  PAT_LAST_NAME  = RTRIM(NM1_PT_LST_NM)
-*-*-*-*    OR  PAT_LAST_NAME  = INITCAP(SUBSTR(RTRIM(NM1_PT_LST_NM), 1, INSTR(RTRIM(NM1_PT_LST_NM), ' ')-1))
-*-*-*-*    OR  PAT_LAST_NAME  = INITCAP(SUBSTR(RTRIM(NM1_PT_LST_NM), INSTR(RTRIM(NM1_PT_LST_NM), ' ')+1, LENGTH(RTRIM(NM1_PT_LST_NM))))
-*-*-*-*    OR  PAT_LAST_NAME  = INITCAP(SUBSTR(RTRIM(NM1_PT_LST_NM), 1, INSTR(RTRIM(NM1_PT_LST_NM), '-')-1))
-*-*-*-*    OR  PAT_LAST_NAME  = INITCAP(SUBSTR(RTRIM(NM1_PT_LST_NM), INSTR(RTRIM(NM1_PT_LST_NM), '-')+1, LENGTH(RTRIM(NM1_PT_LST_NM))))
-*-*ON PAT_LAST_NAME  = 'Mc'||UPPER(SUBSTR(NM1_PT_LST_NM,3,1))||LOWER(SUBSTR(NM1_PT_LST_NM,4,LENGTH(RTRIM(NM1_PT_LST_NM))-3))
-*-*-*-*  AND   PAT_FIRST_NAME = INITCAP(RTRIM(NM1_PT_FST_NM))
-*-*-*-*    OR  PAT_FIRST_NAME = RTRIM(NM1_PT_FST_NM)
  AND  SUBSTR(PAT_FIRST_NAME,1,3)      = SUBSTR(INITCAP(RTRIM(NM1_PT_FST_NM)),1,3)
-*-*-*-*    OR (   LENGTH(RTRIM(NM1_PT_FST_NM)) = 1 )
-*-*-*-*       AND SUBSTR(PAT_FIRST_NAME,1,1)   = SUBSTR(INITCAP(RTRIM(NM1_PT_FST_NM)),1,1))
INNER JOIN
      CLARITY_TDL_TRAN   A
ON    A.INT_PAT_ID             = P.PAT_ID
  AND A.DETAIL_TYPE            = 50
-*-*  AND ( (       SUBSTR(SVC_DTM_DATE,5,2)          = TO_CHAR(ORIG_SERVICE_DATE, 'mm')
-*-*            AND SUBSTR(SVC_DTM_DATE,7,2)          = TO_CHAR(ORIG_SERVICE_DATE, 'dd'))
-*-*      OR (      SUBSTR(SVC_DTM_DATE,1,4)          = TO_CHAR(ORIG_SERVICE_DATE, 'yyyy')
-*-*            AND SUBSTR(SVC_DTM_DATE,7,2)          = TO_CHAR(ORIG_SERVICE_DATE, 'dd')
-*-*		    AND NOT (    SUBSTR(SVC_DTM_DATE,5,2) = TO_CHAR(ORIG_SERVICE_DATE, 'mm')
-*-*                     AND SUBSTR(SVC_DTM_DATE,7,2) = TO_CHAR(ORIG_SERVICE_DATE, 'dd')))
-*-*	  OR (      SUBSTR(SVC_DTM_DATE,1,4)          = TO_CHAR(ORIG_SERVICE_DATE, 'yyyy')
-*-*	        AND SUBSTR(SVC_DTM_DATE,5,2)          = TO_CHAR(ORIG_SERVICE_DATE, 'mm')
-*-*            AND NOT (    SUBSTR(SVC_DTM_DATE,5,2) = TO_CHAR(ORIG_SERVICE_DATE, 'mm')
-*-*                     AND SUBSTR(SVC_DTM_DATE,7,2) = TO_CHAR(ORIG_SERVICE_DATE, 'dd'))
-*-*            AND NOT (    SUBSTR(SVC_DTM_DATE,1,4) = TO_CHAR(ORIG_SERVICE_DATE, 'yy')
-*-*                     AND SUBSTR(SVC_DTM_DATE,7,2) = TO_CHAR(ORIG_SERVICE_DATE, 'dd'))))
INNER JOIN
      ARPB_TRANSACTIONS  B
ON    B.TX_ID = A.TX_ID
  AND B.VOID_DATE IS NULL
  AND A.ORIG_SERVICE_DATE   = TO_DATE(SVC_DTM_DATE,'YYYYMMDD')
-*  AND TO_NUMBER(COALESCE(RTRIM(SVC_LI_PRVDR_PYMT),'0')) <> 0
  AND (  A.ORIG_PRICE          = ABS(TO_NUMBER(COALESCE(RTRIM(SVC_ORGLI_PRVDR_PYMT),'0')))
      OR A.CPT_CODE            = RTRIM(SVC_PROC1_CD)
      OR ( B.OUTSTANDING_AMT     = TO_NUMBER(COALESCE(RTRIM(SVC_LI_PRVDR_PYMT),'0'))
           AND TO_NUMBER(COALESCE(RTRIM(SVC_LI_PRVDR_PYMT),'0')) <> 0)
      OR A.BILL_CLAIM_AMOUNT   = TO_NUMBER(COALESCE(RTRIM(SVC_ORGLI_PRVDR_PYMT),'0')))
-*  AND B.OUTSTANDING_AMT  > 0
-*  AND B.OUTSTANDING_AMT    = TO_NUMBER(COALESCE(RTRIM(SVC_LI_PRVDR_PYMT),'0'))
-*INNER JOIN
-*      INV_CLM_LN_ADDL    C
-*ON    C.INVOICE_NUM           = A.INVOICE_NUMBER
-*  AND C.CHARGE_AMOUNT         = ABS(TO_NUMBER(COALESCE(RTRIM(SVC_ORGLI_PRVDR_PYMT),'0')))
-*  AND ( C.PROC_OR_REV_CODE    = RTRIM(SVC_PROC1_CD)
-*      OR RTRIM(SVC_PROC1_CD)  = 'ZZE01' )
-*  AND C.FROM_SVC_DATE         = TO_DATE(SVC_DTM_DATE,'YYYYMMDD')
-*-*  AND C.CHARGE_AMOUNT        >= ABS(TO_NUMBER(COALESCE(RTRIM(SVC_ORGLI_PRVDR_PYMT),'0')))
-*-*-*  AND NOT EXISTS
-*-*   ( SELECT 1
-*-*     FROM   INV_CLM_LN_ADDL    Z
-*-*     WHERE  Z.INVOICE_NUM      = C.INVOICE_NUM
-*-*       AND  Z.FROM_SVC_DATE    = C.FROM_SVC_DATE
-*-*       AND  Z.CHARGE_AMOUNT   <> C.CHARGE_AMOUNT )
-*  AND ((  C.CLAIM_STATUS_C     = 1 )
-*    OR (  C.CLAIM_STATUS_C    <> 1
-*          AND NOT EXISTS
-*           ( SELECT 1
-*             FROM   CLARITY_TDL_TRAN   X
-*                   ,INV_CLM_LN_ADDL    Y
-*             WHERE  X.INT_PAT_ID        = P.PAT_ID
-*               AND  X.DETAIL_TYPE       = 50
-*               AND  X.ORIG_SERVICE_DATE = TO_DATE(SVC_DTM_DATE,'YYYYMMDD')
-*               AND  Y.INVOICE_NUM       = X.INVOICE_NUMBER
-*               AND  Y.PROC_OR_REV_CODE  = C.PROC_OR_REV_CODE
-*               AND  Y.CHARGE_AMOUNT     = C.CHARGE_AMOUNT
-*               AND  Y.CLAIM_STATUS_C    = 1 )))
WHERE ST_EXCL_RSN_CD = '   '
-*ORDER BY 1,2,3,4,5,6,7,8,9,10,11,12
ORDER BY 1,2,3,4
;
TABLEF FILE SQLOUT
LIST *
END
-EXIT
-*SQL
-*SELECT *
-*FROM   CLARITY_TDL_TRAN
-*WHERE  INVOICE_NUMBER = '3317840'
-*;
-*END
-*-EXIT
-*
-*
-*
SQL
SELECT DISTINCT
-*      SVC_ISA_FILE_ID
-*     ,SVC_GS_GRP_SEQ_NO
-*     ,SVC_ST_SEQ_NO
-*     ,SVC_LX_SEQ_NO
-*     ,SVC_CLP_CLM_SEQ_NO
-*     ,SVC_SEQ_NO
-*     ,SVC_EPP_GEN_SEQ
      NM1_PT_LST_NM
     ,NM1_PT_FST_NM
     ,PAT_LAST_NAME
     ,PAT_FIRST_NAME
     ,SVC_DTM_DATE
     ,A.ORIG_SERVICE_DATE
     ,CLP_CLM_SUBMTR_ID
-*     ,A.INVOICE_NUMBER
-*-*-*-*     ,PAT_LAST_NAME
-*-*-*-*     ,PAT_FIRST_NAME
-*-*-*-*     ,SVC_SEQ_NO
-*-*-*-*     ,C.FROM_SVC_DATE
     ,RTRIM(SVC_PROC1_CD)
     ,A.CPT_CODE
-*     ,PROC_OR_REV_CODE
     ,SVC_ORGLI_PRVDR_PYMT
     ,A.ORIG_PRICE
-*     ,C.CHARGE_AMOUNT
     ,SVC_LI_PRVDR_PYMT
     ,B.OUTSTANDING_AMT
-*-*-*-*     ,C.INVOICE_NUM
-*     ,C.CLAIM_STATUS_C
-*     ,B.OUTSTANDING_AMT
-*     ,SVC_INCL_RSN_CD
-*     ,SVC_ISA_FILE_ID
-*     ,SVC_GS_GRP_SEQ_NO
-*     ,SVC_ST_SEQ_NO
-*     ,SVC_LX_SEQ_NO
-*     ,SVC_CLP_CLM_SEQ_NO
-*     ,SVC_SEQ_NO
-*     ,SVC_EPP_GEN_SEQ
-*     ,A.INT_PAT_ID
-*     ,A.INVOICE_NUMBER
-*     ,CLAIM_STATUS_C
-*     ,SVC_PROC1_CD
-*     ,PROC_OR_REV_CODE
-*     ,SVC_DTM_DATE
-*     ,SVC_ORGLI_PRVDR_PYMT
-*     ,C.CHARGE_AMOUNT
-*     ,SVC_LI_PRVDR_PYMT
FROM  &ST.EVAL&ST_TBL.EVAL
INNER JOIN
      &CLP.EVAL&CLP_TBL.EVAL
ON    CLP_ISA_FILE_ID            = ST_ISA_FILE_ID
  AND CLP_GS_GRP_SEQ_NO          = ST_GS_GRP_SEQ_NO
  AND CLP_ST_SEQ_NO              = ST_SEQ_NO
  AND CLP_EXCL_RSN_CD            = '   '
INNER JOIN
      &SVC.EVAL&SVC_TBL.EVAL
ON    SVC_ISA_FILE_ID            = CLP_ISA_FILE_ID
  AND SVC_GS_GRP_SEQ_NO          = CLP_GS_GRP_SEQ_NO
  AND SVC_ST_SEQ_NO              = CLP_ST_SEQ_NO
  AND SVC_LX_SEQ_NO              = CLP_LX_SEQ_NO
  AND SVC_CLP_CLM_SEQ_NO         = CLP_CLM_SEQ_NO
  AND RTRIM(SVC_CLARITY_TX_ID)   = '0'
  AND SVC_EXCL_RSN_CD            = '   '
-*  AND TO_NUMBER(COALESCE(RTRIM(SVC_LI_PRVDR_PYMT),'0')) = 0
LEFT OUTER JOIN
      &SVC_DTM.EVAL&SVC_DTM_TBL.EVAL
ON    SVC_DTM_ISA_FILE_ID        = SVC_ISA_FILE_ID
  AND SVC_DTM_GS_GRP_SEQ_NO      = SVC_GS_GRP_SEQ_NO
  AND SVC_DTM_ST_SEQ_NO          = SVC_ST_SEQ_NO
  AND SVC_DTM_LX_SEQ_NO          = SVC_LX_SEQ_NO
  AND SVC_DTM_CLP_CLM_SEQ_NO     = SVC_CLP_CLM_SEQ_NO
  AND SVC_DTM_SVC_SEQ_NO         = SVC_SEQ_NO
  AND SVC_DTM_DTTM_QLFR          IN( '472','150' )
  AND SVC_DTM_EXCL_RSN_CD        = '   '
INNER JOIN
      &NM1.EVAL&NM1_TBL.EVAL
ON    NM1_ISA_FILE_ID            = CLP_ISA_FILE_ID
  AND NM1_GS_GRP_SEQ_NO          = CLP_GS_GRP_SEQ_NO
  AND NM1_ST_SEQ_NO              = CLP_ST_SEQ_NO
  AND NM1_LX_SEQ_NO              = CLP_LX_SEQ_NO
  AND NM1_CLP_CLM_SEQ_NO         = CLP_CLM_SEQ_NO
  AND RTRIM(NM1_ENTITY_ID_CD)    = 'QC'
  AND INITCAP(RTRIM(NM1_PT_LST_NM)) NOT IN('Posting','Image','Partners Medical Gro','Healthcare Ins Co')
-*
-*  AND INITCAP(RTRIM(NM1_PT_LST_NM)) = 'Pour'
-*
INNER JOIN
      PATIENT P
ON      PAT_LAST_NAME  = INITCAP(RTRIM(NM1_PT_LST_NM))
-*-*-*-*    OR  PAT_LAST_NAME  = RTRIM(NM1_PT_LST_NM)
-*-*-*-*    OR  PAT_LAST_NAME  = INITCAP(SUBSTR(RTRIM(NM1_PT_LST_NM), 1, INSTR(RTRIM(NM1_PT_LST_NM), ' ')-1))
-*-*-*-*    OR  PAT_LAST_NAME  = INITCAP(SUBSTR(RTRIM(NM1_PT_LST_NM), INSTR(RTRIM(NM1_PT_LST_NM), ' ')+1, LENGTH(RTRIM(NM1_PT_LST_NM))))
-*-*-*-*    OR  PAT_LAST_NAME  = INITCAP(SUBSTR(RTRIM(NM1_PT_LST_NM), 1, INSTR(RTRIM(NM1_PT_LST_NM), '-')-1))
-*-*-*-*    OR  PAT_LAST_NAME  = INITCAP(SUBSTR(RTRIM(NM1_PT_LST_NM), INSTR(RTRIM(NM1_PT_LST_NM), '-')+1, LENGTH(RTRIM(NM1_PT_LST_NM))))
-*-*ON PAT_LAST_NAME  = 'Mc'||UPPER(SUBSTR(NM1_PT_LST_NM,3,1))||LOWER(SUBSTR(NM1_PT_LST_NM,4,LENGTH(RTRIM(NM1_PT_LST_NM))-3))
-*-*-*-*  AND   PAT_FIRST_NAME = INITCAP(RTRIM(NM1_PT_FST_NM))
-*-*-*-*    OR  PAT_FIRST_NAME = RTRIM(NM1_PT_FST_NM)
  AND  SUBSTR(PAT_FIRST_NAME,1,3)      = SUBSTR(INITCAP(RTRIM(NM1_PT_FST_NM)),1,3)
-*-*-*    OR (   LENGTH(RTRIM(NM1_PT_FST_NM)) = 1 )
-*-*-*       AND SUBSTR(PAT_FIRST_NAME,1,1)   = SUBSTR(INITCAP(RTRIM(NM1_PT_FST_NM)),1,1))
INNER JOIN
      CLARITY_TDL_TRAN   A
ON    A.INT_PAT_ID             = P.PAT_ID
  AND A.DETAIL_TYPE            = 1
-*-* AND (  A.ORIG_PRICE          = ABS(TO_NUMBER(COALESCE(RTRIM(SVC_ORGLI_PRVDR_PYMT),'0')))
-*    OR  A.CPT_CODE            = RTRIM(SVC_PROC1_CD)
-*    OR  A.ORIG_SERVICE_DATE   = TO_DATE(SVC_DTM_DATE,'YYYYMMDD'))
-*-*  AND ( (       SUBSTR(SVC_DTM_DATE,5,2)          = TO_CHAR(ORIG_SERVICE_DATE, 'mm')
-*-*            AND SUBSTR(SVC_DTM_DATE,7,2)          = TO_CHAR(ORIG_SERVICE_DATE, 'dd'))
-*-*      OR (      SUBSTR(SVC_DTM_DATE,1,4)          = TO_CHAR(ORIG_SERVICE_DATE, 'yyyy')
-*-*            AND SUBSTR(SVC_DTM_DATE,7,2)          = TO_CHAR(ORIG_SERVICE_DATE, 'dd')
-*-*		    AND NOT (    SUBSTR(SVC_DTM_DATE,5,2) = TO_CHAR(ORIG_SERVICE_DATE, 'mm')
-*-*                     AND SUBSTR(SVC_DTM_DATE,7,2) = TO_CHAR(ORIG_SERVICE_DATE, 'dd')))
-*-*	  OR (      SUBSTR(SVC_DTM_DATE,1,4)          = TO_CHAR(ORIG_SERVICE_DATE, 'yyyy')
-*-*	        AND SUBSTR(SVC_DTM_DATE,5,2)          = TO_CHAR(ORIG_SERVICE_DATE, 'mm')
-*-*            AND NOT (    SUBSTR(SVC_DTM_DATE,5,2) = TO_CHAR(ORIG_SERVICE_DATE, 'mm')
-*-*                     AND SUBSTR(SVC_DTM_DATE,7,2) = TO_CHAR(ORIG_SERVICE_DATE, 'dd'))
-*-*            AND NOT (    SUBSTR(SVC_DTM_DATE,1,4) = TO_CHAR(ORIG_SERVICE_DATE, 'yy')
-*-*                     AND SUBSTR(SVC_DTM_DATE,7,2) = TO_CHAR(ORIG_SERVICE_DATE, 'dd'))))
INNER JOIN
      ARPB_TRANSACTIONS  B
ON    B.TX_ID = A.TX_ID
-*  AND B.OUTSTANDING_AMT  > 0
-*  AND B.OUTSTANDING_AMT      >= TO_NUMBER(COALESCE(RTRIM(SVC_LI_PRVDR_PYMT),'0'))
-*INNER JOIN
-*      INV_CLM_LN_ADDL    C
-*ON    C.INVOICE_NUM           = A.INVOICE_NUMBER
-*  AND C.CHARGE_AMOUNT         = ABS(TO_NUMBER(COALESCE(RTRIM(SVC_ORGLI_PRVDR_PYMT),'0')))
-*  AND ( C.PROC_OR_REV_CODE    = RTRIM(SVC_PROC1_CD)
-*      OR RTRIM(SVC_PROC1_CD)  = 'ZZE01' )
-*  AND C.FROM_SVC_DATE         = TO_DATE(SVC_DTM_DATE,'YYYYMMDD')
-*-*  AND C.CHARGE_AMOUNT        >= ABS(TO_NUMBER(COALESCE(RTRIM(SVC_ORGLI_PRVDR_PYMT),'0')))
-*-*-*  AND NOT EXISTS
-*-*   ( SELECT 1
-*-*     FROM   INV_CLM_LN_ADDL    Z
-*-*     WHERE  Z.INVOICE_NUM      = C.INVOICE_NUM
-*-*       AND  Z.FROM_SVC_DATE    = C.FROM_SVC_DATE
-*-*       AND  Z.CHARGE_AMOUNT   <> C.CHARGE_AMOUNT )
-*  AND ((  C.CLAIM_STATUS_C     = 1 )
-*    OR (  C.CLAIM_STATUS_C    <> 1
-*          AND NOT EXISTS
-*           ( SELECT 1
-*             FROM   CLARITY_TDL_TRAN   X
-*                   ,INV_CLM_LN_ADDL    Y
-*             WHERE  X.INT_PAT_ID        = P.PAT_ID
-*               AND  X.DETAIL_TYPE       = 50
-*               AND  X.ORIG_SERVICE_DATE = TO_DATE(SVC_DTM_DATE,'YYYYMMDD')
-*               AND  Y.INVOICE_NUM       = X.INVOICE_NUMBER
-*               AND  Y.PROC_OR_REV_CODE  = C.PROC_OR_REV_CODE
-*               AND  Y.CHARGE_AMOUNT     = C.CHARGE_AMOUNT
-*               AND  Y.CLAIM_STATUS_C    = 1 )))
WHERE ST_EXCL_RSN_CD = '   '
-*ORDER BY 1,2,3,4,5,6,7,8,9,10,11,12
ORDER BY 1,2,3,4
;
TABLEF FILE SQLOUT
LIST *
END
-EXIT
SQL
SELECT
      SVC_ISA_FILE_ID
     ,SVC_GS_GRP_SEQ_NO
     ,SVC_ST_SEQ_NO
     ,SVC_LX_SEQ_NO
     ,SVC_CLP_CLM_SEQ_NO
     ,CLP_CLM_SUBMTR_ID
-*     ,SVC_DTM_DATE
     ,RTRIM(SVC_PROC1_CD)
FROM  &ST.EVAL&ST_TBL.EVAL
INNER JOIN
      &CLP.EVAL&CLP_TBL.EVAL
ON    CLP_ISA_FILE_ID            = ST_ISA_FILE_ID
  AND CLP_GS_GRP_SEQ_NO          = ST_GS_GRP_SEQ_NO
  AND CLP_ST_SEQ_NO              = ST_SEQ_NO
  AND CLP_EXCL_RSN_CD            = '   '
INNER JOIN
      &SVC.EVAL&SVC_TBL.EVAL
ON    SVC_ISA_FILE_ID            = CLP_ISA_FILE_ID
  AND SVC_GS_GRP_SEQ_NO          = CLP_GS_GRP_SEQ_NO
  AND SVC_ST_SEQ_NO              = CLP_ST_SEQ_NO
  AND SVC_LX_SEQ_NO              = CLP_LX_SEQ_NO
  AND SVC_CLP_CLM_SEQ_NO         = CLP_CLM_SEQ_NO
-*  AND RTRIM(SVC_CLARITY_TX_ID)   = '0'
  AND SVC_INCL_RSN_CD            = 'ZZH'
-*LEFT OUTER JOIN
-*      &SVC_DTM.EVAL&SVC_DTM_TBL.EVAL
-*ON    SVC_DTM_ISA_FILE_ID        = SVC_ISA_FILE_ID
-*  AND SVC_DTM_GS_GRP_SEQ_NO      = SVC_GS_GRP_SEQ_NO
-*  AND SVC_DTM_ST_SEQ_NO          = SVC_ST_SEQ_NO
-*  AND SVC_DTM_LX_SEQ_NO          = SVC_LX_SEQ_NO
-*  AND SVC_DTM_CLP_CLM_SEQ_NO     = SVC_CLP_CLM_SEQ_NO
-*  AND SVC_DTM_SVC_SEQ_NO         = SVC_SEQ_NO
-*  AND SVC_DTM_DTTM_QLFR          IN( '472','150' )
-*  AND SVC_DTM_EXCL_RSN_CD        = '   '
-*GROUP BY
-*      SVC_ISA_FILE_ID
-*     ,SVC_GS_GRP_SEQ_NO
-*     ,SVC_ST_SEQ_NO
-*     ,SVC_LX_SEQ_NO
-*     ,SVC_CLP_CLM_SEQ_NO
-*     ,CLP_CLM_SUBMTR_ID
-*     ,SVC_DTM_DATE
-*     ,RTRIM(SVC_PROC1_CD)
-*HAVING COUNT(*) > 1
;
END
-EXIT
SQL
SELECT
      S1.SVC_ISA_FILE_ID
     ,S1.SVC_GS_GRP_SEQ_NO
     ,S1.SVC_ST_SEQ_NO
     ,S1.SVC_LX_SEQ_NO
     ,S1.SVC_CLP_CLM_SEQ_NO
     ,S1.SVC_SEQ_NO
     ,S1.SVC_EPP_GEN_SEQ+1
     ,S1.SVC_COMP_SEPERATOR
     ,S1.SVC_PROC1_SVC_ID_QLFR
     ,S1.SVC_PROC1_CD
     ,S1.SVC_PROC1_MODF1
     ,S1.SVC_PROC1_MODF2
     ,S1.SVC_PROC1_MODF3
     ,S1.SVC_PROC1_MODF4
     ,INVC_CRG_AMT             AS SVC_ORGLI_PRVDR_PYMT
     ,ERA_TOT_PMT              AS SVC_LI_PRVDR_PYMT
     ,S1.SVC_NTL_BILNG_REV_CD
     ,S1.SVC_UNTS_SVC_PD_CNT
     ,S1.SVC_PROC2_SVC_ID_QLFR
     ,S1.SVC_PROC2_CD
     ,S1.SVC_PROC2_MODF1
     ,S1.SVC_PROC2_MODF2
     ,S1.SVC_PROC2_MODF3
     ,S1.SVC_PROC2_MODF4
     ,S1.SVC_PROC2_CD_DESC
     ,S1.SVC_ORG_UNTS_SVC_CNT
     ,X.TX_ID                  AS SVC_CLARITY_TX_ID
     ,'MMC'                    AS SVC_TX_ID_MATCH_TYPE
     ,S1.SVC_CONTR_PAYOR_IND
     ,S1.SVC_DUP_PMT_IND
     ,S1.SVC_RVSD_INVC_NO
     ,Y.OUTSTANDING_AMT        AS SVC_CURRENT_BALANCE
     ,S1.SVC_INS_AMOUNT_PAID
     ,S1.SVC_INS_AMOUNT_ADJ
     ,S1.SVC_CRG_IS_VOID_YN
     ,S1.SVC_PRIOR_DENIAL_YN
     ,S1.SVC_MULTI_USE_AMOUNT
     ,S1.SVC_SCENARIO
     ,'MMC'                    AS SVC_INCL_RSN_CD
     ,'   '                    AS SVC_EXCL_RSN_CD
FROM
(
SELECT
      SVC_ISA_FILE_ID
     ,SVC_GS_GRP_SEQ_NO
     ,SVC_ST_SEQ_NO
     ,SVC_LX_SEQ_NO
     ,SVC_CLP_CLM_SEQ_NO
     ,ERA_INVC
     ,ERA_DOS
     ,ERA_CPT
     ,ERA_TOT_CRG
     ,SUM(CHARGE_AMOUNT)    AS INVC_CRG_AMT
     ,ERA_TOT_PMT
FROM
(
SELECT
      SVC_ISA_FILE_ID
     ,SVC_GS_GRP_SEQ_NO
     ,SVC_ST_SEQ_NO
     ,SVC_LX_SEQ_NO
     ,SVC_CLP_CLM_SEQ_NO
     ,RTRIM(CLP_CLM_SUBMTR_ID)          AS ERA_INVC
     ,TO_DATE(SVC_DTM_DATE, 'YYYYMMDD') AS ERA_DOS
     ,RTRIM(SVC_PROC1_CD)               AS ERA_CPT
     ,COUNT(*)                          AS ERA_CNT
     ,SUM(TO_NUMBER(COALESCE(RTRIM(SVC_ORGLI_PRVDR_PYMT),'0')))
                                        AS ERA_TOT_CRG
     ,SUM(TO_NUMBER(COALESCE(RTRIM(SVC_LI_PRVDR_PYMT),'0')))
                                        AS ERA_TOT_PMT
FROM  &ST.EVAL&ST_TBL.EVAL
INNER JOIN
      &CLP.EVAL&CLP_TBL.EVAL
ON    CLP_ISA_FILE_ID            = ST_ISA_FILE_ID
  AND CLP_GS_GRP_SEQ_NO          = ST_GS_GRP_SEQ_NO
  AND CLP_ST_SEQ_NO              = ST_SEQ_NO
  AND CLP_EXCL_RSN_CD            = '   '
INNER JOIN
      &SVC.EVAL&SVC_TBL.EVAL
ON    SVC_ISA_FILE_ID            = CLP_ISA_FILE_ID
  AND SVC_GS_GRP_SEQ_NO          = CLP_GS_GRP_SEQ_NO
  AND SVC_ST_SEQ_NO              = CLP_ST_SEQ_NO
  AND SVC_LX_SEQ_NO              = CLP_LX_SEQ_NO
  AND SVC_CLP_CLM_SEQ_NO         = CLP_CLM_SEQ_NO
  AND SVC_EXCL_RSN_CD            = '   '
LEFT OUTER JOIN
      &SVC_DTM.EVAL&SVC_DTM_TBL.EVAL
ON    SVC_DTM_ISA_FILE_ID        = SVC_ISA_FILE_ID
  AND SVC_DTM_GS_GRP_SEQ_NO      = SVC_GS_GRP_SEQ_NO
  AND SVC_DTM_ST_SEQ_NO          = SVC_ST_SEQ_NO
  AND SVC_DTM_LX_SEQ_NO          = SVC_LX_SEQ_NO
  AND SVC_DTM_CLP_CLM_SEQ_NO     = SVC_CLP_CLM_SEQ_NO
  AND SVC_DTM_SVC_SEQ_NO         = SVC_SEQ_NO
  AND SVC_DTM_DTTM_QLFR          IN( '472','150' )
  AND SVC_DTM_EXCL_RSN_CD        = '   '
GROUP BY
      SVC_ISA_FILE_ID
     ,SVC_GS_GRP_SEQ_NO
     ,SVC_ST_SEQ_NO
     ,SVC_LX_SEQ_NO
     ,SVC_CLP_CLM_SEQ_NO
     ,CLP_CLM_SUBMTR_ID
     ,SVC_DTM_DATE
     ,RTRIM(SVC_PROC1_CD)
HAVING COUNT(*) > 1
)
INNER JOIN
      INV_CLM_LN_ADDL    A
ON    A.INVOICE_NUM      = ERA_INVC
  AND A.FROM_SVC_DATE    = ERA_DOS
  AND A.PROC_OR_REV_CODE = ERA_CPT
GROUP BY
      SVC_ISA_FILE_ID
     ,SVC_GS_GRP_SEQ_NO
     ,SVC_ST_SEQ_NO
     ,SVC_LX_SEQ_NO
     ,SVC_CLP_CLM_SEQ_NO
     ,ERA_INVC
     ,ERA_DOS
     ,ERA_CPT
     ,ERA_TOT_CRG
     ,ERA_TOT_PMT
HAVING COUNT(*)          = 1
) T1
INNER JOIN
      CLARITY_TDL_TRAN  X
ON    INVOICE_NUMBER     = ERA_INVC
  AND DETAIL_TYPE        = 50
  AND ORIG_SERVICE_DATE  = ERA_DOS
  AND CPT_CODE           = ERA_CPT
INNER JOIN
      ARPB_TRANSACTIONS Y
ON    Y.TX_ID            = X.TX_ID
  AND Y.VOID_DATE        IS NULL
INNER JOIN
      &SVC.EVAL&SVC_TBL.EVAL S1
ON    S1.SVC_ISA_FILE_ID     = T1.SVC_ISA_FILE_ID
  AND S1.SVC_GS_GRP_SEQ_NO   = T1.SVC_GS_GRP_SEQ_NO
  AND S1.SVC_ST_SEQ_NO       = T1.SVC_ST_SEQ_NO
  AND S1.SVC_LX_SEQ_NO       = T1.SVC_LX_SEQ_NO
  AND S1.SVC_CLP_CLM_SEQ_NO  = T1.SVC_CLP_CLM_SEQ_NO
  AND RTRIM(S1.SVC_PROC1_CD) = T1.ERA_CPT
  AND S1.SVC_EXCL_RSN_CD     = '   '
  AND S1.SVC_SEQ_NO = ( SELECT MIN(S2.SVC_SEQ_NO)
                        FROM   &SVC.EVAL&SVC_TBL.EVAL  S2
                              ,&SVC_DTM.EVAL&SVC_DTM_TBL.EVAL
                        WHERE  S2.SVC_ISA_FILE_ID     = T1.SVC_ISA_FILE_ID
                          AND  S2.SVC_GS_GRP_SEQ_NO   = T1.SVC_GS_GRP_SEQ_NO
                          AND  S2.SVC_ST_SEQ_NO       = T1.SVC_ST_SEQ_NO
                          AND  S2.SVC_LX_SEQ_NO       = T1.SVC_LX_SEQ_NO
                          AND  S2.SVC_CLP_CLM_SEQ_NO  = T1.SVC_CLP_CLM_SEQ_NO
                          AND  RTRIM(S2.SVC_PROC1_CD) = T1.ERA_CPT
                          AND  S2.SVC_EXCL_RSN_CD     = '   '
                          AND  SVC_DTM_ISA_FILE_ID    = S2.SVC_ISA_FILE_ID
                          AND  SVC_DTM_GS_GRP_SEQ_NO  = S2.SVC_GS_GRP_SEQ_NO
                          AND  SVC_DTM_ST_SEQ_NO      = S2.SVC_ST_SEQ_NO
                          AND  SVC_DTM_LX_SEQ_NO      = S2.SVC_LX_SEQ_NO
                          AND  SVC_DTM_CLP_CLM_SEQ_NO = S2.SVC_CLP_CLM_SEQ_NO
                          AND  SVC_DTM_SVC_SEQ_NO     = S2.SVC_SEQ_NO
                          AND  SVC_DTM_DTTM_QLFR      IN( '472','150' )
                          AND  SVC_DTM_EXCL_RSN_CD    = '   '
                          AND  TO_DATE(SVC_DTM_DATE, 'YYYYMMDD') = ERA_DOS )
ORDER BY 1,2,3,4,5,6
;
END
-EXIT
SQL
SELECT
      SVC_ISA_FILE_ID
     ,SVC_GS_GRP_SEQ_NO
     ,SVC_ST_SEQ_NO
     ,SVC_LX_SEQ_NO
     ,SVC_CLP_CLM_SEQ_NO
     ,CLP_CLM_SUBMTR_ID
     ,SVC_DTM_DATE
     ,RTRIM(SVC_PROC1_CD)
     ,COUNT(*)
FROM  &ST.EVAL&ST_TBL.EVAL
INNER JOIN
      &CLP.EVAL&CLP_TBL.EVAL
ON    CLP_ISA_FILE_ID            = ST_ISA_FILE_ID
  AND CLP_GS_GRP_SEQ_NO          = ST_GS_GRP_SEQ_NO
  AND CLP_ST_SEQ_NO              = ST_SEQ_NO
  AND CLP_EXCL_RSN_CD            = '   '
INNER JOIN
      &SVC.EVAL&SVC_TBL.EVAL
ON    SVC_ISA_FILE_ID            = CLP_ISA_FILE_ID
  AND SVC_GS_GRP_SEQ_NO          = CLP_GS_GRP_SEQ_NO
  AND SVC_ST_SEQ_NO              = CLP_ST_SEQ_NO
  AND SVC_LX_SEQ_NO              = CLP_LX_SEQ_NO
  AND SVC_CLP_CLM_SEQ_NO         = CLP_CLM_SEQ_NO
-*  AND RTRIM(SVC_CLARITY_TX_ID)   = '0'
  AND SVC_EXCL_RSN_CD            = '   '
LEFT OUTER JOIN
      &SVC_DTM.EVAL&SVC_DTM_TBL.EVAL
ON    SVC_DTM_ISA_FILE_ID        = SVC_ISA_FILE_ID
  AND SVC_DTM_GS_GRP_SEQ_NO      = SVC_GS_GRP_SEQ_NO
  AND SVC_DTM_ST_SEQ_NO          = SVC_ST_SEQ_NO
  AND SVC_DTM_LX_SEQ_NO          = SVC_LX_SEQ_NO
  AND SVC_DTM_CLP_CLM_SEQ_NO     = SVC_CLP_CLM_SEQ_NO
  AND SVC_DTM_SVC_SEQ_NO         = SVC_SEQ_NO
  AND SVC_DTM_DTTM_QLFR          IN( '472','150' )
  AND SVC_DTM_EXCL_RSN_CD        = '   '
GROUP BY
      SVC_ISA_FILE_ID
     ,SVC_GS_GRP_SEQ_NO
     ,SVC_ST_SEQ_NO
     ,SVC_LX_SEQ_NO
     ,SVC_CLP_CLM_SEQ_NO
     ,CLP_CLM_SUBMTR_ID
     ,SVC_DTM_DATE
     ,RTRIM(SVC_PROC1_CD)
HAVING COUNT(*) > 1
;
END
-EXIT
-*SQL
-*SELECT *
-*FROM   INV_BASIC_INFO
-*WHERE INV_ID = 6539108
-*;
-*END
-*-EXIT
SQL
SELECT *
FROM  &CLP.EVAL&CLP_TBL.EVAL
INNER JOIN
      &SVC.EVAL&SVC_TBL.EVAL
ON    SVC_ISA_FILE_ID    = CLP_ISA_FILE_ID
  AND SVC_GS_GRP_SEQ_NO  = CLP_GS_GRP_SEQ_NO
  AND SVC_ST_SEQ_NO      = CLP_ST_SEQ_NO
  AND SVC_LX_SEQ_NO      = CLP_LX_SEQ_NO
  AND SVC_CLP_CLM_SEQ_NO = CLP_CLM_SEQ_NO
-*  AND SVC_INCL_RSN_CD    = 'AA1'
LEFT OUTER JOIN
      &SVC_CAS.EVAL&SVC_CAS_TBL.EVAL
ON    SVC_CAS_ISA_FILE_ID       = SVC_ISA_FILE_ID
  AND SVC_CAS_GS_GRP_SEQ_NO     = SVC_GS_GRP_SEQ_NO
  AND SVC_CAS_ST_SEQ_NO         = SVC_ST_SEQ_NO
  AND SVC_CAS_LX_SEQ_NO         = SVC_LX_SEQ_NO
  AND SVC_CAS_CLP_CLM_SEQ_NO    = SVC_CLP_CLM_SEQ_NO
  AND SVC_CAS_SVC_SEQ_NO        = SVC_SEQ_NO
-*  AND SVC_CAS_EXCL_RSN_CD       = '   '
WHERE RTRIM(CLP_CLM_SUBMTR_ID) = 'P1070296371'
;
END
-EXIT
SQL
SELECT *
FROM CLARITY_TDL_TRAN
WHERE TX_ID = 34451914
;
END
-EXIT
SQL
SELECT *
FROM   CLARITY_TDL_TRAN
WHERE  INVOICE_NUMBER = '2285762'
;
END
-EXIT
-*SQL
-*SELECT *
-*FROM   &SVC.EVAL&SVC_TBL.EVAL
-*WHERE  SVC_TX_ID_MATCH_TYPE = 'MP3'
-*;
-*END
-*-EXIT
-*SQL
-*SELECT *
-*FROM   INV_BASIC_INFO
-*WHERE  INV_ID   = 7281060
-*;
-*END
-*-EXIT
-*SQL
-*SELECT
-*      RTRIM(CLP_CLM_SUBMTR_ID)   AS INVOICE
-*     ,INVOICE_ID
-*-*     ,A.PATIENT_ID
-*FROM  &ST.EVAL&ST_TBL.EVAL
-*INNER JOIN
-*      &CLP.EVAL&CLP_TBL.EVAL
-*ON    CLP_ISA_FILE_ID            = ST_ISA_FILE_ID
-*  AND CLP_GS_GRP_SEQ_NO          = ST_GS_GRP_SEQ_NO
-*  AND CLP_ST_SEQ_NO              = ST_SEQ_NO
-*  AND CLP_EXCL_RSN_CD            = '   '
-*
-*  AND RTRIM(CLP_CLM_SUBMTR_ID)   = 'P1072740140'
-*
-*INNER JOIN
-*      &SVC.EVAL&SVC_TBL.EVAL
-*ON    SVC_ISA_FILE_ID            = CLP_ISA_FILE_ID
-*  AND SVC_GS_GRP_SEQ_NO          = CLP_GS_GRP_SEQ_NO
-*  AND SVC_ST_SEQ_NO              = CLP_ST_SEQ_NO
-*  AND SVC_LX_SEQ_NO              = CLP_LX_SEQ_NO
-*  AND SVC_CLP_CLM_SEQ_NO         = CLP_CLM_SEQ_NO
-*-*  AND RTRIM(SVC_CLARITY_TX_ID)  <> '0'
-*  AND SVC_EXCL_RSN_CD            = '   '
-*INNER JOIN
-*      INV_CLM_LN_ADDL  B
-*ON    B.INVOICE_NUM              = 'P1072740140'
-*-*-*  AND B.ORIG_SERVICE_DATE       = A.SERVICE_DATE
-*-*  AND B.DETAIL_TYPE             = 50
-*-*  AND B.CPT_CODE                = RTRIM(SVC_PROC1_CD)
-*-*  AND B.TX_ID                  <> A.TX_ID
-*-*INNER JOIN
-*-*      ARPB_TRANSACTIONS A
-*-*ON    A.TX_ID                   = 43151816
-*-*  AND A.VOID_DATE               IS NOT NULL
-*
-*-*INNER JOIN
-*-*      ARPB_TRANSACTIONS C
-*-*ON    C.TX_ID                   = B.TX_ID
-*-*  AND C.VOID_DATE               IS NULL
-*-*  AND NOT EXISTS
-*-*  ( SELECT 1
-*-*    FROM   CLARITY_TDL_TRAN X
-*-*    WHERE  X.TX_ID              = C.TX_ID
-*-*      AND  X.DETAIL_TYPE        = 50 )
-*WHERE ST_EXCL_RSN_CD            = '   '
-*;
-*TABLEF FILE SQLOUT
-*LIST *
-*-*ON TABLE HOLD
-*END
-*-RUN
-*-TYPE &RECORDS.EVAL
-*-EXIT
SQL
SELECT *
FROM   INV_CLM_LN_ADDL
WHERE INVOICE_NUM  = 'P1076906841'
;
END
-EXIT
SQL
SELECT
      CLP_CLM_SUBMTR_ID
     ,CLP_PYR_CLM_CNTL_NO
     ,INVOICE_NUMBER
FROM   &CLP.EVAL&CLP_TBL.EVAL
INNER JOIN
       CLARITY_TDL_TRAN
ON     INVOICE_NUMBER = RTRIM(CLP_PYR_CLM_CNTL_NO)
WHERE  CLP_EXCL_RSN_CD = '   '
;
END
-EXIT
SQL
SELECT DISTINCT
-*      SVC_ISA_FILE_ID
-*     ,SVC_GS_GRP_SEQ_NO
-*     ,SVC_ST_SEQ_NO
-*     ,SVC_LX_SEQ_NO
-*     ,SVC_CLP_CLM_SEQ_NO
-*     ,SVC_SEQ_NO
-*     ,SVC_EPP_GEN_SEQ
      NM1_PT_LST_NM
     ,NM1_PT_FST_NM
     ,PAT_LAST_NAME
     ,PAT_FIRST_NAME
     ,SVC_DTM_DATE
     ,A.ORIG_SERVICE_DATE
     ,CLP_CLM_SUBMTR_ID
     ,C.INVOICE_NUM
-*-*-*-*     ,PAT_LAST_NAME
-*-*-*-*     ,PAT_FIRST_NAME
-*-*-*-*     ,SVC_SEQ_NO
-*-*-*-*     ,C.FROM_SVC_DATE
     ,RTRIM(SVC_PROC1_CD)
     ,A.CPT_CODE
     ,PROC_OR_REV_CODE
     ,SVC_ORGLI_PRVDR_PYMT
     ,A.ORIG_PRICE
     ,C.CHARGE_AMOUNT
     ,SVC_LI_PRVDR_PYMT
     ,B.OUTSTANDING_AMT
-*-*-*-*     ,C.INVOICE_NUM
-*     ,C.CLAIM_STATUS_C
-*     ,B.OUTSTANDING_AMT
-*     ,SVC_INCL_RSN_CD
-*     ,SVC_ISA_FILE_ID
-*     ,SVC_GS_GRP_SEQ_NO
-*     ,SVC_ST_SEQ_NO
-*     ,SVC_LX_SEQ_NO
-*     ,SVC_CLP_CLM_SEQ_NO
-*     ,SVC_SEQ_NO
-*     ,SVC_EPP_GEN_SEQ
-*     ,A.INT_PAT_ID
-*     ,A.INVOICE_NUMBER
-*     ,CLAIM_STATUS_C
-*     ,SVC_PROC1_CD
-*     ,PROC_OR_REV_CODE
-*     ,SVC_DTM_DATE
-*     ,SVC_ORGLI_PRVDR_PYMT
-*     ,C.CHARGE_AMOUNT
-*     ,SVC_LI_PRVDR_PYMT
FROM  &ST.EVAL&ST_TBL.EVAL
INNER JOIN
      &CLP.EVAL&CLP_TBL.EVAL
ON    CLP_ISA_FILE_ID            = ST_ISA_FILE_ID
  AND CLP_GS_GRP_SEQ_NO          = ST_GS_GRP_SEQ_NO
  AND CLP_ST_SEQ_NO              = ST_SEQ_NO
  AND CLP_EXCL_RSN_CD            = '   '
INNER JOIN
      &SVC.EVAL&SVC_TBL.EVAL
ON    SVC_ISA_FILE_ID            = CLP_ISA_FILE_ID
  AND SVC_GS_GRP_SEQ_NO          = CLP_GS_GRP_SEQ_NO
  AND SVC_ST_SEQ_NO              = CLP_ST_SEQ_NO
  AND SVC_LX_SEQ_NO              = CLP_LX_SEQ_NO
  AND SVC_CLP_CLM_SEQ_NO         = CLP_CLM_SEQ_NO
  AND RTRIM(SVC_CLARITY_TX_ID)   = '0'
  AND SVC_EXCL_RSN_CD            = '   '
-*  AND TO_NUMBER(COALESCE(RTRIM(SVC_LI_PRVDR_PYMT),'0')) = 0
LEFT OUTER JOIN
      &SVC_DTM.EVAL&SVC_DTM_TBL.EVAL
ON    SVC_DTM_ISA_FILE_ID        = SVC_ISA_FILE_ID
  AND SVC_DTM_GS_GRP_SEQ_NO      = SVC_GS_GRP_SEQ_NO
  AND SVC_DTM_ST_SEQ_NO          = SVC_ST_SEQ_NO
  AND SVC_DTM_LX_SEQ_NO          = SVC_LX_SEQ_NO
  AND SVC_DTM_CLP_CLM_SEQ_NO     = SVC_CLP_CLM_SEQ_NO
  AND SVC_DTM_SVC_SEQ_NO         = SVC_SEQ_NO
  AND SVC_DTM_DTTM_QLFR          IN( '472','150' )
  AND SVC_DTM_EXCL_RSN_CD        = '   '
INNER JOIN
      &NM1.EVAL&NM1_TBL.EVAL
ON    NM1_ISA_FILE_ID            = CLP_ISA_FILE_ID
  AND NM1_GS_GRP_SEQ_NO          = CLP_GS_GRP_SEQ_NO
  AND NM1_ST_SEQ_NO              = CLP_ST_SEQ_NO
  AND NM1_LX_SEQ_NO              = CLP_LX_SEQ_NO
  AND NM1_CLP_CLM_SEQ_NO         = CLP_CLM_SEQ_NO
  AND INITCAP(RTRIM(NM1_PT_LST_NM)) NOT IN('Posting','Image','Partners Medical Gro','Healthcare Ins Co')
-*
-*  AND INITCAP(RTRIM(NM1_PT_LST_NM)) = 'Pour'
-*
LEFT OUTER JOIN
      PATIENT P
ON    ( PAT_LAST_NAME  = INITCAP(RTRIM(NM1_PT_LST_NM))
    OR  PAT_LAST_NAME  = RTRIM(NM1_PT_LST_NM)
    OR  PAT_LAST_NAME  = INITCAP(SUBSTR(RTRIM(NM1_PT_LST_NM), 1, INSTR(RTRIM(NM1_PT_LST_NM), ' ')-1))
    OR  PAT_LAST_NAME  = INITCAP(SUBSTR(RTRIM(NM1_PT_LST_NM), INSTR(RTRIM(NM1_PT_LST_NM), ' ')+1, LENGTH(RTRIM(NM1_PT_LST_NM))))
    OR  PAT_LAST_NAME  = INITCAP(SUBSTR(RTRIM(NM1_PT_LST_NM), 1, INSTR(RTRIM(NM1_PT_LST_NM), '-')-1))
    OR  PAT_LAST_NAME  = INITCAP(SUBSTR(RTRIM(NM1_PT_LST_NM), INSTR(RTRIM(NM1_PT_LST_NM), '-')+1, LENGTH(RTRIM(NM1_PT_LST_NM))))
    OR  PAT_LAST_NAME  = 'Mc'||UPPER(SUBSTR(NM1_PT_LST_NM,3,1))||LOWER(SUBSTR(NM1_PT_LST_NM,4,LENGTH(RTRIM(NM1_PT_LST_NM))-3)))
-*  AND ( PAT_FIRST_NAME = INITCAP(RTRIM(NM1_PT_FST_NM))
-*    OR  PAT_FIRST_NAME = RTRIM(NM1_PT_FST_NM)
-*    OR  SUBSTR(PAT_FIRST_NAME,1,2)      = SUBSTR(INITCAP(RTRIM(NM1_PT_FST_NM)),1,2)
-*    OR (   LENGTH(RTRIM(NM1_PT_FST_NM)) = 1 )
-*       AND SUBSTR(PAT_FIRST_NAME,1,1)   = SUBSTR(INITCAP(RTRIM(NM1_PT_FST_NM)),1,1))
INNER JOIN
      CLARITY_TDL_TRAN   A
ON    A.INT_PAT_ID             = P.PAT_ID
  AND A.DETAIL_TYPE            = 50
 AND (  A.ORIG_PRICE          = ABS(TO_NUMBER(COALESCE(RTRIM(SVC_ORGLI_PRVDR_PYMT),'0')))
    OR  A.CPT_CODE            = RTRIM(SVC_PROC1_CD)
    OR  A.ORIG_SERVICE_DATE   = TO_DATE(SVC_DTM_DATE,'YYYYMMDD'))
-*-*  AND ( (       SUBSTR(SVC_DTM_DATE,5,2)          = TO_CHAR(ORIG_SERVICE_DATE, 'mm')
-*-*            AND SUBSTR(SVC_DTM_DATE,7,2)          = TO_CHAR(ORIG_SERVICE_DATE, 'dd'))
-*-*      OR (      SUBSTR(SVC_DTM_DATE,1,4)          = TO_CHAR(ORIG_SERVICE_DATE, 'yyyy')
-*-*            AND SUBSTR(SVC_DTM_DATE,7,2)          = TO_CHAR(ORIG_SERVICE_DATE, 'dd')
-*-*		    AND NOT (    SUBSTR(SVC_DTM_DATE,5,2) = TO_CHAR(ORIG_SERVICE_DATE, 'mm')
-*-*                     AND SUBSTR(SVC_DTM_DATE,7,2) = TO_CHAR(ORIG_SERVICE_DATE, 'dd')))
-*-*	  OR (      SUBSTR(SVC_DTM_DATE,1,4)          = TO_CHAR(ORIG_SERVICE_DATE, 'yyyy')
-*-*	        AND SUBSTR(SVC_DTM_DATE,5,2)          = TO_CHAR(ORIG_SERVICE_DATE, 'mm')
-*-*            AND NOT (    SUBSTR(SVC_DTM_DATE,5,2) = TO_CHAR(ORIG_SERVICE_DATE, 'mm')
-*-*                     AND SUBSTR(SVC_DTM_DATE,7,2) = TO_CHAR(ORIG_SERVICE_DATE, 'dd'))
-*-*            AND NOT (    SUBSTR(SVC_DTM_DATE,1,4) = TO_CHAR(ORIG_SERVICE_DATE, 'yy')
-*-*                     AND SUBSTR(SVC_DTM_DATE,7,2) = TO_CHAR(ORIG_SERVICE_DATE, 'dd'))))
INNER JOIN
      ARPB_TRANSACTIONS  B
ON    B.TX_ID = A.TX_ID
-*  AND B.OUTSTANDING_AMT      >= TO_NUMBER(COALESCE(RTRIM(SVC_LI_PRVDR_PYMT),'0'))
INNER JOIN
      INV_CLM_LN_ADDL    C
ON    C.INVOICE_NUM           = A.INVOICE_NUMBER
  AND C.CHARGE_AMOUNT         = ABS(TO_NUMBER(COALESCE(RTRIM(SVC_ORGLI_PRVDR_PYMT),'0')))
  AND ( C.PROC_OR_REV_CODE    = RTRIM(SVC_PROC1_CD)
      OR RTRIM(SVC_PROC1_CD)  = 'ZZE01' )
  AND C.FROM_SVC_DATE         = TO_DATE(SVC_DTM_DATE,'YYYYMMDD')
-*  AND C.CHARGE_AMOUNT        >= ABS(TO_NUMBER(COALESCE(RTRIM(SVC_ORGLI_PRVDR_PYMT),'0')))
-*-*  AND NOT EXISTS
-*   ( SELECT 1
-*     FROM   INV_CLM_LN_ADDL    Z
-*     WHERE  Z.INVOICE_NUM      = C.INVOICE_NUM
-*       AND  Z.FROM_SVC_DATE    = C.FROM_SVC_DATE
-*       AND  Z.CHARGE_AMOUNT   <> C.CHARGE_AMOUNT )
  AND ((  C.CLAIM_STATUS_C     = 1 )
    OR (  C.CLAIM_STATUS_C    <> 1
          AND NOT EXISTS
           ( SELECT 1
             FROM   CLARITY_TDL_TRAN   X
                   ,INV_CLM_LN_ADDL    Y
             WHERE  X.INT_PAT_ID        = P.PAT_ID
               AND  X.DETAIL_TYPE       = 50
               AND  X.ORIG_SERVICE_DATE = TO_DATE(SVC_DTM_DATE,'YYYYMMDD')
               AND  Y.INVOICE_NUM       = X.INVOICE_NUMBER
               AND  Y.PROC_OR_REV_CODE  = C.PROC_OR_REV_CODE
               AND  Y.CHARGE_AMOUNT     = C.CHARGE_AMOUNT
               AND  Y.CLAIM_STATUS_C    = 1 )))
WHERE ST_EXCL_RSN_CD = '   '
-*ORDER BY 1,2,3,4,5,6,7,8,9,10,11,12
-*ORDER BY 1,2,3,4
;
TABLEF FILE SQLOUT
LIST *
END
-EXIT
SQL
SELECT DISTINCT
      NM1_PT_LST_NM
     ,NM1_PT_FST_NM
     ,SVC_DTM_DATE
     ,CLP_CLM_SUBMTR_ID
     ,C.INVOICE_NUM
-*     ,PAT_LAST_NAME
-*     ,PAT_FIRST_NAME
-*     ,SVC_SEQ_NO
-*     ,C.FROM_SVC_DATE
     ,RTRIM(SVC_PROC1_CD)
     ,PROC_OR_REV_CODE
     ,SVC_ORGLI_PRVDR_PYMT
     ,A.ORIG_PRICE
     ,C.CHARGE_AMOUNT
     ,SVC_LI_PRVDR_PYMT
-*     ,C.INVOICE_NUM
     ,C.CLAIM_STATUS_C
     ,B.OUTSTANDING_AMT
-*     ,SVC_INCL_RSN_CD
-*     ,SVC_ISA_FILE_ID
-*     ,SVC_GS_GRP_SEQ_NO
-*     ,SVC_ST_SEQ_NO
-*     ,SVC_LX_SEQ_NO
-*     ,SVC_CLP_CLM_SEQ_NO
-*     ,SVC_SEQ_NO
-*     ,SVC_EPP_GEN_SEQ
-*     ,A.INT_PAT_ID
-*     ,A.INVOICE_NUMBER
-*     ,CLAIM_STATUS_C
-*     ,SVC_PROC1_CD
-*     ,PROC_OR_REV_CODE
-*     ,SVC_DTM_DATE
-*     ,SVC_ORGLI_PRVDR_PYMT
-*     ,C.CHARGE_AMOUNT
-*     ,SVC_LI_PRVDR_PYMT
FROM  &ST.EVAL&ST_TBL.EVAL
INNER JOIN
      &CLP.EVAL&CLP_TBL.EVAL
ON    CLP_ISA_FILE_ID            = ST_ISA_FILE_ID
  AND CLP_GS_GRP_SEQ_NO          = ST_GS_GRP_SEQ_NO
  AND CLP_ST_SEQ_NO              = ST_SEQ_NO
  AND CLP_EXCL_RSN_CD            = '   '
INNER JOIN
      &SVC.EVAL&SVC_TBL.EVAL
ON    SVC_ISA_FILE_ID            = CLP_ISA_FILE_ID
  AND SVC_GS_GRP_SEQ_NO          = CLP_GS_GRP_SEQ_NO
  AND SVC_ST_SEQ_NO              = CLP_ST_SEQ_NO
  AND SVC_LX_SEQ_NO              = CLP_LX_SEQ_NO
  AND SVC_CLP_CLM_SEQ_NO         = CLP_CLM_SEQ_NO
  AND RTRIM(SVC_CLARITY_TX_ID)   = '0'
  AND SVC_EXCL_RSN_CD            = '   '
  AND TO_NUMBER(COALESCE(RTRIM(SVC_ORGLI_PRVDR_PYMT),'0'))
      = TO_NUMBER(COALESCE(RTRIM(SVC_LI_PRVDR_PYMT),'0'))
LEFT OUTER JOIN
      &SVC_DTM.EVAL&SVC_DTM_TBL.EVAL
ON    SVC_DTM_ISA_FILE_ID        = SVC_ISA_FILE_ID
  AND SVC_DTM_GS_GRP_SEQ_NO      = SVC_GS_GRP_SEQ_NO
  AND SVC_DTM_ST_SEQ_NO          = SVC_ST_SEQ_NO
  AND SVC_DTM_LX_SEQ_NO          = SVC_LX_SEQ_NO
  AND SVC_DTM_CLP_CLM_SEQ_NO     = SVC_CLP_CLM_SEQ_NO
  AND SVC_DTM_SVC_SEQ_NO         = SVC_SEQ_NO
  AND SVC_DTM_DTTM_QLFR          IN( '472','150' )
  AND SVC_DTM_EXCL_RSN_CD        = '   '
INNER JOIN
      &NM1.EVAL&NM1_TBL.EVAL
ON    NM1_ISA_FILE_ID          = CLP_ISA_FILE_ID
  AND NM1_GS_GRP_SEQ_NO        = CLP_GS_GRP_SEQ_NO
  AND NM1_ST_SEQ_NO            = CLP_ST_SEQ_NO
  AND NM1_LX_SEQ_NO            = CLP_LX_SEQ_NO
  AND NM1_CLP_CLM_SEQ_NO       = CLP_CLM_SEQ_NO
  AND INITCAP(RTRIM(NM1_PT_LST_NM)) <> 'Posting'
INNER JOIN
      PATIENT P
ON (  PAT_LAST_NAME            = INITCAP(RTRIM(NM1_PT_LST_NM))
   OR PAT_LAST_NAME            = INITCAP(SUBSTR(RTRIM(NM1_PT_LST_NM), 1, INSTR(RTRIM(NM1_PT_LST_NM), ' ')-1))
   OR PAT_LAST_NAME            = 'Mc'||UPPER(SUBSTR(NM1_PT_LST_NM,3,1))||LOWER(SUBSTR(NM1_PT_LST_NM,4,LENGTH(RTRIM(NM1_PT_LST_NM))-3)))
  AND SUBSTR(PAT_FIRST_NAME,1,2) = SUBSTR(INITCAP(RTRIM(NM1_PT_FST_NM)),1,2)
INNER JOIN
      CLARITY_TDL_TRAN   A
ON    A.INT_PAT_ID             = P.PAT_ID
  AND A.DETAIL_TYPE            = 50
  AND A.ORIG_SERVICE_DATE      = TO_DATE(SVC_DTM_DATE,'YYYYMMDD')
-*    OR  A.ORIG_PRICE           = ABS(TO_NUMBER(COALESCE(RTRIM(SVC_ORGLI_PRVDR_PYMT),'0')))
-*    OR  A.CPT_CODE             = RTRIM(SVC_PROC1_CD))
INNER JOIN
      ARPB_TRANSACTIONS  B
ON    B.TX_ID = A.TX_ID
  AND B.OUTSTANDING_AMT      >= TO_NUMBER(COALESCE(RTRIM(SVC_LI_PRVDR_PYMT),'0'))
INNER JOIN
      INV_CLM_LN_ADDL    C
ON    C.INVOICE_NUM           = A.INVOICE_NUMBER
-*  AND ( C.PROC_OR_REV_CODE    = RTRIM(SVC_PROC1_CD)
-*      OR RTRIM(SVC_PROC1_CD)  = 'ZZE01'
-*      OR C.CHARGE_AMOUNT      = ABS(TO_NUMBER(COALESCE(RTRIM(SVC_ORGLI_PRVDR_PYMT),'0'))))
  AND C.FROM_SVC_DATE         = TO_DATE(SVC_DTM_DATE,'YYYYMMDD')
  AND C.CHARGE_AMOUNT        >= ABS(TO_NUMBER(COALESCE(RTRIM(SVC_ORGLI_PRVDR_PYMT),'0')))
  AND NOT EXISTS
   ( SELECT 1
     FROM   INV_CLM_LN_ADDL    Z
     WHERE  Z.INVOICE_NUM      = C.INVOICE_NUM
       AND  Z.FROM_SVC_DATE    = C.FROM_SVC_DATE
       AND  Z.CHARGE_AMOUNT   <> C.CHARGE_AMOUNT )
  AND C.FROM_SVC_DATE         = TO_DATE(SVC_DTM_DATE,'YYYYMMDD')
  AND C.CHARGE_AMOUNT        >= ABS(TO_NUMBER(COALESCE(RTRIM(SVC_ORGLI_PRVDR_PYMT),'0')))
  AND ((  C.CLAIM_STATUS_C     = 1 )
    OR (  C.CLAIM_STATUS_C    <> 1
          AND NOT EXISTS
           ( SELECT 1
             FROM   CLARITY_TDL_TRAN   X
                   ,INV_CLM_LN_ADDL    Y
             WHERE  X.INT_PAT_ID        = P.PAT_ID
               AND  X.DETAIL_TYPE       = 50
               AND  X.ORIG_SERVICE_DATE = TO_DATE(SVC_DTM_DATE,'YYYYMMDD')
               AND  Y.INVOICE_NUM       = X.INVOICE_NUMBER
               AND  Y.PROC_OR_REV_CODE  = C.PROC_OR_REV_CODE
               AND  Y.CHARGE_AMOUNT     = C.CHARGE_AMOUNT
               AND  Y.CLAIM_STATUS_C    = 1 )))
WHERE ST_EXCL_RSN_CD = '   '
-*ORDER BY 1,2,3,4,5,6,7,8,9,10,11,12
ORDER BY 1,2,3,5
;
TABLEF FILE SQLOUT
LIST *
END
-EXIT
SQL
SELECT
      CLP_ISA_FILE_ID
     ,CLP_GS_GRP_SEQ_NO
     ,CLP_ST_SEQ_NO
     ,CLP_LX_SEQ_NO
     ,CLP_CLM_SEQ_NO
     ,CLP_EPP_GEN_SEQ
-*     ,PAT_LAST_NAME
-*     ,PAT_FIRST_NAME
-*     ,RTRIM(CLP_CLM_SUBMTR_ID)   AS INVOICE
-*     ,A.TX_ID
-*     ,A.ORIG_SERVICE_DATE
-*     ,A.CPT_CODE
     ,CLP_TOT_CLM_CRG_AMT
     ,SUM(CLP_CLM_PYMT_AMT)
-*     ,A.ORIG_PRICE
-*     ,A.BILL_CLAIM_AMOUNT
     ,SUM(B.OUTSTANDING_AMT)
FROM  &ST.EVAL&ST_TBL.EVAL
INNER JOIN
      &CLP.EVAL&CLP_TBL.EVAL
ON    CLP_ISA_FILE_ID            = ST_ISA_FILE_ID
  AND CLP_GS_GRP_SEQ_NO          = ST_GS_GRP_SEQ_NO
  AND CLP_ST_SEQ_NO              = ST_SEQ_NO
  AND CLP_EXCL_RSN_CD            = '   '
  AND (  SUBSTR(CLP_CLM_SUBMTR_ID,1,2) = '99'
      OR RTRIM(CLP_CLM_SUBMTR_ID) IS NULL )
INNER JOIN
      &NM1.EVAL&NM1_TBL.EVAL
ON    NM1_ISA_FILE_ID          = CLP_ISA_FILE_ID
  AND NM1_GS_GRP_SEQ_NO        = CLP_GS_GRP_SEQ_NO
  AND NM1_ST_SEQ_NO            = CLP_ST_SEQ_NO
  AND NM1_LX_SEQ_NO            = CLP_LX_SEQ_NO
  AND NM1_CLP_CLM_SEQ_NO       = CLP_CLM_SEQ_NO
INNER JOIN
      PATIENT P
ON (  PAT_LAST_NAME            = INITCAP(RTRIM(NM1_PT_LST_NM))
   OR PAT_LAST_NAME            = 'Mc'||UPPER(SUBSTR(NM1_PT_LST_NM,3,1))||LOWER(SUBSTR(NM1_PT_LST_NM,4,LENGTH(RTRIM(NM1_PT_LST_NM))-3)))
  AND PAT_FIRST_NAME           = INITCAP(RTRIM(NM1_PT_FST_NM))
INNER JOIN
      CLARITY_TDL_TRAN  A
ON    A.INT_PAT_ID             = P.PAT_ID
  AND A.DETAIL_TYPE            = 1
  AND A.ORIG_PRICE             = ABS(TO_NUMBER(COALESCE(RTRIM(CLP_TOT_CLM_CRG_AMT),'0')))
INNER JOIN
      ARPB_TRANSACTIONS B
ON    B.TX_ID                  = A.TX_ID
  AND B.VOID_DATE              IS NULL
-*  AND B.OUTSTANDING_AMT       <> 0
WHERE NOT EXISTS
    ( SELECT 1
      FROM  &SVC.EVAL&SVC_TBL.EVAL
      WHERE SVC_ISA_FILE_ID    = CLP_ISA_FILE_ID
        AND SVC_GS_GRP_SEQ_NO  = CLP_GS_GRP_SEQ_NO
        AND SVC_ST_SEQ_NO      = CLP_ST_SEQ_NO
        AND SVC_LX_SEQ_NO      = CLP_LX_SEQ_NO
        AND SVC_CLP_CLM_SEQ_NO = CLP_CLM_SEQ_NO
        AND SVC_EXCL_RSN_CD    = '   ' )
GROUP BY
      CLP_ISA_FILE_ID
     ,CLP_GS_GRP_SEQ_NO
     ,CLP_ST_SEQ_NO
     ,CLP_LX_SEQ_NO
     ,CLP_CLM_SEQ_NO
     ,CLP_EPP_GEN_SEQ
     ,CLP_TOT_CLM_CRG_AMT
HAVING SUM(CLP_CLM_PYMT_AMT)   = 0
  AND  SUM(B.OUTSTANDING_AMT)  = 0
;
END
-EXIT
SQL
SELECT *
FROM  PATIENT P
INNER JOIN
      CLARITY_TDL_TRAN  A
ON    A.INT_PAT_ID             = P.PAT_ID
-*  AND A.ORIG_PRICE             IN(456,451)
  AND A.DETAIL_TYPE            = 50
INNER JOIN
      ARPB_TRANSACTIONS B
ON    B.TX_ID                  = A.TX_ID
  AND B.OUTSTANDING_AMT       <> 0
-*  AND A.ORIG_SERVICE_DATE      = DOS
-*  AND A.CPT_CODE               = CPT
-*  AND A.ORIG_PRICE             = ABS(PRICE)
-*  AND A.DETAIL_TYPE            = '50'
-*  AND A.INVOICE_NUMBER         = ( SELECT MAX(INVOICE_NUMBER)
-*                                   FROM   CLARITY_TDL_TRAN  C
-*                                         ,ARPB_TRANSACTIONS D
-*                                   WHERE  C.INT_PAT_ID        = T1.PAT_ID
-*                                     AND  C.DETAIL_TYPE       = '50'
-*                                     AND  C.ORIG_SERVICE_DATE = DOS
-*                                     AND  C.CPT_CODE          = CPT
-*                                     AND  C.ORIG_PRICE        = ABS(PRICE)
-*                                     AND  C.TX_ID             = D.TX_ID
-*                                     AND  D.VOID_DATE         IS NULL )
WHERE PAT_LAST_NAME  = 'Brownstone'
  AND PAT_FIRST_NAME = 'Rebecca'
  AND ( A.ORIG_PRICE             IN(456,451)
     OR B.OUTSTANDING_AMT        IN(456,451)
     OR A.BILL_CLAIM_AMOUNT      IN(456,451))
;
END
-EXIT
-*SELECT
-*      COALESCE(RTRIM(CLP_CLM_SUBMTR_ID),'999999999')
-*                                             AS CLP_CLM_SUBMTR_ID
-*     ,TO_DATE(SVC_DTM_DATE, 'YYYYMMDD')      AS DOS
-*     ,RTRIM(SVC_PROC1_CD)                    AS CPT
-*     ,TO_NUMBER(COALESCE(RTRIM(SVC_ORGLI_PRVDR_PYMT),'0'))
-*                                             AS PRICE
-*     ,P.PAT_ID
-*     ,PAT_LAST_NAME
-*     ,PAT_FIRST_NAME
-*FROM  &ST.EVAL&ST_TBL.EVAL
-*INNER JOIN
-*      &CLP.EVAL&CLP_TBL.EVAL
-*ON    CLP_ISA_FILE_ID          = ST_ISA_FILE_ID
-*  AND CLP_GS_GRP_SEQ_NO        = ST_GS_GRP_SEQ_NO
-*  AND CLP_ST_SEQ_NO            = ST_SEQ_NO
-*  AND CLP_EXCL_RSN_CD          = '   '
-*  AND NOT EXISTS
-*( SELECT 1
-*  FROM  CLARITY_TDL_TRAN
-*  WHERE INVOICE_NUMBER         = RTRIM(CLP_CLM_SUBMTR_ID)
-*    AND SUBSTR(CLP_CLM_SUBMTR_ID,1,1) = 'P' )
-*  AND NOT EXISTS
-*( SELECT 1
-*  FROM &CLP_CAS.EVAL&CLP_CAS_TBL.EVAL
-*  WHERE CLP_CAS_ISA_FILE_ID    = CLP_ISA_FILE_ID
-*    AND CLP_CAS_GS_GRP_SEQ_NO  = CLP_GS_GRP_SEQ_NO
-*    AND CLP_CAS_ST_SEQ_NO      = CLP_ST_SEQ_NO
-*    AND CLP_CAS_LX_SEQ_NO      = CLP_LX_SEQ_NO
-*    AND CLP_CAS_CLP_CLM_SEQ_NO = CLP_CLM_SEQ_NO
-*    AND CLP_CAS_EXCL_RSN_CD    = '   ' )
-*INNER JOIN
-*      &SVC.EVAL&SVC_TBL.EVAL
-*ON    SVC_ISA_FILE_ID          = CLP_ISA_FILE_ID
-*  AND SVC_GS_GRP_SEQ_NO        = CLP_GS_GRP_SEQ_NO
-*  AND SVC_ST_SEQ_NO            = CLP_ST_SEQ_NO
-*  AND SVC_LX_SEQ_NO            = CLP_LX_SEQ_NO
-*  AND SVC_CLP_CLM_SEQ_NO       = CLP_CLM_SEQ_NO
-*  AND SVC_CLARITY_TX_ID        = 0
-*  AND SVC_EXCL_RSN_CD          = '   '
-*INNER JOIN
-*      &SVC_DTM.EVAL&SVC_DTM_TBL.EVAL
-*ON    SVC_DTM_ISA_FILE_ID      = SVC_ISA_FILE_ID
-*  AND SVC_DTM_GS_GRP_SEQ_NO    = SVC_GS_GRP_SEQ_NO
-*  AND SVC_DTM_ST_SEQ_NO        = SVC_ST_SEQ_NO
-*  AND SVC_DTM_LX_SEQ_NO        = SVC_LX_SEQ_NO
-*  AND SVC_DTM_CLP_CLM_SEQ_NO   = SVC_CLP_CLM_SEQ_NO
-*  AND SVC_DTM_SVC_SEQ_NO       = SVC_SEQ_NO
-*  AND SVC_DTM_DTTM_QLFR        IN( '472','150' )
-*  AND SVC_DTM_EXCL_RSN_CD      = '   '
-*INNER JOIN
-*      &NM1.EVAL&NM1_TBL.EVAL
-*ON    NM1_ISA_FILE_ID          = CLP_ISA_FILE_ID
-*  AND NM1_GS_GRP_SEQ_NO        = CLP_GS_GRP_SEQ_NO
-*  AND NM1_ST_SEQ_NO            = CLP_ST_SEQ_NO
-*  AND NM1_LX_SEQ_NO            = CLP_LX_SEQ_NO
-*  AND NM1_CLP_CLM_SEQ_NO       = CLP_CLM_SEQ_NO
SQL
SELECT *
      PATIENT P
WHERE PAT_LAST_NAME = 'Brownstone'
;
END
-EXIT
ON (  PAT_LAST_NAME            = INITCAP(RTRIM(NM1_PT_LST_NM))
   OR PAT_LAST_NAME            = 'Mc'||UPPER(SUBSTR(NM1_PT_LST_NM,3,1))||LOWER(SUBSTR(NM1_PT_LST_NM,4,LENGTH(RTRIM(NM1_PT_LST_NM))-3)))
  AND PAT_FIRST_NAME           = INITCAP(RTRIM(NM1_PT_FST_NM))
WHERE ST_EXCL_RSN_CD           = '   '
ORDER BY 1
-*) T1
-*INNER JOIN
-*      CLARITY_TDL_TRAN A
-*ON    A.INT_PAT_ID             = T1.PAT_ID
-*  AND A.ORIG_SERVICE_DATE      = DOS
-*  AND A.CPT_CODE               = CPT
-*  AND A.ORIG_PRICE             = ABS(PRICE)
-*  AND A.DETAIL_TYPE            = '50'
-*  AND A.INVOICE_NUMBER         = ( SELECT MAX(INVOICE_NUMBER)
-*                                   FROM   CLARITY_TDL_TRAN  C
-*                                         ,ARPB_TRANSACTIONS D
-*                                   WHERE  C.INT_PAT_ID        = T1.PAT_ID
-*                                     AND  C.DETAIL_TYPE       = '50'
-*                                     AND  C.ORIG_SERVICE_DATE = DOS
-*                                     AND  C.CPT_CODE          = CPT
-*                                     AND  C.ORIG_PRICE        = ABS(PRICE)
-*                                     AND  C.TX_ID             = D.TX_ID
-*                                     AND  D.VOID_DATE         IS NULL )
-*INNER JOIN
-*      ARPB_TRANSACTIONS B
-*ON    B.TX_ID                  = A.TX_ID
-*  AND B.VOID_DATE                IS NULL
-*GROUP BY
-*      CLP_CLM_SUBMTR_ID
-*     ,DOS
-*     ,CPT
-*     ,PRICE
-*     ,A.ORIG_PRICE
-*     ,A.TX_ID
-*     ,A.INVOICE_NUMBER
-*     ,B.OUTSTANDING_AMT
SQL
SELECT
      RTRIM(CLP_CLM_SUBMTR_ID)   AS INVOICE
     ,A.PATIENT_ID
FROM  &ST.EVAL&ST_TBL.EVAL
INNER JOIN
      &CLP.EVAL&CLP_TBL.EVAL
ON    CLP_ISA_FILE_ID            = ST_ISA_FILE_ID
  AND CLP_GS_GRP_SEQ_NO          = ST_GS_GRP_SEQ_NO
  AND CLP_ST_SEQ_NO              = ST_SEQ_NO
  AND CLP_EXCL_RSN_CD            = '   '
INNER JOIN
      &SVC.EVAL&SVC_TBL.EVAL
ON    SVC_ISA_FILE_ID            = CLP_ISA_FILE_ID
  AND SVC_GS_GRP_SEQ_NO          = CLP_GS_GRP_SEQ_NO
  AND SVC_ST_SEQ_NO              = CLP_ST_SEQ_NO
  AND SVC_LX_SEQ_NO              = CLP_LX_SEQ_NO
  AND SVC_CLP_CLM_SEQ_NO         = CLP_CLM_SEQ_NO
  AND RTRIM(SVC_CLARITY_TX_ID)  <> '0'
  AND SVC_EXCL_RSN_CD            = '   '
INNER JOIN
      ARPB_TRANSACTIONS A
ON    A.TX_ID                   = SVC_CLARITY_TX_ID
  AND A.VOID_DATE               IS NOT NULL
INNER JOIN
      CLARITY_TDL_TRAN  B
ON    B.INT_PAT_ID              = A.PATIENT_ID
  AND B.ORIG_SERVICE_DATE       = A.SERVICE_DATE
  AND B.DETAIL_TYPE             = 1
  AND B.CPT_CODE                = A.CPT_CODE
  AND B.TX_ID                  <> A.TX_ID
INNER JOIN
      ARPB_TRANSACTIONS C
ON    C.TX_ID                   = B.TX_ID
  AND C.VOID_DATE               IS NULL
  AND NOT EXISTS
  ( SELECT 1
    FROM   CLARITY_TDL_TRAN X
    WHERE  X.TX_ID              = C.TX_ID
      AND  X.DETAIL_TYPE        = 50 )
WHERE ST_EXCL_RSN_CD            = '   '
;
TABLEF FILE SQLOUT
LIST *
-*ON TABLE HOLD
END
-RUN
-TYPE &RECORDS.EVAL
-EXIT
SQL
SELECT INVOICE_NUMBER
FROM   CLARITY_TDL_TRAN
WHERE  TX_ID = 48048734
;
END
-EXIT
SQL
SELECT B.TX_ID
      ,B.OUTSTANDING_AMT
FROM  CLARITY_TDL_TRAN  A
INNER JOIN
      ARPB_TRANSACTIONS B
ON    B.TX_ID             = A.TX_ID
  AND B.VOID_DATE         IS NULL
-*INNER JOIN
-*      CLARITY_TDL_TRAN  C
-*ON    C.TX_ID = A.TX_ID
-*  AND C.DETAIL_TYPE = 50
WHERE A.INT_PAT_ID        = 'Z1988824'
  AND A.ORIG_SERVICE_DATE = '10 AUG 2015'
  AND A.DETAIL_TYPE       = 1
  AND A.CPT_CODE          = '97140'
;
END
-EXIT
R_NEW_CHG_TX_ID
SQL
SELECT *
-*CLP_CLM_SUBMTR_ID
-*      ,SVC_ORGLI_PRVDR_PYMT
-*      ,SVC_PROC1_CD
-*      ,SVC_INCL_RSN_CD
-*      ,B.INVOICE_NUMBER
-*      ,B.ORIG_PRICE
-*      ,C.OUTSTANDING_AMT
-*      ,C.BILL_CLAIM_AMT
-*      ,C.CPT_CODE P1061565861
-*      ,VOID_DATE
FROM   &CLP.EVAL&CLP_TBL.EVAL
INNER JOIN
       &SVC.EVAL&SVC_TBL.EVAL
ON     SVC_ISA_FILE_ID    = CLP_ISA_FILE_ID
   AND SVC_GS_GRP_SEQ_NO  = CLP_GS_GRP_SEQ_NO
   AND SVC_ST_SEQ_NO      = CLP_ST_SEQ_NO
   AND SVC_LX_SEQ_NO      = CLP_LX_SEQ_NO
   AND SVC_CLP_CLM_SEQ_NO = CLP_CLM_SEQ_NO
   AND SVC_EXCL_RSN_CD    = '   '
INNER JOIN
      &SVC_DTM.EVAL&SVC_DTM_TBL.EVAL
ON    SVC_DTM_ISA_FILE_ID        = SVC_ISA_FILE_ID
  AND SVC_DTM_GS_GRP_SEQ_NO      = SVC_GS_GRP_SEQ_NO
  AND SVC_DTM_ST_SEQ_NO          = SVC_ST_SEQ_NO
  AND SVC_DTM_LX_SEQ_NO          = SVC_LX_SEQ_NO
  AND SVC_DTM_CLP_CLM_SEQ_NO     = SVC_CLP_CLM_SEQ_NO
  AND SVC_DTM_SVC_SEQ_NO         = SVC_SEQ_NO
  AND SVC_DTM_DTTM_QLFR          IN( '472','150' )
  AND SVC_DTM_EXCL_RSN_CD        = '   '
WHERE RTRIM(CLP_CLM_SUBMTR_ID)   = 'P1064172660'
  AND CLP_EXCL_RSN_CD            = '   '
;
END
-EXIT
-*INNER JOIN
-*      CLARITY_TDL_TRAN A
-*ON    A.INVOICE_NUMBER           = RTRIM(CLP_CLM_SUBMTR_ID)
-*  AND A.ORIG_SERVICE_DATE        = TO_DATE(SVC_DTM_DATE, 'YYYYMMDD')
-*  AND A.CPT_CODE                 = RTRIM(SVC_PROC1_CD)
-*-*  AND COALESCE(A.MODIFIER_ONE, '  ') = SVC_PROC1_MODF1
-*  AND A.DETAIL_TYPE              = '50'
-*INNER JOIN
-*       CLARITY_TDL_TRAN B
-*ON     B.TX_ID    = A.TX_ID
-*  AND B.DETAIL_TYPE = 10
-*  AND B.R_NEW_CHG_TX_ID IS NOT NULL
-*INNER JOIN
-*       CLARITY_TDL_TRAN B
-*ON     B.TX_ID  =  A.R_NEW_CHG_TX_ID
-*  AND  B.DETAIL_TYPE = 50
-*INNER JOIN
-*       ARPB_TRANSACTIONS C
-*ON     C.TX_ID       = B.TX_ID
-*WHERE  SVC_CRG_IS_VOID_YN = 'Y'
-*WHERE CLP_CLM_STATUS_CD         <> '22'
-*  AND SUBSTR(CLP_CLM_SUBMTR_ID,1,1) = 'P'
-*  AND CLP_EXCL_RSN_CD = '   '
;
TABLEF FILE SQLOUT
LIST *
END
-EXIT
-*SQL
-*SELECT *
-*FROM CLARITY_TDL_TRAN
-*WHERE INVOICE_NUMBER = 'P1072285880'
-*;
-*END
-*-EXIT
SQL
SELECT *
FROM EDP_PROC_CAT_INFO
WHERE ROWNUM < 101
;
END
-EXIT
SQL
SELECT *
FROM   CLARITY_TDL_TRAN
WHERE INVOICE_NUMBER = '1082842'
;
END
-EXIT
SQL
SELECT *
FROM   &SVC.EVAL&SVC_TBL.EVAL
WHERE  SVC_ORGLI_PRVDR_PYMT = -852
;
END
-EXIT
SVC*HC:88341*-852*0***HC:88341:26*12~
SQL
SELECT *
FROM   &CLP.EVAL&CLP_TBL.EVAL
WHERE CLP_EXCL_RSN_CD = 'DI1'
;
END
-EXIT
SQL
SELECT *
FROM   &SVC.EVAL&SVC_TBL.EVAL
WHERE  SVC_INCL_RSN_CD = 'DI1'
;
END
-EXIT
SQL
SELECT *
FROM CLARITY_EAP
WHERE PROC_CODE = '99386'
;
END
-EXIT
-*SQL
-*SELECT *
-*FROM   PATIENT X
-*INNER JOIN
-*      CLARITY_TDL_TRAN A
-*ON    A.INT_PAT_ID             = X.PAT_ID
-*  AND A.ORIG_SERVICE_DATE      = '29 APR 2015'
-*-*  AND A.CPT_CODE               = '99283'
-*-*  AND A.ORIG_PRICE             = 212
-*  AND A.DETAIL_TYPE            = '50'
-*WHERE  PAT_LAST_NAME = 'Narayanam'
-*;
-*END
-*-EXIT
SQL
SELECT
      CLP_ISA_FILE_ID
     ,CLP_GS_GRP_SEQ_NO
     ,CLP_ST_SEQ_NO
     ,CLP_LX_SEQ_NO
     ,CLP_CLM_SEQ_NO
     ,CHECK_AMT
     ,CHECK_PMT_TOT
     ,TO_NUMBER(COALESCE(RTRIM(CLP_CLM_PYMT_AMT),'0'))       AS CLP_PMT_AMT
     ,SUM(TO_NUMBER(COALESCE(RTRIM(SVC_LI_PRVDR_PYMT),'0'))) AS SVC_PMT_AMT
FROM
(
SELECT
      ST_ISA_FILE_ID
     ,ST_GS_GRP_SEQ_NO
     ,ST_SEQ_NO
     ,TO_NUMBER(COALESCE(RTRIM(BPR_CHK_AMT),'0'))            AS CHECK_AMT
     ,SUM(TO_NUMBER(COALESCE(RTRIM(CLP_CLM_PYMT_AMT),'0')))  AS CHECK_PMT_TOT
FROM  &ST.EVAL&ST_TBL.EVAL
INNER JOIN
      &BPR.EVAL&BPR_TBL.EVAL
ON    BPR_ISA_FILE_ID    = ST_ISA_FILE_ID
  AND BPR_GS_GRP_SEQ_NO  = ST_GS_GRP_SEQ_NO
  AND BPR_ST_SEQ_NO      = ST_SEQ_NO
INNER JOIN
      &CLP.EVAL&CLP_TBL.EVAL
ON    CLP_ISA_FILE_ID    = ST_ISA_FILE_ID
  AND CLP_GS_GRP_SEQ_NO  = ST_GS_GRP_SEQ_NO
  AND CLP_ST_SEQ_NO      = ST_SEQ_NO
  AND CLP_EXCL_RSN_CD    = '   '
  AND SUBSTR(CLP_CLM_SUBMTR_ID,1,1) = 'P'
WHERE ST_EXCL_RSN_CD     = '   '
GROUP BY
      ST_ISA_FILE_ID
     ,ST_GS_GRP_SEQ_NO
     ,ST_SEQ_NO
     ,TO_NUMBER(COALESCE(RTRIM(BPR_CHK_AMT),'0'))
)
INNER JOIN
      &CLP.EVAL&CLP_TBL.EVAL
ON    CLP_ISA_FILE_ID    = ST_ISA_FILE_ID
  AND CLP_GS_GRP_SEQ_NO  = ST_GS_GRP_SEQ_NO
  AND CLP_ST_SEQ_NO      = ST_SEQ_NO
  AND CLP_EXCL_RSN_CD    = '   '
  AND SUBSTR(CLP_CLM_SUBMTR_ID,1,1) = 'P'
INNER JOIN
      &SVC.EVAL&SVC_TBL.EVAL
ON    SVC_ISA_FILE_ID    = CLP_ISA_FILE_ID
  AND SVC_GS_GRP_SEQ_NO  = CLP_GS_GRP_SEQ_NO
  AND SVC_ST_SEQ_NO      = CLP_ST_SEQ_NO
  AND SVC_LX_SEQ_NO      = CLP_LX_SEQ_NO
  AND SVC_CLP_CLM_SEQ_NO = CLP_CLM_SEQ_NO
  AND SVC_EXCL_RSN_CD    = '   '
GROUP BY
      CLP_ISA_FILE_ID
     ,CLP_GS_GRP_SEQ_NO
     ,CLP_ST_SEQ_NO
     ,CLP_LX_SEQ_NO
     ,CLP_CLM_SEQ_NO
     ,CHECK_AMT
     ,CHECK_PMT_TOT
     ,TO_NUMBER(COALESCE(RTRIM(CLP_CLM_PYMT_AMT),'0'))
ORDER BY 1,2,3,4,5,6
;
TABLEF FILE SQLOUT
LIST *
END
-EXIT
SQL
SELECT *
FROM CLARITY_EPM
ORDER BY 2
-*WHERE  ROWNUM < 2
;
END
-EXIT
SQL
SELECT *
FROM   CLARITY_EAP A
INNER JOIN
      CLARITY_EAP_ALTCOD AC
ON    AC.PROC_ID                 = A.PROC_ID
-*  AND AC.EPM_ALT_IDFR            IN('BC','CPUS','MCAL','MCR')
-*  AND AC.PROC_ALT_IDFR           = RTRIM(SVC_PROC1_CD)
WHERE  PROC_CODE = 'Q4038'
;
END
-EXIT
SQL
SELECT *
FROM   CLARITY_TDL_TRAN  A
INNER JOIN
       ARPB_TRANSACTIONS B
ON     B.TX_ID = A.TX_ID
WHERE  INVOICE_NUMBER = 'P1064775900'
;
END
-EXIT
SQL
SELECT *
-*CLP_CLM_SUBMTR_ID
-*      ,SVC_ORGLI_PRVDR_PYMT
-*      ,SVC_PROC1_CD
-*      ,SVC_INCL_RSN_CD
-*      ,B.INVOICE_NUMBER
-*      ,B.ORIG_PRICE
-*      ,C.OUTSTANDING_AMT
-*      ,C.BILL_CLAIM_AMT
-*      ,C.CPT_CODE P1061565861
-*      ,VOID_DATE
FROM   &CLP.EVAL&CLP_TBL.EVAL
-*WHERE  CLP_CL_TX_MATCH_TYPE   = 'CL1'
-*-*  AND  CLP_CLM_STATUS_CD    = '22'
-*-*  AND NOT EXISTS
-*-*    ( SELECT 1
-*-*      FROM  &SVC.EVAL&SVC_TBL.EVAL
-*-*      WHERE SVC_ISA_FILE_ID     = CLP_ISA_FILE_ID
-*-*        AND SVC_GS_GRP_SEQ_NO   = CLP_GS_GRP_SEQ_NO
-*-*        AND SVC_ST_SEQ_NO       = CLP_ST_SEQ_NO
-*-*        AND SVC_LX_SEQ_NO       = CLP_LX_SEQ_NO
-*-*        AND SVC_CLP_CLM_SEQ_NO  = CLP_CLM_SEQ_NO
-*-*        AND SVC_EXCL_RSN_CD     = '   ' )
-*-*INNER JOIN
-*-*      &CLP_CAS.EVAL&CLP_CAS_TBL.EVAL
-*-*ON    CLP_CAS_ISA_FILE_ID    = CLP_ISA_FILE_ID
-*-*  AND CLP_CAS_GS_GRP_SEQ_NO  = CLP_GS_GRP_SEQ_NO
-*-*  AND CLP_CAS_ST_SEQ_NO      = CLP_ST_SEQ_NO
-*-*  AND CLP_CAS_LX_SEQ_NO      = CLP_LX_SEQ_NO
-*-*  AND CLP_CAS_CLP_CLM_SEQ_NO = CLP_CLM_SEQ_NO
-*-*INNER JOIN
       &SVC.EVAL&SVC_TBL.EVAL
ON     SVC_ISA_FILE_ID    = CLP_ISA_FILE_ID
   AND SVC_GS_GRP_SEQ_NO  = CLP_GS_GRP_SEQ_NO
   AND SVC_ST_SEQ_NO      = CLP_ST_SEQ_NO
   AND SVC_LX_SEQ_NO      = CLP_LX_SEQ_NO
   AND SVC_CLP_CLM_SEQ_NO = CLP_CLM_SEQ_NO
INNER JOIN
      &SVC_CAS.EVAL&SVC_CAS_TBL.EVAL
ON    SVC_CAS_ISA_FILE_ID    = SVC_ISA_FILE_ID
  AND SVC_CAS_GS_GRP_SEQ_NO  = SVC_GS_GRP_SEQ_NO
  AND SVC_CAS_ST_SEQ_NO      = SVC_ST_SEQ_NO
  AND SVC_CAS_LX_SEQ_NO      = SVC_LX_SEQ_NO
  AND SVC_CAS_CLP_CLM_SEQ_NO = SVC_CLP_CLM_SEQ_NO
  AND SVC_CAS_SVC_SEQ_NO     = SVC_SEQ_NO
-*  AND CLP_CAS_EXCL_RSN_CD    = 'CL3'
-*   AND RTRIM(SVC_CLARITY_TX_ID)  = '27618540'
-*   AND SVC_EXCL_RSN_CD    = '   '
WHERE RTRIM(CLP_CLM_SUBMTR_ID) = 'P1023134155'
-*INNER JOIN
-*      &SVC_DTM.EVAL&SVC_DTM_TBL.EVAL
-*ON    SVC_DTM_ISA_FILE_ID        = SVC_ISA_FILE_ID
-*  AND SVC_DTM_GS_GRP_SEQ_NO      = SVC_GS_GRP_SEQ_NO
-*  AND SVC_DTM_ST_SEQ_NO          = SVC_ST_SEQ_NO
-*  AND SVC_DTM_LX_SEQ_NO          = SVC_LX_SEQ_NO
-*  AND SVC_DTM_CLP_CLM_SEQ_NO     = SVC_CLP_CLM_SEQ_NO
-*  AND SVC_DTM_SVC_SEQ_NO         = SVC_SEQ_NO
-*  AND SVC_DTM_DTTM_QLFR          IN( '472','150' )
-*  AND SVC_DTM_EXCL_RSN_CD        = '   '
-*INNER JOIN
-*      CLARITY_TDL_TRAN A
-*ON    A.INVOICE_NUMBER           = RTRIM(CLP_CLM_SUBMTR_ID)
-*  AND A.ORIG_SERVICE_DATE        = TO_DATE(SVC_DTM_DATE, 'YYYYMMDD')
-*  AND A.CPT_CODE                 = RTRIM(SVC_PROC1_CD)
-*-*  AND COALESCE(A.MODIFIER_ONE, '  ') = SVC_PROC1_MODF1
-*  AND A.DETAIL_TYPE              = '50'
-*INNER JOIN
-*       CLARITY_TDL_TRAN B
-*ON     B.TX_ID    = A.TX_ID
-*  AND B.DETAIL_TYPE = 10
-*  AND B.R_NEW_CHG_TX_ID IS NOT NULL
-*INNER JOIN
-*       CLARITY_TDL_TRAN B
-*ON     B.TX_ID  =  A.R_NEW_CHG_TX_ID
-*  AND  B.DETAIL_TYPE = 50
-*INNER JOIN
-*       ARPB_TRANSACTIONS C
-*ON     C.TX_ID       = B.TX_ID
-*WHERE  SVC_CRG_IS_VOID_YN = 'Y'
-*WHERE CLP_CLM_STATUS_CD         <> '22'
-*  AND SUBSTR(CLP_CLM_SUBMTR_ID,1,1) = 'P'
-*  AND CLP_EXCL_RSN_CD = '   '
;
TABLEF FILE SQLOUT
LIST *
END
-EXIT
SQL
SELECT
       B.OUTSTANDING_AMT
FROM   CLARITY_TDL_TRAN A
INNER JOIN
      ARPB_TRANSACTIONS B
ON    B.TX_ID = A.TX_ID
-*WHERE RTRIM(CLP_CLM_SUBMTR_ID) =
-*  AND A.ORIG_SERVICE_DATE        = TO_DATE(SVC_DTM_DATE, 'YYYYMMDD')
-*  AND A.CPT_CODE                 = RTRIM(SVC_PROC1_CD)
-*-*  AND COALESCE(A.MODIFIER_ONE, '  ') = SVC_PROC1_MODF1
-*  AND A.DETAIL_TYPE              = '50'
-*INNER JOIN
-*       CLARITY_TDL_TRAN B
-*ON     B.TX_ID    = A.TX_ID
-*  AND B.DETAIL_TYPE = 10
-*  AND B.R_NEW_CHG_TX_ID IS NOT NULL
-*INNER JOIN
-*       CLARITY_TDL_TRAN B
-*ON     B.TX_ID  =  A.R_NEW_CHG_TX_ID
-*  AND  B.DETAIL_TYPE = 50
-*INNER JOIN
-*       ARPB_TRANSACTIONS C
-*ON     C.TX_ID       = B.TX_ID
-*WHERE  SVC_CRG_IS_VOID_YN = 'Y'
-*WHERE CLP_CLM_STATUS_CD         <> '22'
-*  AND SUBSTR(CLP_CLM_SUBMTR_ID,1,1) = 'P'
-*  AND CLP_EXCL_RSN_CD = '   '
WHERE  A.INVOICE_NUMBER           = 'P1065162650'
;
TABLEF FILE SQLOUT
LIST *
END
-EXIT
SQL
SELECT *
FROM   EPP_BAL_SCENARIOS
;
END
-EXIT
SQL
-*CREATE MATERIALIZED VIEW UCLA.MV_PB_CHARGE_DETAIL_TEST (TDL_ID,TX_ID,TX_NUM,DETAIL_TYPE,TX_TYPE,FIN_DIV_ID,DIV,FIN_SUBDIV_ID,SUB_DIV,BILL_AREA_ID,BILL_AREA,REFERRING_PROV_ID,REFERRING_PROV_NAME,BILLING_PROVIDER_ID,PROV_NAME,SERV_PROV_ID,SERV_PROV_NAME,VISIT_PROV_ID,VISIT_PROV_NAME,RESOURCE_FLAG,PAT_ID,PAT_MRN_ID,PAT_NAME,BIRTH_DATE,AGE_AT_DOS,ACCOUNT_ID,GUAR_NAME,ACCOUNT_TYPE_C,ACCOUNT_TYPE,SERVICE_DATE,POST_DATE,PROC_CODE,CPT_CODE,ALT_CODE,PROC_NAME,DX_1,DX_ID_1,DX_2,DX_ID_2,DX_3,DX_ID_3,DX_4,DX_ID_4,DX_5,DX_ID_5,DX_6,DX_ID_6,DX_CODES,MOD_1,MOD_2,MOD_3,MOD_4,MODIFIERS,UCLA_FIN_CLASS,ORIG_COVERAGE_ID,ORIG_PAYOR_ID,ORIG_PAYOR,ORIG_BENEFIT_PLAN_ID,ORIG_PLAN,ORIG_PRODUCT_TYPE,CUR_RESPON_PAYOR_ID,CUR_RESPON_PAYOR,SERV_AREA_ID,SERV_AREA_NAME,POS_ID,POS_NAME,PLACE,POS_TYPE,LOC_ID,LOC_NAME,DEPARTMENT_ID,DEPARTMENT,INVOICE_NUMBER,CHARGES,PAYMENTS,ADJUSTMENTS,OUTSTANDING,QTY,RBRVS,PMT_RBRVS_PCT,RVU_WORK,VOID_YN,VOID_DATE,REPOST_ETR_ID,ZERO_BALANCE_YN,REMITTANCE,PRIMARY_CHG,TRANSPLANT_ORGAN,PAT_ENC_CSN_ID,HSP_ACCOU_ID)
-*TABLESPACE UCLA
-*PCTUSED    0
-*PCTFREE    10
-*INITRANS   2
-*MAXTRANS   255
-*STORAGE    (
-*            INITIAL          64K
-*            NEXT             1M
-*            MINEXTENTS       1
-*            MAXEXTENTS       UNLIMITED
-*            PCTINCREASE      0
-*            BUFFER_POOL      DEFAULT
-*            FLASH_CACHE      DEFAULT
-*            CELL_FLASH_CACHE DEFAULT
-*           )
-*NOCACHE
-*NOLOGGING
-*NOCOMPRESS
-*PARALLEL ( DEGREE 12 INSTANCES 1 )
-*BUILD IMMEDIATE
-*REFRESH FORCE ON DEMAND
-*WITH PRIMARY KEY
-*AS
-*/* Formatted on 4/8/2015 7:48:48 PM (QP5 v5.227.12220.39724) */
SELECT
      tdl.tdl_id,
     ,tdl.tx_id
     ,tdl.tx_num
     ,tdl.detail_type
     ,CASE
         WHEN tdl.detail_type = 1 THEN 'Charge'
         WHEN tdl.detail_type = 10 THEN 'Void'
      END                                         AS tx_type,
     ,ba.fin_div_id
      CASE
         WHEN div.fin_div_nm IS NULL THEN '*Unspecified FD'
         WHEN div.fin_div_nm IS NULL THEN '*Unknown FD'
         ELSE div.fin_div_nm
      END                                         AS div
     ,ba.fin_subdiv_id
     ,CASE
         WHEN sd.fin_subdiv_nm IS NULL THEN '*Unspecified SD'
         WHEN sd.fin_subdiv_nm IS NULL THEN '*Unknown SD'
         ELSE sd.fin_subdiv_nm
      END                                         AS sub_div
     ,BA.BILL_AREA_ID
     ,CASE
         WHEN ba.record_name IS NULL THEN '*Unspecified BA'
         WHEN ba.record_name IS NULL THEN '*Unknown BA'
         ELSE ba.record_name
      END                                         AS bill_area
     ,rs.referring_prov_id
     ,rs.referring_prov_nam                       AS referring_prov_name
     ,ser.prov_id                                 AS billing_provider_id
     ,ser.prov_name                               AS prov_name
     ,serv_prov.prov_id                           AS serv_prov_id
     ,serv_prov.prov_name                         AS serv_prov_name
     ,pat_enc.visit_prov_id
     ,serv.prov_name                              AS visit_prov_name
     ,serv.staff_resource                         AS resource_flag
     ,p.pat_id
     ,p.pat_mrn_id
     ,p.pat_name
     ,p.birth_date
     ,TRUNC (MONTHS_BETWEEN (tdl.orig_service_date, P.BIRTH_DATE) / 12)
                                                  AS age_at_dos
     ,tdl.account_id
     ,account.account_name                        AS guar_name
     ,account.account_type_c
     ,acttype.title                               AS account_type
     ,tdl.orig_service_date                       AS service_date
     ,tdl.post_date
     ,eap.proc_code
     ,tdl.cpt_code
     ,altcode.alt_code
     ,eap.proc_name
     ,dx1.ref_bill_code                           AS DX_1
     ,dx1.dx_id                                   AS DX_ID_1
     ,dx2.ref_bill_code                           AS DX_2
     ,dx2.dx_id                                   AS DX_ID_2
     ,dx3.ref_bill_code                           AS DX_3
     ,dx3.dx_id                                   AS DX_ID_3
     ,dx4.ref_bill_code                           AS DX_4
     ,dx4.dx_id                                   AS DX_ID_4
     ,dx5.ref_bill_code                           AS DX_5
     ,dx5.dx_id                                   AS DX_ID_5
     ,dx6.ref_bill_code                           AS DX_6
     ,dx6.dx_id                                   AS DX_ID_6
     ,    DECODE (dx1.ref_bill_code, NULL, NULL, dx1.ref_bill_code)
       || DECODE (dx2.ref_bill_code, NULL, NULL, ',' || dx2.ref_bill_code)
       || DECODE (dx3.ref_bill_code, NULL, NULL, ',' || dx3.ref_bill_code)
       || DECODE (dx4.ref_bill_code, NULL, NULL, ',' || dx4.ref_bill_code)
       || DECODE (dx5.ref_bill_code, NULL, NULL, ',' || dx5.ref_bill_code)
       || DECODE (dx6.ref_bill_code, NULL, NULL, ',' || dx6.ref_bill_code)
                                                  AS dx_codes
     ,tdl.modifier_one                            AS mod_1
     ,tdl.modifier_two                            AS mod_2
     ,tdl.modifier_three                          AS mod_3
     ,tdl.modifier_four                           AS mod_4
     ,    DECODE (tdl.modifier_one, NULL, NULL, tdl.modifier_one)
       || DECODE (TDL.modifier_two, NULL, NULL, ',' || tdl.modifier_two)
       || DECODE (tdl.modifier_three, NULL, NULL, ',' || tdl.modifier_three)
       || DECODE (tdl.modifier_four, NULL, NULL, ',' || tdl.modifier_four)
                                                  AS modifiers
     ,ofc.payor                                   AS ucla_fin_class
     ,tdl.original_cvg_id                         AS orig_coverage_id
     ,epm.payor_id                                AS orig_payor_id
